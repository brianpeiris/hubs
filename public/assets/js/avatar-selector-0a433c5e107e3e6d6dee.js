!function(e){function t(t){for(var o,r,s=t[0],l=t[1],d=t[2],c=0,p=[];c<s.length;c++)r=s[c],i[r]&&p.push(i[r][0]),i[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},i={8:0},a=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/hubs/public/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var u=l;a.push([612,1,0]),n()}({12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connectToReticulum=function(e=!1){const t=new URLSearchParams(location.search),n=t.get("phx_protocol")||("https:"===document.location.protocol?"wss:":"ws:");let o=t.get("phx_host"),i=t.get("phx_port");{const[e,t]="dev.reticulum.io".split(":");o=o||e||"",i=i||t||"443"}const s=`${n}//${o}${i?`:${i}`:""}/socket`;console.log(`Phoenix Socket URL: ${s}`);const l={params:{session_id:(0,a.default)()}};e&&(l.logger=((e,t,n)=>{console.log(`${e}: ${t}`,n)}));const d=new r.Socket(s,l);return d.connect(),d},t.getReticulumFetchUrl=s,t.getLandingPageForPhoto=function(e){const t=new URL(e);return s(t.pathname.replace(".png",".html")+t.search,!0)};var o,i=n(44),a=(o=i,o&&o.__esModule?o:{default:o}),r=n(45);document.createElement("a");function s(e,t=!1){return`https://dev.reticulum.io${e}`}},127:function(e,t,n){"use strict";AFRAME.registerComponent("gamma-factor",{schema:{gammaFactor:{type:"number",default:2.2}},init(){const e=this.el;e.isScene||console.warn("gamma-factor component can only be applied to <a-scene>")},update(e){const t=this.data,n=this.el,o=n.renderer;let i=!1;t.gammaFactor!==e.gammaFactor&&(o.gammaFactor=t.gammaFactor,i=!0),i&&0!==n.time&&n.object3D.traverse(function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach(function(e){e.needsUpdate=!0}):e.material.needsUpdate=!0)})}})},128:function(e,t,n){"use strict";AFRAME.registerComponent("scene-sound",{multiple:!0,schema:{sound:{type:"string"},on:{type:"string"},off:{type:"string"}},init(){const e=this.el.components[`${this.attrName.replace("scene-","")}`];this.el.sceneEl.addEventListener(this.data.on,e.playSound),e.stopSound=e.stopSound.bind(e),this.data.off&&this.el.sceneEl.addEventListener(this.data.off,e.stopSound)}})},15:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){a.default.config("https://013d6a364fed43cdb0539a61d520597a@sentry.prod.mozaws.net/370").install()};var o,i=n(40),a=(o=i,o&&o.__esModule?o:{default:o})},16:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=t.lang=void 0;var o,i=n(17),a=(o=i,o&&o.__esModule?o:{default:o});const r=(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage).toLowerCase().split(/[_-]+/)[0],s=t.lang=a.default[r]&&r||"en";t.messages=a.default[s]||a.default.en},17:function(e){e.exports={en:{"auth.verifying":"Verifying...","auth.verified-title":"E-Mail Verified!","auth.verified":"Your email has been verified!\nYou can now close this browser tab and return to Hubs.","auth.spoke-verified":"You email has been verified!\nYou can now close this browser tab and return to Spoke.","sign-in.prompt":"Sign in to pin objects in rooms.","sign-in.auth-started":"Email sent!\nWaiting for you to click on the link in the email...","sign-in.pin":"You'll need to sign in to pin objects.","sign-in.pin-complete":"You are now signed in.","sign-in.as":"Signed in as","sign-in.in":"Sign In","sign-in.out":"Sign Out","entry.enter-room-title":"Lobby","entry.enter-room":"Enter Room","entry.screen-prefix":"Enter on ","entry.desktop-screen":"Screen","entry.mobile-screen":"Phone","entry.mobile-safari":"Safari","entry.generic-prefix":" ","entry.generic-medium":"Connected Headset","entry.generic-subtitle-desktop":"Oculus or SteamVR","entry.gearvr-prefix":"Enter on ","entry.gearvr-medium":"Gear VR","entry.choose-device":"Choose Device","entry.device-prefix-desktop":" ","entry.device-prefix-mobile":" ","entry.device-medium":"Mobile Headset","entry.device-subtitle-desktop":"Standalone or Mobile VR","entry.device-subtitle-mobile":"Standalone or Mobile VR","entry.device-subtitle-vr":"Phone or PC","entry.cardboard":"Enter on Google Cardboard","entry.daydream-prefix":"Enter on ","entry.daydream-medium":"Daydream","entry.daydream-via-chrome":"Using Google Chrome","entry.invite-others":"invite others","entry.invite-others-nag":"invite","entry.invite-team-nag":"Invite a hubs team member","entry.enable-screen-sharing":"Share my desktop","entry.return-to-vr":"Return to VR","entry.enter-in-vr":"Enter in VR","entry.lobby":"Lobby","entry.notify_me":"Notify me when others are here","profile.save":"Accept","profile.display_name.validation_warning":"Alphanumerics and hyphens. At least 3 characters, no more than 32","profile.header":"Name & Avatar","profile.avatar-selector.loading":"Loading Avatars...","profile.terms_of_use":"Terms of Use","profile.privacy_notice":"Privacy Notice","audio.title":"Audio Setup","audio.subtitle-desktop":"Confirm HMD speaker output","audio.subtitle-mobile":"Earphones are recommended","audio.enter-now":"Enter Now","audio.hmd-mic-warning":"Your HMD mic is not chosen","audio.grant-title":"Grant mic permissions","audio.grant-subtitle":"Mic access needed to be heard by others","audio.granted-title":"Mic permissions granted","audio.granted-subtitle":"You can still mute yourself in-game","audio.granted-next":"Next","exit.subtitle.exited":"Your session has ended. Refresh your browser to start a new one.","exit.subtitle.closed":"This room is no longer available.","exit.subtitle.left":"You have left the room.","exit.subtitle.full":"This room is full, please try again later.","exit.subtitle.connect_error":"Unable to connect to this room, please try again later.","exit.subtitle.version_mismatch":"The version you deployed is not available yet. Your browser will refresh in 5 seconds.","autoexit.title":"Auto-ending session in ","autoexit.title_units":" seconds","autoexit.subtitle":"You have started another session.","autoexit.cancel":"CANCEL","presence.entered_room":"entered the room.","presence.entered_lobby":"entered the lobby.","presence.join_lobby":"joined the lobby.","presence.leave":"left.","presence.name_change":"is now known as","presence.in_lobby":"Lobby","presence.in_room":"In Room","home.room_create_options":"options","home.room_create_button":"Create Room","home.create_name.validation_warning":"Invalid name, limited to 4 to 64 characters and limited symbols.","home.join_us":"Join the Conversation","home.join_room":"Join Room","home.create_with_spoke":"Create a Scene","home.report_issue":"Report Issues","home.source_link":"Source","home.whats_new_link":"What's New","home.spoke_link":"Spoke","home.about_link":"About","home.community_link":"Community","home.privacy_notice":"Privacy Notice","home.terms_of_use":"Terms of Use","home.get_updates":"Get Updates","home.hero_title":"A new way to get together","home.made_with_love":"made with ðŸ¦† by ","home.environment_author_by":" by ","dialog.close":"close","mailing_list.privacy_label":"I'm okay with Mozilla handling my info as explained in","mailing_list.privacy_link":"this Privacy Notice","link.link_page_header_entry":"Enter your code:","link.link_page_header_headset":"Enter headset link code:","link.linking_a_headset":"Linking a Headset?","link.try_again":"We couldn't find that code.\nPlease try again.","help.report_issue":"Report an Issue","scene.logo_tagline":"A new way to get together","scene.create_button":"Create a room with this scene","scene.tweet_button":"Share on Twitter","link.in_your_browser":"In your headset's browser, go to:","link.enter_code":"Then, enter this one-time link code:","link.do_not_close":"Keep this open to use this code.","link.connect_headset":"Link VR Headset","link.cancel":"cancel","invite.enter_via":"Enter via ","invite.tweet":"tweet","invite.and_enter_code":" with code:","invite.or_visit":"or share permalink","spoke.primary_tagline":"make your space","spoke.secondary_tagline":"Create 3D social scenes for ","spoke.thank_you":"Thank you for downloading Spoke!","spoke.download_win":"Download for Windows","spoke.download_macos":"Download for Mac","spoke.download_linux":"Download for Linux","spoke.download_unsupported":"View Releases","spoke.browse_all_versions":"Browse All Versions","spoke.beginner_tutorial_button":"Learn Spoke in 5 Minutes","spoke.advanced_tutorial_button":"Advanced Spoke in 10 minutes","spoke.play_button":"Learn Spoke in 5 Minutes","commands.fly":"Toggle fly mode.","commands.grow":"Increase your avatar's size.","commands.shrink":"Decrease your avatar's size.","commands.help":"Show help.","commands.leave":"Disconnect from the room.","commands.duck":"The duck tested well. Quack.","video_share.notify":"Select again to un-share video."}}},19:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objectTypeForOriginAndContentType=function(e,t){for(const n in r)if(t.startsWith(n)){const t=r[n];return a(e,...t)}return i.UNKNOWN};const o=t.ObjectContentOrigins={URL:1,FILE:2,CLIPBOARD:3,SPAWNER:4},i=t.ObjectTypes={URL_IMAGE:0,URL_VIDEO:1,URL_MODEL:2,URL_PDF:3,URL_AUDIO:4,FILE_IMAGE:8,FILE_VIDEO:9,FILE_MODEL:10,FILE_PDF:11,FILE_AUDIO:12,CLIPBOARD_IMAGE:16,CLIPBOARD_VIDEO:17,CLIPBOARD_MODEL:18,CLIPBOARD_PDF:19,CLIPBOARD_AUDIO:20,SPAWNER_IMAGE:24,SPAWNER_VIDEO:25,SPAWNER_MODEL:26,SPAWNER_PDF:27,SPAWNER_AUDIO:28,CAMERA:30,UNKNOWN:31};function a(e,t,n,i,a){return e===o.URL?t:e===o.FILE?n:e===o.CLIPBOARD?i:a}const r={"image/":[i.URL_IMAGE,i.FILE_IMAGE,i.CLIPBOARD_IMAGE,i.SPAWNER_IMAGE],"model/":[i.URL_MODEL,i.FILE_MODEL,i.CLIPBOARD_MODEL,i.SPAWNER_MODEL],"application/x-zip-compressed":[i.URL_MODEL,i.FILE_MODEL,i.CLIPBOARD_MODEL,i.SPAWNER_MODEL],"video/":[i.URL_VIDEO,i.FILE_VIDEO,i.CLIPBOARD_VIDEO,i.SPAWNER_VIDEO],"audio/":[i.URL_AUDIO,i.FILE_AUDIO,i.CLIPBOARD_AUDIO,i.SPAWNER_AUDIO],"application/pdf":[i.URL_PDF,i.FILE_PDF,i.CLIPBOARD_PDF,i.SPAWNER_PDF]}},21:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.avatars=[{id:"botdefault",model:"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf"},{id:"botbobo",model:"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf"},{id:"botdom",model:"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf"},{id:"botgreg",model:"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf"},{id:"botguest",model:"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf"},{id:"botjim",model:"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf"},{id:"botkev",model:"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf"},{id:"botpinky",model:"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf"},{id:"botrobert",model:"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf"},{id:"botwoody",model:"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf"}]},27:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new Promise(e=>{setTimeout(e,0)})}},28:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCHEMA=void 0;var o,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=n(82),r=n(83),s=(o=r,o&&o.__esModule?o:{default:o}),l=n(72),d=n(37);const u="___hubs_store",c=Symbol(),p=new a.Validator,m=t.SCHEMA={id:"/HubsStore",definitions:{profile:{type:"object",additionalProperties:!1,properties:{displayName:{type:"string",pattern:"^[A-Za-z0-9-]{3,32}$"},avatarId:{type:"string"}}},credentials:{type:"object",additionalProperties:!1,properties:{token:{type:["null","string"]},email:{type:["null","string"]}}},activity:{type:"object",additionalProperties:!1,properties:{hasFoundFreeze:{type:"boolean"},hasChangedName:{type:"boolean"},lastEnteredAt:{type:"string"}}},settings:{type:"object",additionalProperties:!1,properties:{lastUsedMicDeviceId:{type:"string"}}},uploadPromotionTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{fileId:{type:"string"},promotionToken:{type:"string"}}}}},type:"object",properties:{profile:{$ref:"#/definitions/profile"},credentials:{$ref:"#/definitions/credentials"},activity:{$ref:"#/definitions/activity"},settings:{$ref:"#/definitions/settings"},uploadPromotionTokens:{$ref:"#/definitions/uploadPromotionTokens"}},additionalProperties:!1};t.default=class extends l.EventTarget{constructor(){super(),this.init=(()=>{this.update({profile:i({},(0,d.generateDefaultProfile)(),this.state.profile||{})}),this.state.activity.hasChangedName||this.update({profile:{displayName:(0,d.generateRandomName)()}})}),null===localStorage.getItem(u)&&localStorage.setItem(u,JSON.stringify({})),this.update({activity:{},settings:{},credentials:{},profile:{},uploadPromotionTokens:[]})}get state(){return this.hasOwnProperty(c)||(this[c]=JSON.parse(localStorage.getItem(u))),this[c]}update(e){const t=(0,s.default)(this.state,e),{valid:n}=p.validate(t,m);if(!n)throw new Error("Write to store failed schema validation.");return localStorage.setItem(u,JSON.stringify(t)),delete this[c],this.dispatchEvent(new CustomEvent("statechanged")),t}}},35:function(e,t,n){"use strict";var o=n(27),i=A(o),a=n(110),r=A(a),s=n(61),l=A(s),d=n(62),u=A(d),c=n(63),p=A(c),m=n(64),h=A(m),f=n(65),g=A(f),v=n(66),b=A(v),_=n(67),y=A(_),E=n(9);function A(e){return e&&e.__esModule?e:{default:e}}const M={};let R=null;function w(e,t,n){if(!AFRAME.components[t])throw new Error(`Inflator failed. "${t}" component does not exist.`);if(AFRAME.components[t].multiple&&Array.isArray(n))for(let o=0;o<n.length;o++)e.setAttribute(t+"__"+o,n[o]);else e.setAttribute(t,n)}function P(e){const t=new Map,n=e.clone();return function e(t,n,o){o(t,n);for(let i=0;i<t.children.length;i++)e(t.children[i],n.children[i],o)}(e,n,function(e,n){t.set(e,n)}),e.traverse(function(e){if(!e.isSkinnedMesh)return;const n=e.skeleton.bones,o=t.get(e);o.skeleton=e.skeleton.clone(),o.skeleton.bones=n.map(function(e){if(!t.has(e))throw new Error("Required bones are not descendants of the given object.");return t.get(e)}),o.bind(o.skeleton,e.bindMatrix)}),n}AFRAME.GLTFModelPlus={components:{},registerComponent(e,t,n){n=n||w,AFRAME.GLTFModelPlus.components[e]={inflator:n,componentName:t}}};const x=function(e,t,n,o){"Chest"===e.name?e.name="Spine":"Root Scene"===e.name?e.name="AvatarRoot":"Bot_Skinned"===e.name&&(e.name="AvatarMesh");const i=[],a=e.children.slice(0);for(const e of a){const n=x(e,t);n&&i.push(n)}const r=e.userData.gltfExtensions&&e.userData.gltfExtensions.HUBS_components,s=e.userData.components,l=r||s,d=!!l||e.name in t;if(!d&&!i.length&&!n)return null;const u=document.createElement("a-entity");u.append.apply(u,i);const c=(e.name||e.uuid).replace(/[^\w-]/g,"");if(u.classList.add(c),"YXZ"!==e.rotation.order&&e.rotation.setFromQuaternion(e.quaternion,"YXZ"),u.setAttribute("position",{x:e.position.x,y:e.position.y,z:e.position.z}),u.setAttribute("rotation",{x:e.rotation.x*THREE.Math.RAD2DEG,y:e.rotation.y*THREE.Math.RAD2DEG,z:e.rotation.z*THREE.Math.RAD2DEG}),u.setAttribute("scale",{x:e.scale.x*(void 0!==o?o:1),y:e.scale.y*(void 0!==o?o:1),z:e.scale.z*(void 0!==o?o:1)}),e.matrixAutoUpdate=!1,e.matrix.identity(),e.matrix.decompose(e.position,e.rotation,e.scale),u.object3D.matrixNeedsUpdate=!0,u.setObject3D(e.type.toLowerCase(),e),l&&"nav-mesh"in l&&u.setObject3D("mesh",e),u.object3D.name=e.name,e.animations&&(e.parent.animations=e.animations),l)for(const e in l)if(l.hasOwnProperty(e)&&AFRAME.GLTFModelPlus.components.hasOwnProperty(e)){const{componentName:t,inflator:n}=AFRAME.GLTFModelPlus.components[e];n(u,t,l[e],l)}return u};function S(e,t,n){const o=e.querySelectorAll("."+t);for(const e of o){const t=n.cloneNode(!0);for(const n of t.attributes){const{name:t,value:o}=n;e.setAttribute(t,o)}for(;t.children.length>0;)e.appendChild(t.children[0])}}async function C(e,t,n,o){let i,a=e;(t.includes("model/gltf+zip")||t.includes("application/x-zip-compressed"))&&(i=await function(e){return new Promise((t,n)=>{const o=new r.default;o.onmessage=(e=>{const[o,i]=e.data;(o?t:n)(i)}),o.postMessage(e)})}(a),a=i["scene.gtlf"]);const s=new THREE.GLTFLoader;s.customURLResolver=(0,E.getCustomGLTFParserURLResolver)(a),s.setLazy(!0);const{parser:d}=await new Promise((e,t)=>s.load(a,e,o,t)),c=d.json.materials;if(c)for(let e=0;e<c.length;e++){const t=c[e];if(t.extensions&&t.extensions.MOZ_alt_materials&&void 0!==t.extensions.MOZ_alt_materials[n]){const o=t.extensions.MOZ_alt_materials[n];c[e]=c[o]}}R||(R=async function(){const e=[u.default,p.default,h.default,g.default,b.default,y.default],t=await(new THREE.CubeTextureLoader).load(e);return t.format=THREE.RGBFormat,t}());const m=await new Promise((e,t)=>d.parse((t,n,o,i,a)=>{e({scene:t,scenes:n,cameras:o,animations:i,json:a})},e=>{t(e)})),f=await R;return m.scene.traverse(e=>{e.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate,e.material&&"MeshStandardMaterial"===e.material.type&&("KHR_materials_unlit"===n?e.material=l.default.fromStandardMaterial(e.material):(e.material.envMap=f,e.material.needsUpdate=!0))}),i&&Object.keys(i).forEach(URL.revokeObjectURL),m}AFRAME.registerComponent("gltf-model-plus",{schema:{src:{type:"string"},contentType:{type:"string"},useCache:{default:!0},inflate:{default:!1},modelToWorldScale:{type:"number",default:1}},init(){this.preferredTechnique=window.APP&&"low"===window.APP.quality?"KHR_materials_unlit":"pbrMetallicRoughness",this.loadTemplates()},update(){this.applySrc(this.data.src,this.data.contentType)},loadTemplates(){this.templates={},this.el.querySelectorAll(":scope > template").forEach(e=>{const t=document.importNode(e.firstElementChild||e.content.firstElementChild,!0);this.templates[e.getAttribute("data-name")]=t})},async loadModel(e,t,n,o){return o?(M[e]||(M[e]=await C(e,t,n)),i=M[e],{animations:i.animations,scene:P(i.scene)}):await C(e,t,n);var i},async applySrc(e,t){try{if(e&&"#"===e.charAt(0)){const t=document.getElementById(e.substring(1));e=t.getAttribute("src")}if(e===this.lastSrc)return;if(this.lastSrc=e,!e)return void(this.inflatedEl&&(console.warn("gltf-model-plus set to an empty source, unloading inflated model."),this.removeInflatedEl()));const n=await this.loadModel(e,t,this.preferredTechnique,this.data.useCache);if(e!=this.lastSrc)return;this.removeInflatedEl(),this.model=n.scene||n.scenes[0],this.model.animations=n.animations,n.animations.length>0&&(this.el.setAttribute("animation-mixer",{}),this.el.components["animation-mixer"].initMixer(n.animations));let o=this.model;if(this.data.inflate&&(this.inflatedEl=x(this.model,this.templates,!0,this.data.modelToWorldScale))){if(this.el.appendChild(this.inflatedEl),o=this.inflatedEl.object3D,await(0,i.default)(),e!=this.lastSrc)return;for(const e in this.templates)S(this.el,e,this.templates[e])}const a=[];o.traverse(e=>{const t=e.el;t&&a.push(()=>e.el=t)}),this.el.setObject3D("mesh",o),a.forEach(e=>e()),this.el.emit("model-loaded",{format:"gltf",model:this.model})}catch(t){delete M[e],console.error("Failed to load glTF model",t,this),this.el.emit("model-error",{format:"gltf",src:e})}},removeInflatedEl(){this.inflatedEl&&(this.inflatedEl.parentNode.removeChild(this.inflatedEl),delete this.inflatedEl)}})},36:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAncestorWithComponent=function(e,t){for(;e&&(!e.components||!e.components[t]);)e=e.parentNode;return e}},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.avatarIds=void 0,t.generateRandomName=function(){return`${a(i)}-${Math.floor(1e4+1e4*Math.random())}`},t.generateDefaultProfile=function(){return{avatarId:a(r)}};var o=n(21);const i=["Baers-Pochard","Baikal-Teal","Barrows-Goldeneye","Blue-Billed","Blue-Duck","Blue-Winged","Brown-Teal","Bufflehead","Canvasback","Cape-Shoveler","Chestnut-Teal","Chiloe-Wigeon","Cinnamon-Teal","Comb-Duck","Common-Eider","Common-Goldeneye","Common-Merganser","Common-Pochard","Common-Scoter","Common-Shelduck","Cotton-Pygmy","Crested-Duck","Crested-Shelduck","Eatons-Pintail","Falcated","Ferruginous","Freckled-Duck","Gadwall","Garganey","Greater-Scaup","Green-Pygmy","Grey-Teal","Hardhead","Harlequin","Hartlaubs","Hooded-Merganser","Hottentot-Teal","Kelp-Goose","King-Eider","Lake-Duck","Laysan-Duck","Lesser-Scaup","Long-Tailed","Maccoa-Duck","Mallard","Mandarin","Marbled-Teal","Mellers-Duck","Merganser","Northern-Pintail","Orinoco-Goose","Paradise-Shelduck","Plumed-Whistler","Puna-Teal","Pygmy-Goose","Radjah-Shelduck","Red-Billed","Red-Crested","Red-Shoveler","Ring-Necked","Ringed-Teal","Rosy-Billed","Ruddy-Shelduck","Salvadoris-Teal","Scaly-Sided","Shelduck","Shoveler","Silver-Teal","Smew","Spectacled-Eider","Spot-Billed","Spotted-Whistler","Steamerduck","Stellers-Eider","Sunda-Teal","Surf-Scoter","Tufted-Duck","Velvet-Scoter","Wandering-Whistler","Whistling-duck","White-Backed","White-Cheeked","White-Winged","Wigeon","Wood-Duck","Yellow-Billed"];function a(e){return e[Math.floor(Math.random()*e.length)]}const r=t.avatarIds=o.avatars.map(e=>e.id)},38:function(e,t){},41:function(e,t){},42:function(e,t){},5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WithHoverSound=t.hudHoverSound=t.ReactAudioContext=void 0;var o=n(1),i=s(o),a=n(0),r=s(a);function s(e){return e&&e.__esModule?e:{default:e}}const l=t.ReactAudioContext=i.default.createContext({}),d=t.hudHoverSound="play_sound-hud_hover_start",u=t.WithHoverSound=(({sound:e,children:t})=>i.default.createElement(l.Consumer,null,n=>i.default.cloneElement(t,{onMouseEnter:o=>{n&&n.playSound&&n.playSound(e||d),t.props.onMouseEnter&&t.props.onMouseEnter(o)}})));u.propTypes={children:r.default.object,sound:r.default.string}},57:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.patchWebGLRenderingContext=function(){if(/Android.+Firefox/.test(navigator.userAgent)){const e=WebGLRenderingContext.prototype.getExtension,t=function(){const e=new o.WebGLRenderer,t=new o.Scene,n=new Float32Array(16),i=new o.DataTexture(n,2,2,o.RGBAFormat,o.FloatType),a=new o.Mesh(new o.PlaneBufferGeometry(1,1),new o.MeshBasicMaterial({map:i}));a.material.map.needsUpdate=!0,t.add(a),e.render(t,new o.Camera);const r=0===e.context.getError();return e.dispose(),r}();WebGLRenderingContext.prototype.getExtension=function(n){return"OES_texture_float"!==n||t?e.call(this,n):null}}};const o=AFRAME.THREE},59:function(e,t,n){"use strict";AFRAME.registerComponent("animation-mixer",{initMixer(e){this.mixer=new THREE.AnimationMixer(this.el.object3D),this.el.object3D.animations=e,this.animations=e},tick:function(e,t){this.mixer&&this.mixer.update(t/1e3)}})},60:function(e,t,n){"use strict";AFRAME.registerComponent("networked-audio-analyser",{async init(){this.volume=0,this.prevVolume=0,this.smoothing=.3,this.threshold=.01,this.el.addEventListener("sound-source-set",e=>{const t=THREE.AudioContext.getContext();this.analyser=t.createAnalyser(),this.analyser.fftSize=32,this.levels=new Uint8Array(this.analyser.frequencyBinCount),e.detail.soundSource.connect(this.analyser)})},tick:function(){if(!this.analyser)return;this.analyser.getByteTimeDomainData(this.levels);let e=0;for(let t=0;t<this.levels.length;t++){const n=(this.levels[t]-128)/128;e+=n*n}let t=Math.sqrt(e/this.levels.length);t<this.threshold&&(t=0),this.volume=this.smoothing*t+(1-this.smoothing)*this.prevVolume,this.prevVolume=this.volume}}),AFRAME.registerComponent("scale-audio-feedback",{schema:{minScale:{default:1},maxScale:{default:1.5}},tick(){if(!this.el.object3D.visible)return;const{minScale:e,maxScale:t}=this.data,n=this.el.components["networked-audio-analyser"];if(!n)return;const o=Math.min(t,e+(t-e)*n.volume*8);this.el.object3D.scale.setScalar(o),this.el.object3D.matrixNeedsUpdate=!0}})},61:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o="\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n",i="\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n";class a extends THREE.ShaderMaterial{constructor(...e){var t;return t=super(...e),this.type="MobileStandardMaterial",this.isMobileStandardMaterial=!0,t}static fromStandardMaterial(e){const t={vertexShader:o,fragmentShader:i,uniforms:{uvTransform:{value:new THREE.Matrix3},diffuse:{value:e.color},opacity:{value:e.opacity},map:{value:e.map},aoMapIntensity:{value:e.aoMapIntensity},aoMap:{value:e.aoMap},emissive:{value:e.emissive},emissiveMap:{value:e.emissiveMap}},fog:!0,lights:!1,opacity:e.opacity,transparent:e.transparent,skinning:e.skinning,morphTargets:e.morphTargets},n=new a(t);return n.color=e.color,n.map=e.map,n.aoMap=e.aoMap,n.aoMapIntensity=e.aoMapIntensity,n.emissive=e.emissive,n.emissiveMap=e.emissiveMap,n}clone(){return a.fromStandardMaterial(this)}}t.default=a},612:function(e,t,n){"use strict";n(96);var o=n(26),i=b(o),a=n(1),r=b(a),s=n(6),l=n(43),d=b(l),u=n(16),c=n(57);n(690),n(58),n(59),n(60),n(70),n(127),n(128),n(74);var p=n(21),m=n(15),h=b(m),f=n(75),g=n(613),v=b(g);function b(e){return e&&e.__esModule?e:{default:e}}function _(e){return new URLSearchParams(location.hash.replace(/^#/,"?")).get(e)}function y(e){window.parent.postMessage({avatarId:e},location.origin)}function E(){const e=_("avatar_id");i.default.render(r.default.createElement(s.IntlProvider,{locale:u.lang,messages:u.messages},r.default.createElement(v.default,{avatars:p.avatars,avatarId:e,onChange:y})),document.getElementById("selector-root"))}(0,c.patchWebGLRenderingContext)(),(0,s.addLocaleData)([...d.default]),(0,h.default)(),window.APP=new f.App,window.APP.quality=_("quality")||AFRAME.utils.device.isMobile()?"low":"high",window.addEventListener("hashchange",E),document.addEventListener("DOMContentLoaded",E)},613:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=p(o),a=n(0),r=p(a),s=n(6),l=n(56),d=n(154),u=n(155),c=n(5);function p(e){return e&&e.__esModule?e:{default:e}}class m extends o.Component{constructor(e){super(e),h.call(this),this.state.initialAvatarIndex=m.getAvatarIndex(e),this.state.avatarIndices=[m.nextAvatarIndex(e),this.state.initialAvatarIndex,m.previousAvatarIndex(e)]}UNSAFE_componentWillReceiveProps(e){this.setState(t=>{const n=e.avatars.length;if(t.avatarIndices.length===n)return;const o=n-1,i=this.getAvatarIndex(),a=m.getAvatarIndex(e),r=Array.from(t.avatarIndices),s=i-a<0;let l=-1,d=!1;0===a?i===o?(l=1,d=0!==r.indexOf(o)):(l=-1,d=0!==r.indexOf(1)):a===o?0===i?(l=-1,d=0===r.indexOf(0)):(l=1,d=0!==r.indexOf(o-1)):(l=s?1:-1,d=s);const u=m.getAvatarIndex(e,l);return r.includes(u)?void 0:(d?r.push(u):r.unshift(u),{avatarIndices:r})})}componentDidUpdate(e){if(this.props.avatarId!==e.avatarId){const e=this.animation.parentNode.getAttribute("rotation"),t=e.y,n=this.animation.getAttribute("to").split(" "),o=n[1],i=360/this.props.avatars.length,a=Math.abs(o-t)>3*i;let r=t;a&&(r=t<o?t+360:t-360),this.animation.setAttribute("from",`${e.x} ${r} ${e.z}`),this.animation.stop(),this.animation.handleMixinUpdate(),this.animation.start()}}componentDidMount(){this.scene.addEventListener("loaded",()=>{this.scene.setAttribute("renderer",{gammaOutput:!0,sortObjects:!0,physicallyCorrectLights:!0}),this.scene.setAttribute("gamma-factor",""),this.scene.setAttribute("shadow",{type:"pcfsoft",enabled:"low"!==window.APP.quality})})}render(){const e=this.props.avatars.map(e=>i.default.createElement("a-asset-item",{id:e.id,key:e.id,"response-type":"arraybuffer",src:`${e.model}`})),t=this.state.avatarIndices.map(e=>[this.props.avatars[e],e]),n=t.map(([e,t])=>i.default.createElement("a-entity",{key:e.id,rotation:`0 ${360*-t/this.props.avatars.length} 0`},i.default.createElement("a-entity",{position:"0 0 5","gltf-model-plus":`src: #${e.id}; inflate: true`},i.default.createElement("a-animation",{attribute:"rotation",dur:"12000",to:`0 ${this.getAvatarIndex()===t?360:0} 0`,repeat:"indefinite"})))),o=e=>(360*e/this.props.avatars.length+180)%360,a=o(this.state.initialAvatarIndex),r=o(this.getAvatarIndex());return i.default.createElement("div",{className:"avatar-selector"},i.default.createElement("a-scene",{"vr-mode-ui":"enabled: false",ref:e=>this.scene=e},i.default.createElement("a-assets",null,e),i.default.createElement("a-entity",{rotation:`0 ${a} 0`},i.default.createElement("a-animation",{ref:e=>this.animation=e,attribute:"rotation",dur:"2000",easing:"ease-out",to:`0 ${r} 0`}),n),i.default.createElement("a-entity",{position:"0 1.5 -5.6",rotation:"-10 180 0"},i.default.createElement("a-entity",{camera:"far: 1;"})),i.default.createElement("a-entity",{"hide-when-quality":"low",light:"type: directional; color: #F9FFCE; intensity: 0.6",position:"0 5 -15"}),i.default.createElement("a-entity",{"hide-when-quality":"low",light:"type: ambient; color: #FFF"})),i.default.createElement(c.WithHoverSound,null,i.default.createElement("button",{className:"avatar-selector__previous-button",onClick:this.emitChangeToPrevious},i.default.createElement(l.FontAwesomeIcon,{icon:d.faAngleLeft}))),i.default.createElement(c.WithHoverSound,null,i.default.createElement("button",{className:"avatar-selector__next-button",onClick:this.emitChangeToNext},i.default.createElement(l.FontAwesomeIcon,{icon:u.faAngleRight}))))}}m.propTypes={avatars:r.default.array,avatarId:r.default.string,onChange:r.default.func},m.getAvatarIndex=((e,t=0)=>{const n=e.avatars.findIndex(t=>t.id===e.avatarId),o=e.avatars.length;return((n+t)%o+o)%o}),m.nextAvatarIndex=(e=>m.getAvatarIndex(e,-1)),m.previousAvatarIndex=(e=>m.getAvatarIndex(e,1));var h=function(){this.state={initialAvatarIndex:0,avatarIndices:[]},this.getAvatarIndex=((e=0)=>m.getAvatarIndex(this.props,e)),this.nextAvatarIndex=(()=>this.getAvatarIndex(-1)),this.previousAvatarIndex=(()=>this.getAvatarIndex(1)),this.emitChangeToNext=(()=>{const e=this.props.avatars[this.nextAvatarIndex()].id;this.props.onChange(e)}),this.emitChangeToPrevious=(()=>{const e=this.props.avatars[this.previousAvatarIndex()].id;this.props.onChange(e)})};t.default=(0,s.injectIntl)(m)},62:function(e,t,n){e.exports=n.p+"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg"},63:function(e,t,n){e.exports=n.p+"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg"},64:function(e,t,n){e.exports=n.p+"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg"},65:function(e,t,n){e.exports=n.p+"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg"},66:function(e,t,n){e.exports=n.p+"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg"},67:function(e,t,n){e.exports=n.p+"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg"},68:function(e,t){e.exports="if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo) {\n  float ratio = 0.0;\n\n  if (hubs_EnableSweepingEffect) {\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\n    float line = mod(hubs_Time / 3000.0 * size, size * 2.0) + hubs_SweepParams.s - size / 2.0;\n\n    if (hubs_WorldPosition.y < line) {\n      // Highlight with a sweeping gradient.\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / size * 3.0);\n    }\n  }\n\n  // Highlight with a gradient falling off with distance.\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\n\n  if (hubs_HighlightInteractorOne) {\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\n  } \n\n  if (hubs_HighlightInteractorTwo) {\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\n  }\n\n  ratio = min(1.0, ratio);\n\n  // Gamma corrected highlight color\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\n\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\n}\n"},690:function(e,t){},70:function(e,t,n){"use strict";var o=n(36);AFRAME.registerComponent("loop-animation",{schema:{clip:{type:"string"}},init(){this.mixerEl=(0,o.findAncestorWithComponent)(this.el,"animation-mixer"),this.mixerEl?this.updateClip():console.warn("loop-animation component could not find an animation-mixer in its ancestors.")},update(e){e.clip!==this.data.clip&&this.mixerEl&&this.updateClip()},updateClip(){const{mixer:e,animations:t}=this.mixerEl.components["animation-mixer"],n=this.data.clip;if(0===t.length)return;let o;if(o=n?t.find(({name:e})=>e===n):t[0],!o)return;const i=e.clipAction(o,this.el.object3D);i.enabled=!0,i.setLoop(THREE.LoopRepeat,1/0).play(),this.currentAction=i},destroy(){this.currentAction&&(this.currentAction.enabled=!1,this.currentAction.stop())}})},74:function(e,t,n){"use strict";function o(e,t,n,o){o.networked&&e.setAttribute("networked",{template:n.controls?"#static-controlled-media":"#static-media",owner:"scene",persistent:!0,networkId:o.networked.id});const i={projection:n.projection};"video"===t&&(i.videoPaused=!n.autoPlay,i.volume=n.volume,i.loop=n.loop,i.audioType=n.audioType,"pannernode"===n.audioType&&(i.distanceModel=n.distanceModel,i.rolloffFactor=n.rolloffFactor,i.refDistance=n.refDistance,i.maxDistance=n.maxDistance,i.coneInnerAngle=n.coneInnerAngle,i.coneOuterAngle=n.coneOuterAngle,i.coneOuterGain=n.coneOuterGain)),e.setAttribute("media-loader",{src:n.src,resize:!0,resolve:!0,fileIsOwned:!0,mediaOptions:i})}n(35),AFRAME.GLTFModelPlus.registerComponent("duck","duck"),AFRAME.GLTFModelPlus.registerComponent("quack","quack"),AFRAME.GLTFModelPlus.registerComponent("sound","sound"),AFRAME.GLTFModelPlus.registerComponent("collision-filter","collision-filter"),AFRAME.GLTFModelPlus.registerComponent("css-class","css-class"),AFRAME.GLTFModelPlus.registerComponent("interactable","css-class",(e,t)=>{e.setAttribute(t,"interactable")}),AFRAME.GLTFModelPlus.registerComponent("super-spawner","super-spawner"),AFRAME.GLTFModelPlus.registerComponent("gltf-model-plus","gltf-model-plus"),AFRAME.GLTFModelPlus.registerComponent("media-loader","media-loader"),AFRAME.GLTFModelPlus.registerComponent("body","body"),AFRAME.GLTFModelPlus.registerComponent("hide-when-quality","hide-when-quality"),AFRAME.GLTFModelPlus.registerComponent("light","light"),AFRAME.GLTFModelPlus.registerComponent("ambient-light","ambient-light"),AFRAME.GLTFModelPlus.registerComponent("directional-light","directional-light"),AFRAME.GLTFModelPlus.registerComponent("hemisphere-light","hemisphere-light"),AFRAME.GLTFModelPlus.registerComponent("point-light","point-light"),AFRAME.GLTFModelPlus.registerComponent("spot-light","spot-light"),AFRAME.GLTFModelPlus.registerComponent("skybox","skybox"),AFRAME.GLTFModelPlus.registerComponent("layers","layers"),AFRAME.GLTFModelPlus.registerComponent("shadow","shadow"),AFRAME.GLTFModelPlus.registerComponent("water","water"),AFRAME.GLTFModelPlus.registerComponent("scale-audio-feedback","scale-audio-feedback"),AFRAME.GLTFModelPlus.registerComponent("animation-mixer","animation-mixer"),AFRAME.GLTFModelPlus.registerComponent("loop-animation","loop-animation"),AFRAME.GLTFModelPlus.registerComponent("shape","shape"),AFRAME.GLTFModelPlus.registerComponent("heightfield","heightfield"),AFRAME.GLTFModelPlus.registerComponent("box-collider","shape",(()=>{const e=new THREE.Euler;return(t,n,o)=>{const{scale:i,rotation:a}=o;e.set(a.x,a.y,a.z);const r=(new THREE.Quaternion).setFromEuler(e);t.setAttribute(n,{shape:"box",offset:o.position,halfExtents:{x:i.x/2,y:i.y/2,z:i.z/2},orientation:r})}})()),AFRAME.GLTFModelPlus.registerComponent("visible","visible",(e,t,n)=>{"object"==typeof n?e.setAttribute(t,n.visible):e.setAttribute(t,n)}),AFRAME.GLTFModelPlus.registerComponent("spawn-point","spawn-point"),AFRAME.GLTFModelPlus.registerComponent("hoverable","hoverable"),AFRAME.GLTFModelPlus.registerComponent("sticky-zone","sticky-zone"),AFRAME.GLTFModelPlus.registerComponent("nav-mesh","nav-mesh",(e,t,n)=>{const o=AFRAME.scenes[0].systems.nav,i=n.zone||"character";let a=!1;e.object3D.traverse(e=>{e.isMesh&&!a&&(a=!0,o.loadMesh(e,i))}),e.setAttribute("nav-mesh")}),AFRAME.GLTFModelPlus.registerComponent("pinnable","pinnable"),AFRAME.GLTFModelPlus.registerComponent("media","media",(e,t,n)=>{n.id&&e.setAttribute("networked",{template:"#interactable-media",owner:"scene",persistent:!0,networkId:n.id}),e.setAttribute("media-loader",{src:n.src,resize:!0,resolve:!0,fileIsOwned:!0}),n.pageIndex&&e.setAttribute("media-pager",{index:n.pageIndex}),void 0!==n.paused&&e.setAttribute("media-video",{videoPaused:n.paused}),n.time&&e.setAttribute("media-video",{time:n.time})}),AFRAME.GLTFModelPlus.registerComponent("image","image",o),AFRAME.GLTFModelPlus.registerComponent("video","video",o)},75:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var o,i=n(28),a=(o=i,o&&o.__esModule?o:{default:o});t.App=class{constructor(){this.scene=null,this.quality="low",this.store=new a.default}setQuality(e){return this.quality!==e&&(this.quality=e,this.scene&&this.scene.dispatchEvent(new CustomEvent("quality-changed",{detail:e})),!0)}}},9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addMedia=t.upload=t.guessContentType=t.getCustomGLTFParserURLResolver=t.resolveUrl=t.proxiedUrlFor=void 0,t.injectCustomShaderChunks=function(e){const t=/\bskinning_vertex\b/,n=/\bgl_FragColor\b/,o=["MeshStandardMaterial","MeshBasicMaterial","MobileStandardMaterial"],i=new Map;return e.traverse(e=>{e.material&&o.includes(e.material.type)&&(e.el.classList.contains("ui")||e.el.classList.contains("hud")||e.el.getAttribute("text-button")||(e.material=e.material.clone(),e.material.onBeforeCompile=(o=>{if(!t.test(o.vertexShader))return;o.uniforms.hubs_EnableSweepingEffect={value:!1},o.uniforms.hubs_SweepParams={value:[0,0]},o.uniforms.hubs_InteractorOnePos={value:[0,0,0]},o.uniforms.hubs_InteractorTwoPos={value:[0,0,0]},o.uniforms.hubs_HighlightInteractorOne={value:!1},o.uniforms.hubs_HighlightInteractorTwo={value:!1},o.uniforms.hubs_Time={value:0};const a=o.vertexShader.split("\n"),r=a.findIndex(e=>t.test(e));a.splice(r+1,0,"\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      "),a.unshift("varying vec3 hubs_WorldPosition;"),a.unshift("uniform bool hubs_HighlightInteractorOne;"),a.unshift("uniform bool hubs_HighlightInteractorTwo;"),o.vertexShader=a.join("\n");const l=o.fragmentShader.split("\n"),d=l.findIndex(e=>n.test(e));l.splice(d+1,0,s.default),l.unshift("varying vec3 hubs_WorldPosition;"),l.unshift("uniform bool hubs_EnableSweepingEffect;"),l.unshift("uniform vec2 hubs_SweepParams;"),l.unshift("uniform bool hubs_HighlightInteractorOne;"),l.unshift("uniform vec3 hubs_InteractorOnePos;"),l.unshift("uniform bool hubs_HighlightInteractorTwo;"),l.unshift("uniform vec3 hubs_InteractorTwoPos;"),l.unshift("uniform float hubs_Time;"),o.fragmentShader=l.join("\n"),i.set(e.material.uuid,o.uniforms)}),e.material.needsUpdate=!0))}),i},t.getPromotionTokenForFile=function(e){return window.APP.store.state.uploadPromotionTokens.find(t=>t.fileId===e)};var o,i=n(19),a=n(12),r=n(68),s=(o=r,o&&o.__esModule?o:{default:o});const l="hubs.local,reticulum.io".split(","),d=(0,a.getReticulumFetchUrl)("/api/v1/media"),u={gltf:"model/gltf",glb:"model/gltf-binary",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",pdf:"application/pdf",mp4:"video/mp4",mp3:"audio/mpeg"};t.proxiedUrlFor=((e,t)=>{if(!e.startsWith("http:")&&!e.startsWith("https:"))return e;try{const t=new URL(e);if(l.find(e=>t.hostname.endsWith(e)))return e}catch(e){}const n=(c=e,btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)))).replace(/=+$/g,"");if(null==t&&{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER){const t=encodeURIComponent(e);return`https://${{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER}/${t}`}{const e=n.replace(/\+/g,"-").replace(/\//g,"_"),o=null!=t?"extract":"raw";return`https://farspark-dev.reticulum.io/0/${o}/0/0/0/${t||0}/${e}`}});var c;const p=new Map,m=(t.resolveUrl=(async(e,t)=>{const n=`${e}|${t}`;if(p.has(n))return p.get(n);const o=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:{url:e,index:t}})}).then(e=>e.json());return p.set(n,o),o}),t.getCustomGLTFParserURLResolver=(e=>(t,n)=>{if("string"!=typeof t||""===t)return"";if(/^(https?:)?\/\//i.test(t))return t;if(/^data:.*,.*$/i.test(t))return t;if(/^blob:.*$/i.test(t))return t;if({NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER){const n=`https://${{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER}/`;if(e.startsWith(n)){const o=decodeURIComponent(e.substring(n.length)),i=o.split("/"),a=i.slice(0,i.length-1).join("/")+"/"+t;return n+encodeURIComponent(a)}}return n+t}),t.guessContentType=(e=>{if(e.startsWith("hubs://")&&e.endsWith("/video"))return"video/vnd.hubs-webrtc";const t=new URL(e).pathname.split(".").pop();return u[t]}),t.upload=(e=>{const t=new FormData;return t.append("media",e),t.append("promotion_mode","with_token"),fetch(d,{method:"POST",body:t}).then(e=>e.json())}));let h=0;t.addMedia=((e,t,n,o=!1,a=!1)=>{const r=AFRAME.scenes[0],s=document.createElement("a-entity");s.id="interactable-media-"+h++,s.setAttribute("networked",{template:t});const l=e instanceof File;s.setAttribute("media-loader",{resize:a,resolve:o,src:"string"==typeof e?e:"",fileIsOwned:!l}),r.appendChild(s);const d=setTimeout(()=>{r.emit("media-loading",{src:e})},100);["model-loaded","video-loaded","image-loaded"].forEach(t=>{s.addEventListener(t,()=>{clearTimeout(d),s.classList.contains("pen")||s.getAttribute("animation__spawn-start")||(s.object3D.scale.setScalar(.5),s.matrixNeedsUpdate=!0,s.setAttribute("animation__spawn-start",{property:"scale",delay:50,dur:300,from:{x:.5,y:.5,z:.5},to:{x:1,y:1,z:1},easing:"easeOutElastic"})),r.emit("media-loaded",{src:e})})});const u=new Promise(function(t){l?function(e,t){const n=new FileReader;n.onload=function(e){const n=new DataView(e.target.result);if(65496!=n.getUint16(0,!1))return t(-2);const o=n.byteLength;let i=2;for(;i<o;){if(n.getUint16(i+2,!1)<=8)return t(-1);const e=n.getUint16(i,!1);if(i+=2,65505==e){if(1165519206!=n.getUint32(i+=2,!1))return t(-1);const e=18761==n.getUint16(i+=6,!1);i+=n.getUint32(i+4,e);const o=n.getUint16(i,e);i+=2;for(let a=0;a<o;a++)if(274==n.getUint16(i+12*a,e))return t(n.getUint16(i+12*a+8,e))}else{if(65280!=(65280&e))break;i+=n.getUint16(i,!1)}}return t(-1)},n.readAsArrayBuffer(e)}(e,e=>{t(e)}):t(1)});return l?m(e).then(e=>{const t=new URL(e.raw);t.searchParams.set("token",e.meta.access_token),s.setAttribute("media-loader",{resolve:!1,src:t.href,fileId:e.file_id}),window.APP.store.update({uploadPromotionTokens:[{fileId:e.file_id,promotionToken:e.meta.promotion_token}]})}).catch(e=>{console.error("Media upload failed",e),s.setAttribute("media-loader",{src:"error"})}):e instanceof MediaStream&&s.setAttribute("media-loader",{src:`hubs://clients/${NAF.clientId}/video`}),n&&s.addEventListener("media_resolved",({detail:e})=>{const t=(0,i.objectTypeForOriginAndContentType)(n,e.contentType);r.emit("object_spawned",{objectType:t})}),{entity:s,orientation:u}})}});
//# sourceMappingURL=avatar-selector-0a433c5e107e3e6d6dee.js.map