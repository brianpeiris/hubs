{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/components/gamma-factor.js","webpack:///./src/components/scene-sound.js","webpack:///./src/telemetry.js","webpack:///./src/utils/i18n.js","webpack:///./src/object-types.js","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/utils/next-tick.js","webpack:///./src/storage/store.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/scene-graph.js","webpack:///./src/utils/identity.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/utils/webgl.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/materials/MobileStandardMaterial.js","webpack:///./src/avatar-selector.js","webpack:///./src/react-components/avatar-selector.js","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/components/loop-animation.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/App.js","webpack:///./src/utils/media-utils.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","8","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","connectToReticulum","debug","qs","URLSearchParams","location","search","socketProtocol","document","protocol","socketHost","socketPort","retHost","retPort","split","socketUrl","console","log","socketSettings","params","session_id","_v2","default","logger","kind","msg","socket","Socket","connect","getReticulumFetchUrl","getLandingPageForPhoto","photoUrl","parsedUrl","URL","pathname","replace","_v","_phoenix","createElement","path","absolute","AFRAME","registerComponent","schema","gammaFactor","type","init","el","this","isScene","warn","update","prevData","sceneEl","renderer","needsShaderUpdate","time","object3D","traverse","node","isMesh","Array","isArray","material","forEach","needsUpdate","multiple","sound","on","off","components","attrName","addEventListener","playSound","stopSound","Raven","config","install","_ravenJs","_translationsData","navigatorLang","navigator","languages","language","userLanguage","toLowerCase","lang","localeData","messages","en","objectTypeForOriginAndContentType","contentOrigin","contentType","prefix","objectTypeMimePrefixLookupMap","startsWith","types","objectTypeForOrigin","ObjectTypes","UNKNOWN","ObjectContentOrigins","FILE","CLIPBOARD","SPAWNER","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","CAMERA","urlType","fileType","clipboardType","spawnerType","image/","model/","application/x-zip-compressed","video/","audio/","application/pdf","avatars","id","model","Promise","resolve","setTimeout","_jsonschema","_deepmerge","_eventTargetShim","_identity","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","validator","Validator","SCHEMA","definitions","profile","additionalProperties","properties","displayName","pattern","avatarId","credentials","token","email","activity","hasFoundFreeze","hasChangedName","lastEnteredAt","settings","lastUsedMicDeviceId","uploadPromotionTokens","items","fileId","promotionToken","$ref","EventTarget","constructor","super","generateDefaultProfile","state","generateRandomName","localStorage","getItem","setItem","JSON","stringify","parse","newState","finalState","_deepmerge2","valid","validate","Error","dispatchEvent","CustomEvent","_nextTick","_sketchfabZipWorker","_MobileStandardMaterial","_posx","_negx","_posy","_negy","_posz","_negz","_mediaUtils","GLTFCache","CachedEnvMapTexture","inflateComponent","componentName","componentData","setAttribute","cloneSkinnedMesh","source","cloneLookup","Map","clone","parallelTraverse","a","b","callback","children","sourceNode","clonedNode","set","sourceMesh","isSkinnedMesh","sourceBones","skeleton","bones","clonedMesh","map","sourceBone","has","bindMatrix","GLTFModelPlus","componentKey","inflator","inflateEntities","templates","isRoot","modelToWorldScale","childEntities","child","hubsComponents","userData","gltfExtensions","HUBS_components","legacyComponents","entityComponents","nodeHasBehavior","append","className","uuid","classList","add","rotation","order","setFromQuaternion","quaternion","x","position","y","z","THREE","Math","RAD2DEG","scale","undefined","matrixAutoUpdate","matrix","identity","decompose","matrixNeedsUpdate","setObject3D","animations","parent","prop","attachTemplate","root","templateRoot","targetEls","querySelectorAll","cloneNode","_ref","attributes","appendChild","async","loadGLTF","src","preferredTechnique","onProgress","fileMap","gltfUrl","includes","reject","worker","SketchfabZipWorker","onmessage","e","success","fileMapOrError","postMessage","getFilesFromSketchfabZip","gltfLoader","GLTFLoader","customURLResolver","getCustomGLTFParserURLResolver","setLazy","parser","load","materials","json","extensions","MOZ_alt_materials","altMaterialIndex","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","texture","CubeTextureLoader","format","RGBFormat","loadEnvMap","gltf","scene","scenes","cameras","envMap","Object3D","DefaultMatrixAutoUpdate","MobileStandardMaterial","fromStandardMaterial","keys","revokeObjectURL","useCache","inflate","APP","quality","loadTemplates","applySrc","templateEl","importNode","firstElementChild","content","getAttribute","[object Object]","technique","charAt","assetEl","getElementById","substring","lastSrc","inflatedEl","removeInflatedEl","loadModel","initMixer","object3DToSet","_nextTick2","rewires","f","emit","error","parentNode","removeChild","findAncestorWithComponent","entity","selectRandom","names","floor","random","avatarIds","_avatars","arr","av","_react","_propTypes","ReactAudioContext","React","createContext","hudHoverSound","WithHoverSound","_react2","Consumer","context","cloneElement","onMouseEnter","props","propTypes","PropTypes","string","patchWebGLRenderingContext","test","userAgent","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","WebGLRenderer","Scene","Float32Array","size","dataTexture","DataTexture","RGBAFormat","FloatType","box","Mesh","PlaneBufferGeometry","MeshBasicMaterial","render","Camera","getError","dispose","checkFloatTextureSupport","mixer","AnimationMixer","tick","dt","volume","prevVolume","smoothing","threshold","event","ctx","AudioContext","getContext","analyser","createAnalyser","fftSize","levels","Uint8Array","frequencyBinCount","detail","soundSource","getByteTimeDomainData","sum","amplitude","currVolume","sqrt","minScale","maxScale","visible","audioAnalyser","min","setScalar","VERTEX_SHADER","FRAGMENT_SHADER","ShaderMaterial","args","_temp","isMobileStandardMaterial","parameters","vertexShader","fragmentShader","uniforms","uvTransform","Matrix3","diffuse","color","opacity","aoMapIntensity","aoMap","emissive","emissiveMap","fog","lights","transparent","skinning","morphTargets","mobileMaterial","_reactDom","_reactIntl","_en","_i18n","_webgl","_telemetry","_App","_avatarSelector","getHashArg","arg","hash","postAvatarIdToParent","newAvatarId","origin","mountUI","ReactDOM","IntlProvider","locale","_avatarSelector2","onChange","addLocaleData","_telemetry2","App","utils","device","isMobile","_reactFontawesome","_faAngleLeft","_faAngleRight","_wrapWithAudio","AvatarSelector","Component","_initialiseProps","initialAvatarIndex","getAvatarIndex","avatarIndices","nextAvatarIndex","previousAvatarIndex","UNSAFE_componentWillReceiveProps","nextProps","setState","numAvatars","lastIndex","currAvatarIndex","from","increasing","direction","indexOf","addIndex","unshift","componentDidUpdate","prevProps","currRot","animation","currY","toRot","toY","step","brokenlyBigRotation","abs","fromY","stop","handleMixinUpdate","start","componentDidMount","gammaOutput","sortObjects","physicallyCorrectLights","enabled","avatarAssets","avatar","response-type","avatarData","avatarEntities","gltf-model-plus","attribute","dur","to","repeat","rotationFromIndex","index","initialRotation","toRotation","vr-mode-ui","ref","sce","anm","easing","camera","hide-when-quality","light","onClick","emitChangeToPrevious","FontAwesomeIcon","icon","faAngleLeft","emitChangeToNext","faAngleRight","array","func","offset","findIndex","nextAvatarId","previousAvatarId","injectIntl","_sceneGraph","clip","mixerEl","updateClip","oldData","clipName","find","action","clipAction","setLoop","LoopRepeat","Infinity","play","currentAction","destroy","mediaInflator","networked","template","controls","owner","persistent","networkId","mediaOptions","projection","videoPaused","autoPlay","loop","audioType","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","resize","fileIsOwned","euler","Euler","orientation","Quaternion","setFromEuler","shape","halfExtents","_componentName","nav","systems","zone","found","loadMesh","pageIndex","paused","_store","store","Store","setQuality","injectCustomShaderChunks","obj","vertexRegex","fragRegex","validMaterials","shaderUniforms","contains","onBeforeCompile","shader","hubs_EnableSweepingEffect","hubs_SweepParams","hubs_InteractorOnePos","hubs_InteractorTwoPos","hubs_HighlightInteractorOne","hubs_HighlightInteractorTwo","hubs_Time","vlines","vindex","line","join","flines","findex","mediaHighlightFrag","getPromotionTokenForFile","upload","_objectTypes","_phoenixUtils","_mediaHighlightFrag","nonCorsProxyDomains","mediaAPIEndpoint","commonKnownContentTypes","glb","png","jpg","jpeg","pdf","mp4","mp3","proxiedUrlFor","url","domain","hostname","endsWith","base64Url","str","btoa","encodeURIComponent","_","p1","String","fromCharCode","NODE_ENV","RETICULUM_SERVER","FARSPARK_SERVER","NON_CORS_PROXY_DOMAINS","ASSET_BUNDLE_SERVER","EXTRA_ENVIRONMENTS","CORS_PROXY_SERVER","encodedUrl","method","resolveUrlCache","resolveUrl","cacheKey","resolved","fetch","headers","Content-Type","body","media","then","corsProxyPrefix","originalUrl","decodeURIComponent","originalUrlParts","assetUrl","guessContentType","extension","pop","file","formData","FormData","interactableId","addMedia","needsToBeUploaded","File","fireLoadingTimeout","eventName","clearTimeout","delay","reader","FileReader","onload","view","DataView","target","getUint16","byteLength","marker","getUint32","little","tags","readAsArrayBuffer","getOrientation","response","srcUrl","raw","searchParams","meta","access_token","href","file_id","promotion_token","catch","MediaStream","NAF","clientId","objectType"],"mappings":"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","file":"assets/js/avatar-selector-aede4ada46347f72e5b8.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t8: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([612,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import uuid from \"uuid/v4\";\nimport { Socket } from \"phoenix\";\n\nexport function connectToReticulum(debug = false) {\n  const qs = new URLSearchParams(location.search);\n\n  const socketProtocol = qs.get(\"phx_protocol\") || (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n  let socketHost = qs.get(\"phx_host\");\n  let socketPort = qs.get(\"phx_port\");\n\n  if (process.env.RETICULUM_SERVER) {\n    const [retHost, retPort] = process.env.RETICULUM_SERVER.split(\":\");\n    socketHost = socketHost || retHost || \"\";\n    socketPort = socketPort || retPort || \"443\";\n  } else {\n    socketHost = socketHost || document.location.hostname || \"\";\n    socketPort = socketPort || document.location.port || \"443\";\n  }\n\n  const socketUrl = `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}/socket`;\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {\n    params: { session_id: uuid() }\n  };\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  const socket = new Socket(socketUrl, socketSettings);\n  socket.connect();\n\n  return socket;\n}\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (process.env.RETICULUM_SERVER) {\n    return `https://${process.env.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n","AFRAME.registerComponent(\"gamma-factor\", {\n  schema: {\n    gammaFactor: { type: \"number\", default: 2.2 }\n  },\n\n  init() {\n    const el = this.el;\n\n    if (!el.isScene) {\n      console.warn(\"gamma-factor component can only be applied to <a-scene>\");\n    }\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const sceneEl = this.el;\n    const renderer = sceneEl.renderer;\n    let needsShaderUpdate = false;\n\n    if (data.gammaFactor !== prevData.gammaFactor) {\n      renderer.gammaFactor = data.gammaFactor;\n      needsShaderUpdate = true;\n    }\n\n    if (!needsShaderUpdate || sceneEl.time === 0) {\n      return;\n    }\n\n    sceneEl.object3D.traverse(function(node) {\n      if (!node.isMesh) {\n        return;\n      }\n\n      if (Array.isArray(node.material)) {\n        node.material.forEach(function(material) {\n          material.needsUpdate = true;\n        });\n      } else {\n        node.material.needsUpdate = true;\n      }\n    });\n  }\n});\n","// As temporary measure to avoid having to customize the `sound` component that currently lives in `aframe`,\n// we say that a `scene-sound` will have an associated `sound` component that is triggered when the given\n// event is fired on the scene.\nAFRAME.registerComponent(\"scene-sound\", {\n  multiple: true,\n  schema: {\n    sound: { type: \"string\" },\n    on: { type: \"string\" },\n    off: { type: \"string\" }\n  },\n\n  init() {\n    const sound = this.el.components[`${this.attrName.replace(\"scene-\", \"\")}`];\n    this.el.sceneEl.addEventListener(this.data.on, sound.playSound);\n    sound.stopSound = sound.stopSound.bind(sound); // wat\n\n    if (this.data.off) {\n      this.el.sceneEl.addEventListener(this.data.off, sound.stopSound);\n    }\n  }\n});\n","import Raven from \"raven-js\";\n\nexport default function registerTelemetry() {\n  if (process.env.NODE_ENV === \"production\") {\n    Raven.config(\"https://013d6a364fed43cdb0539a61d520597a@sentry.prod.mozaws.net/370\").install();\n  }\n}\n","import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\"\n  }\n];\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      uploadPromotionTokens: []\n    });\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  update(newState) {\n    const finalState = merge(this.state, newState);\n    const { valid } = validator.validate(finalState, SCHEMA);\n\n    if (!valid) {\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\n      // sensitive data in the error message.\n      throw new Error(`Write to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","import nextTick from \"../utils/next-tick\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-utils\";\n\nconst GLTFCache = {};\nlet CachedEnvMapTexture = null;\n\nfunction inflateComponent(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || inflateComponent;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\nfunction cloneSkinnedMesh(source) {\n  const cloneLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, function(sourceNode, clonedNode) {\n    cloneLookup.set(sourceNode, clonedNode);\n  });\n\n  source.traverse(function(sourceMesh) {\n    if (!sourceMesh.isSkinnedMesh) return;\n\n    const sourceBones = sourceMesh.skeleton.bones;\n    const clonedMesh = cloneLookup.get(sourceMesh);\n\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\n\n    clonedMesh.skeleton.bones = sourceBones.map(function(sourceBone) {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedMesh.bind(clonedMesh.skeleton, sourceMesh.bindMatrix);\n  });\n\n  return clone;\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.animations,\n    scene: cloneSkinnedMesh(gltf.scene)\n  };\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(node, templates, isRoot, modelToWorldScale) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const hubsComponents = node.userData.gltfExtensions && node.userData.gltfExtensions.HUBS_components;\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  const entityComponents = hubsComponents || legacyComponents;\n\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.setAttribute(\"position\", {\n    x: node.position.x,\n    y: node.position.y,\n    z: node.position.z\n  });\n  el.setAttribute(\"rotation\", {\n    x: node.rotation.x * THREE.Math.RAD2DEG,\n    y: node.rotation.y * THREE.Math.RAD2DEG,\n    z: node.rotation.z * THREE.Math.RAD2DEG\n  });\n  el.setAttribute(\"scale\", {\n    x: node.scale.x * (modelToWorldScale !== undefined ? modelToWorldScale : 1),\n    y: node.scale.y * (modelToWorldScale !== undefined ? modelToWorldScale : 1),\n    z: node.scale.z * (modelToWorldScale !== undefined ? modelToWorldScale : 1)\n  });\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  if (entityComponents) {\n    for (const prop in entityComponents) {\n      if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n        const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n        inflator(el, componentName, entityComponents[prop], entityComponents);\n      }\n    }\n  }\n\n  return el;\n};\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction getFilesFromSketchfabZip(src) {\n  return new Promise((resolve, reject) => {\n    const worker = new SketchfabZipWorker();\n    worker.onmessage = e => {\n      const [success, fileMapOrError] = e.data;\n      (success ? resolve : reject)(fileMapOrError);\n    };\n    worker.postMessage(src);\n  });\n}\n\nasync function loadEnvMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new THREE.CubeTextureLoader().load(urls);\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nasync function loadGLTF(src, contentType, preferredTechnique, onProgress) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await getFilesFromSketchfabZip(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const gltfLoader = new THREE.GLTFLoader();\n  gltfLoader.customURLResolver = getCustomGLTFParserURLResolver(gltfUrl);\n  gltfLoader.setLazy(true);\n\n  const { parser } = await new Promise((resolve, reject) => gltfLoader.load(gltfUrl, resolve, onProgress, reject));\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  if (!CachedEnvMapTexture) {\n    CachedEnvMapTexture = loadEnvMap();\n  }\n\n  const gltf = await new Promise((resolve, reject) =>\n    parser.parse(\n      (scene, scenes, cameras, animations, json) => {\n        resolve({ scene, scenes, cameras, animations, json });\n      },\n      e => {\n        reject(e);\n      }\n    )\n  );\n\n  const envMap = await CachedEnvMapTexture;\n\n  gltf.scene.traverse(object => {\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n\n    if (object.material && object.material.type === \"MeshStandardMaterial\") {\n      if (preferredTechnique === \"KHR_materials_unlit\") {\n        object.material = MobileStandardMaterial.fromStandardMaterial(object.material);\n      } else {\n        object.material.envMap = envMap;\n        object.material.needsUpdate = true;\n      }\n    }\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async loadModel(src, contentType, technique, useCache) {\n    if (useCache) {\n      if (!GLTFCache[src]) {\n        GLTFCache[src] = await loadGLTF(src, contentType, technique);\n      }\n\n      return cloneGltf(GLTFCache[src]);\n    } else {\n      return await loadGLTF(src, contentType, technique);\n    }\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.removeInflatedEl();\n        }\n        return;\n      }\n\n      const gltf = await this.loadModel(src, contentType, this.preferredTechnique, this.data.useCache);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.removeInflatedEl();\n\n      this.model = gltf.scene || gltf.scenes[0];\n      this.model.animations = gltf.animations;\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(gltf.animations);\n      }\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(this.model, this.templates, true, this.data.modelToWorldScale))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      delete GLTFCache[src];\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  removeInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n      delete this.inflatedEl;\n    }\n  }\n});\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  }\n});\n","/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.smoothing = 0.3;\n    this.threshold = 0.01;\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n    this.analyser.getByteTimeDomainData(this.levels);\n\n    let sum = 0;\n    for (let i = 0; i < this.levels.length; i++) {\n      const amplitude = (this.levels[i] - 128) / 128;\n      sum += amplitude * amplitude;\n    }\n    let currVolume = Math.sqrt(sum / this.levels.length);\n    if (currVolume < this.threshold) {\n      currVolume = 0;\n    }\n    this.volume = this.smoothing * currVolume + (1 - this.smoothing) * this.prevVolume;\n    this.prevVolume = this.volume;\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 1.5 }\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const scale = Math.min(maxScale, minScale + (maxScale - minScale) * audioAnalyser.volume * 8);\n    this.el.object3D.scale.setScalar(scale);\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n","const VERTEX_SHADER = `\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n`;\n\nconst FRAGMENT_SHADER = `\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n`;\n\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\n  type = \"MobileStandardMaterial\";\n  isMobileStandardMaterial = true;\n  static fromStandardMaterial(material) {\n    const parameters = {\n      vertexShader: VERTEX_SHADER,\n      fragmentShader: FRAGMENT_SHADER,\n      uniforms: {\n        uvTransform: { value: new THREE.Matrix3() },\n        diffuse: { value: material.color },\n        opacity: { value: material.opacity },\n        map: { value: material.map },\n        aoMapIntensity: { value: material.aoMapIntensity },\n        aoMap: { value: material.aoMap },\n        emissive: { value: material.emissive },\n        emissiveMap: { value: material.emissiveMap }\n      },\n      fog: true,\n      lights: false,\n      opacity: material.opacity,\n      transparent: material.transparent,\n      skinning: material.skinning,\n      morphTargets: material.morphTargets\n    };\n\n    const mobileMaterial = new MobileStandardMaterial(parameters);\n\n    mobileMaterial.color = material.color;\n    mobileMaterial.map = material.map;\n    mobileMaterial.aoMap = material.aoMap;\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\n    mobileMaterial.emissive = material.emissive;\n    mobileMaterial.emissiveMap = material.emissiveMap;\n\n    return mobileMaterial;\n  }\n  clone() {\n    return MobileStandardMaterial.fromStandardMaterial(this);\n  }\n}\n","import \"aframe\";\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { IntlProvider, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\n\nimport { lang, messages } from \"./utils/i18n\";\n\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"./assets/stylesheets/avatar-selector.scss\";\nimport \"three/examples/js/loaders/GLTFLoader\";\n\nimport \"./components/animation-mixer\";\nimport \"./components/audio-feedback\";\nimport \"./components/loop-animation\";\nimport \"./components/gamma-factor\";\nimport \"./components/scene-sound\";\nimport \"./gltf-component-mappings\";\nimport { avatars } from \"./assets/avatars/avatars\";\n\nimport registerTelemetry from \"./telemetry\";\nimport { App } from \"./App\";\nimport AvatarSelector from \"./react-components/avatar-selector\";\n\naddLocaleData([...en]);\n\nregisterTelemetry();\n\nfunction getHashArg(arg) {\n  return new URLSearchParams(location.hash.replace(/^#/, \"?\")).get(arg);\n}\n\nwindow.APP = new App();\nwindow.APP.quality = getHashArg(\"quality\") || AFRAME.utils.device.isMobile() ? \"low\" : \"high\";\n\nfunction postAvatarIdToParent(newAvatarId) {\n  window.parent.postMessage({ avatarId: newAvatarId }, location.origin);\n}\n\nfunction mountUI() {\n  const avatarId = getHashArg(\"avatar_id\");\n  ReactDOM.render(\n    <IntlProvider locale={lang} messages={messages}>\n      <AvatarSelector {...{ avatars, avatarId, onChange: postAvatarIdToParent }} />\n    </IntlProvider>,\n    document.getElementById(\"selector-root\")\n  );\n}\n\nwindow.addEventListener(\"hashchange\", mountUI);\ndocument.addEventListener(\"DOMContentLoaded\", mountUI);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl } from \"react-intl\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faAngleLeft } from \"@fortawesome/free-solid-svg-icons/faAngleLeft\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nclass AvatarSelector extends Component {\n  static propTypes = {\n    avatars: PropTypes.array,\n    avatarId: PropTypes.string,\n    onChange: PropTypes.func\n  };\n\n  static getAvatarIndex = (props, offset = 0) => {\n    const currAvatarIndex = props.avatars.findIndex(avatar => avatar.id === props.avatarId);\n    const numAvatars = props.avatars.length;\n    return (((currAvatarIndex + offset) % numAvatars) + numAvatars) % numAvatars;\n  };\n  static nextAvatarIndex = props => AvatarSelector.getAvatarIndex(props, -1);\n  static previousAvatarIndex = props => AvatarSelector.getAvatarIndex(props, 1);\n\n  state = {\n    initialAvatarIndex: 0,\n    avatarIndices: []\n  };\n\n  getAvatarIndex = (offset = 0) => AvatarSelector.getAvatarIndex(this.props, offset);\n  nextAvatarIndex = () => this.getAvatarIndex(-1);\n  previousAvatarIndex = () => this.getAvatarIndex(1);\n\n  emitChangeToNext = () => {\n    const nextAvatarId = this.props.avatars[this.nextAvatarIndex()].id;\n    this.props.onChange(nextAvatarId);\n  };\n\n  emitChangeToPrevious = () => {\n    const previousAvatarId = this.props.avatars[this.previousAvatarIndex()].id;\n    this.props.onChange(previousAvatarId);\n  };\n\n  constructor(props) {\n    super(props);\n    this.state.initialAvatarIndex = AvatarSelector.getAvatarIndex(props);\n    this.state.avatarIndices = [\n      AvatarSelector.nextAvatarIndex(props),\n      this.state.initialAvatarIndex,\n      AvatarSelector.previousAvatarIndex(props)\n    ];\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    // Push new avatar indices onto the array if necessary.\n    this.setState(state => {\n      const numAvatars = nextProps.avatars.length;\n      if (state.avatarIndices.length === numAvatars) return;\n\n      const lastIndex = numAvatars - 1;\n      const currAvatarIndex = this.getAvatarIndex();\n      const nextAvatarIndex = AvatarSelector.getAvatarIndex(nextProps);\n      const avatarIndices = Array.from(state.avatarIndices);\n      const increasing = currAvatarIndex - nextAvatarIndex < 0;\n\n      let direction = -1;\n      let push = false;\n\n      if (nextAvatarIndex === 0) {\n        if (currAvatarIndex === lastIndex) {\n          direction = 1;\n          push = avatarIndices.indexOf(lastIndex) !== 0;\n        } else {\n          direction = -1;\n          push = avatarIndices.indexOf(1) !== 0;\n        }\n      } else if (nextAvatarIndex === lastIndex) {\n        if (currAvatarIndex === 0) {\n          direction = -1;\n          push = avatarIndices.indexOf(0) === 0;\n        } else {\n          direction = 1;\n          push = avatarIndices.indexOf(lastIndex - 1) !== 0;\n        }\n      } else {\n        direction = increasing ? 1 : -1;\n        push = increasing;\n      }\n\n      const addIndex = AvatarSelector.getAvatarIndex(nextProps, direction);\n      if (avatarIndices.includes(addIndex)) return;\n\n      if (push) {\n        avatarIndices.push(addIndex);\n      } else {\n        avatarIndices.unshift(addIndex);\n      }\n      return { avatarIndices };\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.avatarId !== prevProps.avatarId) {\n      // HACK - a-animation ought to restart the animation when the `to` attribute changes, but it doesn't\n      // so we need to force it here.\n      const currRot = this.animation.parentNode.getAttribute(\"rotation\");\n      const currY = currRot.y;\n      const toRot = this.animation.getAttribute(\"to\").split(\" \");\n      const toY = toRot[1];\n      const step = 360.0 / this.props.avatars.length;\n      const brokenlyBigRotation = Math.abs(toY - currY) > 3 * step;\n      let fromY = currY;\n      if (brokenlyBigRotation) {\n        // Rotation in Y wrapped around 360. Adjust the \"from\" to prevent a dramatic rotation\n        fromY = currY < toY ? currY + 360 : currY - 360;\n      }\n      this.animation.setAttribute(\"from\", `${currRot.x} ${fromY} ${currRot.z}`);\n      this.animation.stop();\n      this.animation.handleMixinUpdate();\n      this.animation.start();\n    }\n  }\n\n  componentDidMount() {\n    // <a-scene> component not initialized until scene element mounted and loaded.\n    this.scene.addEventListener(\"loaded\", () => {\n      this.scene.setAttribute(\"renderer\", { gammaOutput: true, sortObjects: true, physicallyCorrectLights: true });\n      this.scene.setAttribute(\"gamma-factor\", \"\");\n      this.scene.setAttribute(\"shadow\", { type: \"pcfsoft\", enabled: window.APP.quality !== \"low\" });\n    });\n  }\n\n  render() {\n    const avatarAssets = this.props.avatars.map(avatar => (\n      <a-asset-item id={avatar.id} key={avatar.id} response-type=\"arraybuffer\" src={`${avatar.model}`} />\n    ));\n    const avatarData = this.state.avatarIndices.map(i => [this.props.avatars[i], i]);\n    const avatarEntities = avatarData.map(([avatar, i]) => (\n      <a-entity key={avatar.id} rotation={`0 ${(360 * -i) / this.props.avatars.length} 0`}>\n        <a-entity position=\"0 0 5\" gltf-model-plus={`src: #${avatar.id}; inflate: true`}>\n          <a-animation\n            attribute=\"rotation\"\n            dur=\"12000\"\n            to={`0 ${this.getAvatarIndex() === i ? 360 : 0} 0`}\n            repeat=\"indefinite\"\n          />\n        </a-entity>\n      </a-entity>\n    ));\n\n    const rotationFromIndex = index => ((360 * index) / this.props.avatars.length + 180) % 360;\n    const initialRotation = rotationFromIndex(this.state.initialAvatarIndex);\n    const toRotation = rotationFromIndex(this.getAvatarIndex());\n\n    return (\n      <div className=\"avatar-selector\">\n        <a-scene vr-mode-ui=\"enabled: false\" ref={sce => (this.scene = sce)}>\n          <a-assets>{avatarAssets}</a-assets>\n\n          <a-entity rotation={`0 ${initialRotation} 0`}>\n            <a-animation\n              ref={anm => (this.animation = anm)}\n              attribute=\"rotation\"\n              dur=\"2000\"\n              easing=\"ease-out\"\n              to={`0 ${toRotation} 0`}\n            />\n            {avatarEntities}\n          </a-entity>\n\n          <a-entity position=\"0 1.5 -5.6\" rotation=\"-10 180 0\">\n            <a-entity camera=\"far: 1;\" />\n          </a-entity>\n\n          <a-entity\n            hide-when-quality=\"low\"\n            light=\"type: directional; color: #F9FFCE; intensity: 0.6\"\n            position=\"0 5 -15\"\n          />\n          <a-entity hide-when-quality=\"low\" light=\"type: ambient; color: #FFF\" />\n        </a-scene>\n        <WithHoverSound>\n          <button className=\"avatar-selector__previous-button\" onClick={this.emitChangeToPrevious}>\n            <FontAwesomeIcon icon={faAngleLeft} />\n          </button>\n        </WithHoverSound>\n        <WithHoverSound>\n          <button className=\"avatar-selector__next-button\" onClick={this.emitChangeToNext}>\n            <FontAwesomeIcon icon={faAngleRight} />\n          </button>\n        </WithHoverSound>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarSelector);\n","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo) {\\n  float ratio = 0.0;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n    float line = mod(hubs_Time / 3000.0 * size, size * 2.0) + hubs_SweepParams.s - size / 2.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / size * 3.0);\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\"","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    clip: { type: \"string\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n\n    this.updateClip();\n  },\n\n  update(oldData) {\n    if (oldData.clip !== this.data.clip && this.mixerEl) {\n      this.updateClip();\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const clipName = this.data.clip;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clip;\n\n    if (!clipName) {\n      clip = animations[0];\n    } else {\n      clip = animations.find(({ name }) => name === clipName);\n    }\n\n    if (!clip) {\n      return;\n    }\n\n    const action = mixer.clipAction(clip, this.el.object3D);\n    action.enabled = true;\n    action.setLoop(THREE.LoopRepeat, Infinity).play();\n    this.currentAction = action;\n  },\n\n  destroy() {\n    if (this.currentAction) {\n      this.currentAction.enabled = false;\n      this.currentAction.stop();\n    }\n  }\n});\n","import \"./components/gltf-model-plus\";\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"collision-filter\", \"collision-filter\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\");\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"body\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\");\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\"shape\", \"shape\");\nAFRAME.GLTFModelPlus.registerComponent(\"heightfield\", \"heightfield\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        shape: \"box\",\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"hoverable\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\n  // nav-mesh-helper will query for it later.\n  el.setAttribute(\"nav-mesh\");\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  el.setAttribute(\"media-loader\", { src: componentData.src, resize: true, resolve: true, fileIsOwned: true });\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nfunction mediaInflator(el, componentName, componentData, components) {\n  if (components.networked) {\n    el.setAttribute(\"networked\", {\n      template: componentData.controls ? \"#static-controlled-media\" : \"#static-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {\n    projection: componentData.projection\n  };\n\n  if (componentName === \"video\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.volume = componentData.volume;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.audioType = componentData.audioType;\n\n    if (componentData.audioType === \"pannernode\") {\n      mediaOptions.distanceModel = componentData.distanceModel;\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\n      mediaOptions.refDistance = componentData.refDistance;\n      mediaOptions.maxDistance = componentData.maxDistance;\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\n    }\n  }\n\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    mediaOptions\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator);\n","import Store from \"./storage/store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl } from \"./phoenix-utils\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\n\nconst nonCorsProxyDomains = (process.env.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\"\n};\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nexport const proxiedUrlFor = (url, index) => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  // Skip known domains that do not require CORS proxying.\n  try {\n    const parsedUrl = new URL(url);\n    if (nonCorsProxyDomains.find(domain => parsedUrl.hostname.endsWith(domain))) return url;\n  } catch (e) {\n    // Ignore\n  }\n\n  // farspark doesn't know how to read '=' base64 padding characters\n  const base64Url = b64EncodeUnicode(url).replace(/=+$/g, \"\");\n\n  if (index != null || !process.env.CORS_PROXY_SERVER) {\n    // translate base64 + to - and / to _ for URL safety\n    const encodedUrl = base64Url.replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n    const method = index != null ? \"extract\" : \"raw\";\n    return `https://${process.env.FARSPARK_SERVER}/0/${method}/0/0/0/${index || 0}/${encodedUrl}`;\n  } else {\n    const encodedUrl = encodeURIComponent(url);\n    return `https://${process.env.CORS_PROXY_SERVER}/${encodedUrl}`;\n  }\n};\n\nconst resolveUrlCache = new Map();\nexport const resolveUrl = async (url, index) => {\n  const cacheKey = `${url}|${index}`;\n  if (resolveUrlCache.has(cacheKey)) return resolveUrlCache.get(cacheKey);\n  const resolved = await fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, index } })\n  }).then(r => r.json());\n  resolveUrlCache.set(cacheKey, resolved);\n  return resolved;\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => (url, path) => {\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (process.env.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + url;\n      return corsProxyPrefix + encodeURIComponent(assetUrl);\n    }\n  }\n\n  return path + url;\n};\n\nexport const guessContentType = url => {\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  const extension = new URL(url).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nexport const upload = file => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n  return fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nlet interactableId = 0;\nexport const addMedia = (src, template, contentOrigin, resolve = false, resize = false) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n  entity.id = \"interactable-media-\" + interactableId++;\n  entity.setAttribute(\"networked\", { template: template });\n  const needsToBeUploaded = src instanceof File;\n  entity.setAttribute(\"media-loader\", {\n    resize,\n    resolve,\n    src: typeof src === \"string\" ? src : \"\",\n    fileIsOwned: !needsToBeUploaded\n  });\n  scene.appendChild(entity);\n\n  const fireLoadingTimeout = setTimeout(() => {\n    scene.emit(\"media-loading\", { src: src });\n  }, 100);\n\n  [\"model-loaded\", \"video-loaded\", \"image-loaded\"].forEach(eventName => {\n    entity.addEventListener(eventName, () => {\n      clearTimeout(fireLoadingTimeout);\n\n      if (!entity.classList.contains(\"pen\") && !entity.getAttribute(\"animation__spawn-start\")) {\n        entity.object3D.scale.setScalar(0.5);\n        entity.matrixNeedsUpdate = true;\n\n        entity.setAttribute(\"animation__spawn-start\", {\n          property: \"scale\",\n          delay: 50,\n          dur: 300,\n          from: { x: 0.5, y: 0.5, z: 0.5 },\n          to: { x: 1.0, y: 1.0, z: 1.0 },\n          easing: \"easeOutElastic\"\n        });\n      }\n\n      scene.emit(\"media-loaded\", { src: src });\n    });\n  });\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    upload(src)\n      .then(response => {\n        const srcUrl = new URL(response.raw);\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const vertexRegex = /\\bskinning_vertex\\b/;\n  const fragRegex = /\\bgl_FragColor\\b/;\n  const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\n\n  const shaderUniforms = new Map();\n\n  obj.traverse(object => {\n    if (!object.material || !validMaterials.includes(object.material.type)) {\n      return;\n    }\n\n    // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n    // material, so maps cannot be updated at runtime. This breaks UI elements who have\n    // hover/toggle state, so for now just skip these while we figure out a more correct\n    // solution.\n    if (object.el.classList.contains(\"ui\")) return;\n    if (object.el.classList.contains(\"hud\")) return;\n    if (object.el.getAttribute(\"text-button\")) return;\n\n    object.material = object.material.clone();\n    object.material.onBeforeCompile = shader => {\n      if (!vertexRegex.test(shader.vertexShader)) return;\n\n      shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n      shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n      shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n      shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n      shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n      shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n      shader.uniforms.hubs_Time = { value: 0 };\n\n      const vchunk = `\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      `;\n\n      const vlines = shader.vertexShader.split(\"\\n\");\n      const vindex = vlines.findIndex(line => vertexRegex.test(line));\n      vlines.splice(vindex + 1, 0, vchunk);\n      vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\n      vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n      vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n      shader.vertexShader = vlines.join(\"\\n\");\n\n      const flines = shader.fragmentShader.split(\"\\n\");\n      const findex = flines.findIndex(line => fragRegex.test(line));\n      flines.splice(findex + 1, 0, mediaHighlightFrag);\n      flines.unshift(\"varying vec3 hubs_WorldPosition;\");\n      flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\n      flines.unshift(\"uniform vec2 hubs_SweepParams;\");\n      flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n      flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\n      flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n      flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\n      flines.unshift(\"uniform float hubs_Time;\");\n      shader.fragmentShader = flines.join(\"\\n\");\n\n      shaderUniforms.set(object.material.uuid, shader.uniforms);\n    };\n    object.material.needsUpdate = true;\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n"],"sourceRoot":""}