!function(e){function t(t){for(var i,o,r=t[0],l=t[1],c=t[2],u=0,h=[];u<r.length;u++)o=r[u],a[o]&&h.push(a[o][0]),a[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(d&&d(t);h.length;)h.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],i=!0,r=1;r<s.length;r++){var l=s[r];0!==a[l]&&(i=!1)}i&&(n.splice(t--,1),e=o(o.s=s[0]))}return e}var i={},a={3:0},n=[];function o(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=i,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(s,i,function(t){return e[t]}.bind(null,i));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;n.push([240,1,0]),s()}([,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e};const a=t.paths={};a.noop="/noop",a.actions={},a.actions.log="/actions/log",a.actions.toggleScreenShare="/actions/toggleScreenShare",a.actions.snapRotateLeft="/actions/snapRotateLeft",a.actions.snapRotateRight="/actions/snapRotateRight",a.actions.logDebugFrame="/actions/logDebugFrame",a.actions.cameraDelta="/actions/cameraDelta",a.actions.characterAcceleration="/actions/characterAcceleration",a.actions.boost="/actions/boost",a.actions.startGazeTeleport="/actions/startTeleport",a.actions.stopGazeTeleport="/actions/stopTeleport",a.actions.spawnPen="/actions/spawnPen",a.actions.ensureFrozen="/actions/ensureFrozen",a.actions.thaw="/actions/thaw",a.actions.muteMic="/actions/muteMic",a.actions.focusChat="/actions/focusChat",a.actions.cursor={},a.actions.cursor.pose="/actions/cursorPose",a.actions.cursor.grab="/actions/cursorGrab",a.actions.cursor.drop="/actions/cursorDrop",a.actions.cursor.modDelta="/actions/cursorModDelta",a.actions.cursor.startDrawing="/actions/cursorStartDrawing",a.actions.cursor.stopDrawing="/actions/cursorStopDrawing",a.actions.cursor.undoDrawing="/actions/cursorUndoDrawing",a.actions.cursor.penNextColor="/actions/cursorPenNextColor",a.actions.cursor.penPrevColor="/actions/cursorPenPrevColor",a.actions.cursor.scalePenTip="/actions/cursorScalePenTip",a.actions.cursor.scaleGrabbedGrabbable="/actions/cursorScaleGrabbedGrabbable",a.actions.cursor.takeSnapshot="/actions/cursorTakeSnapshot",a.actions.rightHand={},a.actions.rightHand.pose="/actions/rightHandPose",a.actions.rightHand.grab="/actions/rightHandGrab",a.actions.rightHand.drop="/actions/rightHandDrop",a.actions.rightHand.modDelta="/actions/rightHandModDelta",a.actions.rightHand.startDrawing="/actions/rightHandStartDrawing",a.actions.rightHand.stopDrawing="/actions/rightHandStopDrawing",a.actions.rightHand.undoDrawing="/actions/rightHandUndoDrawing",a.actions.rightHand.penNextColor="/actions/rightHandPenNextColor",a.actions.rightHand.penPrevColor="/actions/rightHandPenPrevColor",a.actions.rightHand.scalePenTip="/actions/rightHandScalePenTip",a.actions.rightHand.startTeleport="/actions/rightHandStartTeleport",a.actions.rightHand.stopTeleport="/actions/rightHandStopTeleport",a.actions.rightHand.takeSnapshot="/actions/rightHandTakeSnapshot",a.actions.rightHand.thumb="/actions/rightHand/thumbDown",a.actions.rightHand.index="/actions/rightHand/indexDown",a.actions.rightHand.middleRingPinky="/actions/rightHand/middleRingPinkyDown",a.actions.leftHand={},a.actions.leftHand.pose="/actions/leftHandPose",a.actions.leftHand.grab="/actions/leftHandGrab",a.actions.leftHand.drop="/actions/leftHandDrop",a.actions.leftHand.modDelta="/actions/leftHandModDelta",a.actions.leftHand.startDrawing="/actions/leftHandStartDrawing",a.actions.leftHand.stopDrawing="/actions/leftHandStopDrawing",a.actions.leftHand.undoDrawing="/actions/leftHandUndoDrawing",a.actions.leftHand.penNextColor="/actions/leftHandPenNextColor",a.actions.leftHand.penPrevColor="/actions/leftHandPenPrevColor",a.actions.leftHand.scalePenTip="/actions/leftHandScalePenTip",a.actions.leftHand.startTeleport="/actions/leftHandStartTeleport",a.actions.leftHand.stopTeleport="/actions/leftHandStopTeleport",a.actions.leftHand.takeSnapshot="/actions/leftHandTakeSnapshot",a.actions.leftHand.thumb="/actions/leftHand/thumbDown",a.actions.leftHand.index="/actions/leftHand/indexDown",a.actions.leftHand.middleRingPinky="/actions/leftHand/middleRingPinkyDown",a.actions.camera={},a.actions.camera.exitMirror="/actions/cameraExitMirror",a.device={},a.device.mouse={},a.device.mouse.coords="/device/mouse/coords",a.device.mouse.movementXY="/device/mouse/movementXY",a.device.mouse.buttonLeft="/device/mouse/buttonLeft",a.device.mouse.buttonRight="/device/mouse/buttonRight",a.device.mouse.wheel="/device/mouse/wheel",a.device.smartMouse={},a.device.smartMouse.cursorPose="/device/smartMouse/cursorPose",a.device.smartMouse.cameraDelta="/device/smartMouse/cameraDelta",a.device.touchscreen={},a.device.touchscreen.cursorPose="/device/touchscreen/cursorPose",a.device.touchscreen.touchCameraDelta="/device/touchscreen/touchCameraDelta",a.device.touchscreen.gyroCameraDelta="/device/touchscreen/gyroCameraDelta",a.device.touchscreen.cameraDelta="/device/touchscreen/cameraDelta",a.device.touchscreen.pinch={},a.device.touchscreen.pinch.delta="/device/touchscreen/pinch/delta",a.device.touchscreen.pinch.initialDistance="/device/touchscreen/pinch/initialDistance",a.device.touchscreen.pinch.currentDistance="/device/touchscreen/pinch/currentDistance",a.device.touchscreen.isTouchingGrabbable="/device/touchscreen/isTouchingGrabbable",a.device.gyro={},a.device.gyro.averageDeltaX="/device/gyro/averageDeltaX",a.device.gyro.averageDeltaY="/device/gyro/averageDeltaY",a.device.hud={},a.device.hud.penButton="/device/hud/penButton",a.device.keyboard={key:e=>`/device/keyboard/${e.toLowerCase()}`},a.device.gamepad=(e=>({button:t=>({pressed:`/device/gamepad/${e}/button/${t}/pressed`,touched:`/device/gamepad/${e}/button/${t}/touched`,value:`/device/gamepad/${e}/button/${t}/value`}),axis:t=>`/device/gamepad/${e}/axis/${t}`}));const n="/device/xbox/";a.device.xbox={button:e=>({pressed:`${n}button/${e}/pressed`,touched:`${n}button/${e}/touched`,value:`${n}button/${e}/value`}),axis:e=>`${n}axis/${e}`};const o="/device/oculusgo/";a.device.oculusgo={button:e=>({pressed:`${o}button/${e}/pressed`,touched:`${o}button/${e}/touched`,value:`${o}button/${e}/value`}),axis:e=>`${o}axis/${e}`,trigger:{pressed:`${o}button/trigger/pressed`,touched:`${o}button/trigger/touched`,value:`${o}button/trigger/value`},touchpad:{pressed:`${o}button/touchpad/pressed`,touched:`${o}button/touchpad/touched`,value:`${o}button/touchpad/value`,axisX:`${o}axis/touchpadX`,axisY:`${o}axis/touchpadY`},pose:`${o}pose`,v:e=>`/vars/oculusgo/${e}`};const r="/device/gearVRController/";a.device.gearVRController={button:e=>({pressed:`${r}button/${e}/pressed`,touched:`${r}button/${e}/touched`,value:`${r}button/${e}/value`}),axis:e=>`${r}axis/${e}`,pose:`${r}pose`,v:e=>`/vars/gearVRController/${e}`};const l="/device/daydream/";a.device.daydream={button:e=>({pressed:`${l}button/${e}/pressed`,touched:`${l}button/${e}/touched`,value:`${l}button/${e}/value`}),axis:e=>`${l}axis/${e}`,pose:`${l}pose`};const c="/device/rightOculusTouch/";a.device.rightOculusTouch={button:e=>({pressed:`${c}button/${e}/pressed`,touched:`${c}button/${e}/touched`,value:`${c}button/${e}/value`}),axis:e=>`${c}axis/${e}`,pose:`${c}pose`};const d="/device/leftOculusTouch/";function u(e,t,s){return{pressed:`${e}${t}/button/${s}/pressed`,touched:`${e}${t}/button/${s}/touched`,value:`${e}${t}/button/${s}/value`}}function h(e,t,s){return{axisX:`${e}${t}/axis/${s}X`,axisY:`${e}${t}/axis/${s}Y`}}function p(e){const t="/device/wmr/";return{touchpad:i({},u(t,e,"touchpad"),h(t,e,"touchpad")),trigger:u(t,e,"trigger"),grip:u(t,e,"grip"),menu:u(t,e,"menu"),joystick:h(t,e,"joystick"),pose:`${t}${e}/pose`}}a.device.leftOculusTouch={button:e=>({pressed:`${d}button/${e}/pressed`,touched:`${d}button/${e}/touched`,value:`${d}button/${e}/value`}),axis:e=>`${d}axis/${e}`,pose:`${d}pose`},a.device.vive={},a.device.vive.left={button:e=>({pressed:`/device/vive/left/button/${e}/pressed`,touched:`/device/vive/left/button/${e}/touched`,value:`/device/vive/left/button/${e}/value`}),axis:e=>`/device/vive/left/axis/${e}`,pose:"/device/vive/left/pose"},a.device.vive.right={button:e=>({pressed:`/device/vive/right/button/${e}/pressed`,touched:`/device/vive/right/button/${e}/touched`,value:`/device/vive/right/button/${e}/value`}),axis:e=>`/device/vive/right/axis/${e}`,pose:"/device/vive/right/pose"},a.device.wmr={},a.device.wmr.v=(e=>`/vars/wmr/${e}`),a.device.wmr.k=(e=>`/vars/wmr/keyboard/${e}`),a.device.wmr.left=p("left"),a.device.wmr.right=p("right")},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WithHoverSound=t.hudHoverSound=t.ReactAudioContext=void 0;var i=s(1),a=r(i),n=s(0),o=r(n);function r(e){return e&&e.__esModule?e:{default:e}}const l=t.ReactAudioContext=a.default.createContext({}),c=t.hudHoverSound="play_sound-hud_hover_start",d=t.WithHoverSound=(({sound:e,children:t})=>a.default.createElement(l.Consumer,null,s=>a.default.cloneElement(t,{onMouseEnter:i=>{s&&s.playSound&&s.playSound(e||c),t.props.onMouseEnter&&t.props.onMouseEnter(i)}})));d.propTypes={children:o.default.object,sound:o.default.string}},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=l(i),n=s(0),o=l(n),r=s(5);function l(e){return e&&e.__esModule?e:{default:e}}class c extends i.Component{constructor(e){super(e),this.onContainerClicked=(e=>{this.props.closable&&e.currentTarget===e.target&&this.props.onClose()}),this.onKeyDown=this.onKeyDown.bind(this),this.onContainerClicked=this.onContainerClicked.bind(this)}componentDidMount(){window.addEventListener("keydown",this.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.onKeyDown)}onKeyDown(e){this.props.closable&&"Escape"===e.key&&this.props.onClose()}render(){return a.default.createElement("div",{className:"dialog-overlay"},a.default.createElement("div",{className:"dialog",onClick:this.onContainerClicked},a.default.createElement("div",{className:"dialog__box"},a.default.createElement("div",{className:"dialog__box__contents"},this.props.closable&&this.props.onClose&&a.default.createElement(r.WithHoverSound,null,a.default.createElement("button",{className:"dialog__box__contents__close",onClick:this.props.onClose},a.default.createElement("span",null,"Ã—"))),a.default.createElement("div",{className:"dialog__box__contents__title"},this.props.title),a.default.createElement("div",{className:"dialog__box__contents__body"},this.props.children),a.default.createElement("div",{className:"dialog__box__contents__button-container"})))))}}t.default=c,c.propTypes={title:o.default.node,children:o.default.node.isRequired,onClose:o.default.func,closable:o.default.bool},c.defaultProps={closable:!0}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addMedia=t.upload=t.guessContentType=t.getCustomGLTFParserURLResolver=t.resolveUrl=t.proxiedUrlFor=void 0,t.injectCustomShaderChunks=function(e){const t=/\bskinning_vertex\b/,s=/\bgl_FragColor\b/,i=["MeshStandardMaterial","MeshBasicMaterial","MobileStandardMaterial"],a=new Map;return e.traverse(e=>{e.material&&i.includes(e.material.type)&&(e.el.classList.contains("ui")||e.el.classList.contains("hud")||e.el.getAttribute("text-button")||(e.material=e.material.clone(),e.material.onBeforeCompile=(i=>{if(!t.test(i.vertexShader))return;i.uniforms.hubs_EnableSweepingEffect={value:!1},i.uniforms.hubs_SweepParams={value:[0,0]},i.uniforms.hubs_InteractorOnePos={value:[0,0,0]},i.uniforms.hubs_InteractorTwoPos={value:[0,0,0]},i.uniforms.hubs_HighlightInteractorOne={value:!1},i.uniforms.hubs_HighlightInteractorTwo={value:!1},i.uniforms.hubs_Time={value:0};const n=i.vertexShader.split("\n"),o=n.findIndex(e=>t.test(e));n.splice(o+1,0,"\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      "),n.unshift("varying vec3 hubs_WorldPosition;"),n.unshift("uniform bool hubs_HighlightInteractorOne;"),n.unshift("uniform bool hubs_HighlightInteractorTwo;"),i.vertexShader=n.join("\n");const l=i.fragmentShader.split("\n"),c=l.findIndex(e=>s.test(e));l.splice(c+1,0,r.default),l.unshift("varying vec3 hubs_WorldPosition;"),l.unshift("uniform bool hubs_EnableSweepingEffect;"),l.unshift("uniform vec2 hubs_SweepParams;"),l.unshift("uniform bool hubs_HighlightInteractorOne;"),l.unshift("uniform vec3 hubs_InteractorOnePos;"),l.unshift("uniform bool hubs_HighlightInteractorTwo;"),l.unshift("uniform vec3 hubs_InteractorTwoPos;"),l.unshift("uniform float hubs_Time;"),i.fragmentShader=l.join("\n"),a.set(e.material.uuid,i.uniforms)}),e.material.needsUpdate=!0))}),a},t.getPromotionTokenForFile=function(e){return window.APP.store.state.uploadPromotionTokens.find(t=>t.fileId===e)};var i,a=s(19),n=s(12),o=s(68),r=(i=o,i&&i.__esModule?i:{default:i});const l="hubs.local,reticulum.io".split(","),c=(0,n.getReticulumFetchUrl)("/api/v1/media"),d={gltf:"model/gltf",glb:"model/gltf-binary",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",pdf:"application/pdf",mp4:"video/mp4",mp3:"audio/mpeg"};t.proxiedUrlFor=((e,t)=>{if(!e.startsWith("http:")&&!e.startsWith("https:"))return e;try{const t=new URL(e);if(l.find(e=>t.hostname.endsWith(e)))return e}catch(e){}const s=(u=e,btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)))).replace(/=+$/g,"");if(null==t&&{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER){const t=encodeURIComponent(e);return`https://${{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER}/${t}`}{const e=s.replace(/\+/g,"-").replace(/\//g,"_"),i=null!=t?"extract":"raw";return`https://farspark-dev.reticulum.io/0/${i}/0/0/0/${t||0}/${e}`}});var u;const h=new Map,p=(t.resolveUrl=(async(e,t)=>{const s=`${e}|${t}`;if(h.has(s))return h.get(s);const i=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:{url:e,index:t}})}).then(e=>e.json());return h.set(s,i),i}),t.getCustomGLTFParserURLResolver=(e=>(t,s)=>{if("string"!=typeof t||""===t)return"";if(/^(https?:)?\/\//i.test(t))return t;if(/^data:.*,.*$/i.test(t))return t;if(/^blob:.*$/i.test(t))return t;if({NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER){const s=`https://${{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.CORS_PROXY_SERVER}/`;if(e.startsWith(s)){const i=decodeURIComponent(e.substring(s.length)),a=i.split("/"),n=a.slice(0,a.length-1).join("/")+"/"+t;return s+encodeURIComponent(n)}}return s+t}),t.guessContentType=(e=>{if(e.startsWith("hubs://")&&e.endsWith("/video"))return"video/vnd.hubs-webrtc";const t=new URL(e).pathname.split(".").pop();return d[t]}),t.upload=(e=>{const t=new FormData;return t.append("media",e),t.append("promotion_mode","with_token"),fetch(c,{method:"POST",body:t}).then(e=>e.json())}));let m=0;t.addMedia=((e,t,s,i=!1,n=!1)=>{const o=AFRAME.scenes[0],r=document.createElement("a-entity");r.id="interactable-media-"+m++,r.setAttribute("networked",{template:t});const l=e instanceof File;r.setAttribute("media-loader",{resize:n,resolve:i,src:"string"==typeof e?e:"",fileIsOwned:!l}),o.appendChild(r);const c=setTimeout(()=>{o.emit("media-loading",{src:e})},100);["model-loaded","video-loaded","image-loaded"].forEach(t=>{r.addEventListener(t,()=>{clearTimeout(c),r.classList.contains("pen")||r.getAttribute("animation__spawn-start")||(r.object3D.scale.setScalar(.5),r.matrixNeedsUpdate=!0,r.setAttribute("animation__spawn-start",{property:"scale",delay:50,dur:300,from:{x:.5,y:.5,z:.5},to:{x:1,y:1,z:1},easing:"easeOutElastic"})),o.emit("media-loaded",{src:e})})});const d=new Promise(function(t){l?function(e,t){const s=new FileReader;s.onload=function(e){const s=new DataView(e.target.result);if(65496!=s.getUint16(0,!1))return t(-2);const i=s.byteLength;let a=2;for(;a<i;){if(s.getUint16(a+2,!1)<=8)return t(-1);const e=s.getUint16(a,!1);if(a+=2,65505==e){if(1165519206!=s.getUint32(a+=2,!1))return t(-1);const e=18761==s.getUint16(a+=6,!1);a+=s.getUint32(a+4,e);const i=s.getUint16(a,e);a+=2;for(let n=0;n<i;n++)if(274==s.getUint16(a+12*n,e))return t(s.getUint16(a+12*n+8,e))}else{if(65280!=(65280&e))break;a+=s.getUint16(a,!1)}}return t(-1)},s.readAsArrayBuffer(e)}(e,e=>{t(e)}):t(1)});return l?p(e).then(e=>{const t=new URL(e.raw);t.searchParams.set("token",e.meta.access_token),r.setAttribute("media-loader",{resolve:!1,src:t.href,fileId:e.file_id}),window.APP.store.update({uploadPromotionTokens:[{fileId:e.file_id,promotionToken:e.meta.promotion_token}]})}).catch(e=>{console.error("Media upload failed",e),r.setAttribute("media-loader",{src:"error"})}):e instanceof MediaStream&&r.setAttribute("media-loader",{src:`hubs://clients/${NAF.clientId}/video`}),s&&r.addEventListener("media_resolved",({detail:e})=>{const t=(0,a.objectTypeForOriginAndContentType)(s,e.contentType);o.emit("object_spawned",{objectType:t})}),{entity:r,orientation:d}})},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connectToReticulum=function(e=!1){const t=new URLSearchParams(location.search),s=t.get("phx_protocol")||("https:"===document.location.protocol?"wss:":"ws:");let i=t.get("phx_host"),a=t.get("phx_port");{const[e,t]="dev.reticulum.io".split(":");i=i||e||"",a=a||t||"443"}const r=`${s}//${i}${a?`:${a}`:""}/socket`;console.log(`Phoenix Socket URL: ${r}`);const l={params:{session_id:(0,n.default)()}};e&&(l.logger=((e,t,s)=>{console.log(`${e}: ${t}`,s)}));const c=new o.Socket(r,l);return c.connect(),c},t.getReticulumFetchUrl=r,t.getLandingPageForPhoto=function(e){const t=new URL(e);return r(t.pathname.replace(".png",".html")+t.search,!0)};var i,a=s(44),n=(i=a,i&&i.__esModule?i:{default:i}),o=s(45);document.createElement("a");function r(e,t=!1){return`https://dev.reticulum.io${e}`}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastWorldPosition=function(e,t){return t.setFromMatrixPosition(e.matrixWorld),t},t.getLastWorldQuaternion=function(e,t){return e.matrixWorld.decompose(i,t,i),t},t.getLastWorldScale=function(e,t){return e.matrixWorld.decompose(i,a,t),t};const i=new THREE.Vector3,a=new THREE.Quaternion},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=t.sets={};i.global="global",i.inputFocused="inputFocused",i.cursorHoveringOnPen="cursorHoveringOnPen",i.cursorHoveringOnCamera="cursorHoveringOnCamera",i.cursorHoveringOnInteractable="cursorHoveringOnInteractable",i.cursorHoveringOnUI="cursorHoveringOnUI",i.cursorHoveringOnNothing="cursorHoveringOnNothing",i.cursorHoldingPen="cursorHoldingPen",i.cursorHoldingCamera="cursorHoldingCamera",i.cursorHoldingInteractable="cursorHoldingInteractable",i.rightHandTeleporting="rightHandTeleporting",i.rightHandHoveringOnPen="rightHandHoveringOnPen",i.rightHandHoveringOnCamera="rightHandHoveringOnCamera",i.rightHandHoveringOnInteractable="rightHandHoveringOnInteractable",i.rightHandHoveringOnNothing="rightHandHoveringOnNothing",i.rightHandHoldingPen="rightHandHoldingPen",i.rightHandHoldingCamera="rightHandHoldingCamera",i.rightHandHoldingInteractable="rightHandHoldingInteractable",i.leftHandTeleporting="leftHandTeleporting",i.leftHandHoveringOnPen="leftHandHoveringOnPen",i.leftHandHoveringOnCamera="leftHandHoveringOnCamera",i.leftHandHoveringOnInteractable="leftHandHoveringOnInteractable",i.leftHandHoldingPen="leftHandHoldingPen",i.leftHandHoldingCamera="leftHandHoldingCamera",i.leftHandHoldingInteractable="leftHandHoldingInteractable",i.leftHandHoveringOnNothing="leftHandHoveringOnNothing"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){n.default.config("https://013d6a364fed43cdb0539a61d520597a@sentry.prod.mozaws.net/370").install()};var i,a=s(40),n=(i=a,i&&i.__esModule?i:{default:i})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=t.lang=void 0;var i,a=s(17),n=(i=a,i&&i.__esModule?i:{default:i});const o=(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage).toLowerCase().split(/[_-]+/)[0],r=t.lang=n.default[o]&&o||"en";t.messages=n.default[r]||n.default.en},function(e){e.exports={en:{"auth.verifying":"Verifying...","auth.verified-title":"E-Mail Verified!","auth.verified":"Your email has been verified!\nYou can now close this browser tab and return to Hubs.","auth.spoke-verified":"You email has been verified!\nYou can now close this browser tab and return to Spoke.","sign-in.prompt":"Sign in to pin objects in rooms.","sign-in.auth-started":"Email sent!\nWaiting for you to click on the link in the email...","sign-in.pin":"You'll need to sign in to pin objects.","sign-in.pin-complete":"You are now signed in.","sign-in.as":"Signed in as","sign-in.in":"Sign In","sign-in.out":"Sign Out","entry.enter-room-title":"Lobby","entry.enter-room":"Enter Room","entry.screen-prefix":"Enter on ","entry.desktop-screen":"Screen","entry.mobile-screen":"Phone","entry.mobile-safari":"Safari","entry.generic-prefix":" ","entry.generic-medium":"Connected Headset","entry.generic-subtitle-desktop":"Oculus or SteamVR","entry.gearvr-prefix":"Enter on ","entry.gearvr-medium":"Gear VR","entry.choose-device":"Choose Device","entry.device-prefix-desktop":" ","entry.device-prefix-mobile":" ","entry.device-medium":"Mobile Headset","entry.device-subtitle-desktop":"Standalone or Mobile VR","entry.device-subtitle-mobile":"Standalone or Mobile VR","entry.device-subtitle-vr":"Phone or PC","entry.cardboard":"Enter on Google Cardboard","entry.daydream-prefix":"Enter on ","entry.daydream-medium":"Daydream","entry.daydream-via-chrome":"Using Google Chrome","entry.invite-others":"invite others","entry.invite-others-nag":"invite","entry.invite-team-nag":"Invite a hubs team member","entry.enable-screen-sharing":"Share my desktop","entry.return-to-vr":"Return to VR","entry.enter-in-vr":"Enter in VR","entry.lobby":"Lobby","entry.notify_me":"Notify me when others are here","profile.save":"Accept","profile.display_name.validation_warning":"Alphanumerics and hyphens. At least 3 characters, no more than 32","profile.header":"Name & Avatar","profile.avatar-selector.loading":"Loading Avatars...","profile.terms_of_use":"Terms of Use","profile.privacy_notice":"Privacy Notice","audio.title":"Audio Setup","audio.subtitle-desktop":"Confirm HMD speaker output","audio.subtitle-mobile":"Earphones are recommended","audio.enter-now":"Enter Now","audio.hmd-mic-warning":"Your HMD mic is not chosen","audio.grant-title":"Grant mic permissions","audio.grant-subtitle":"Mic access needed to be heard by others","audio.granted-title":"Mic permissions granted","audio.granted-subtitle":"You can still mute yourself in-game","audio.granted-next":"Next","exit.subtitle.exited":"Your session has ended. Refresh your browser to start a new one.","exit.subtitle.closed":"This room is no longer available.","exit.subtitle.left":"You have left the room.","exit.subtitle.full":"This room is full, please try again later.","exit.subtitle.connect_error":"Unable to connect to this room, please try again later.","exit.subtitle.version_mismatch":"The version you deployed is not available yet. Your browser will refresh in 5 seconds.","autoexit.title":"Auto-ending session in ","autoexit.title_units":" seconds","autoexit.subtitle":"You have started another session.","autoexit.cancel":"CANCEL","presence.entered_room":"entered the room.","presence.entered_lobby":"entered the lobby.","presence.join_lobby":"joined the lobby.","presence.leave":"left.","presence.name_change":"is now known as","presence.in_lobby":"Lobby","presence.in_room":"In Room","home.room_create_options":"options","home.room_create_button":"Create Room","home.create_name.validation_warning":"Invalid name, limited to 4 to 64 characters and limited symbols.","home.join_us":"Join the Conversation","home.join_room":"Join Room","home.create_with_spoke":"Create a Scene","home.report_issue":"Report Issues","home.source_link":"Source","home.whats_new_link":"What's New","home.spoke_link":"Spoke","home.about_link":"About","home.community_link":"Community","home.privacy_notice":"Privacy Notice","home.terms_of_use":"Terms of Use","home.get_updates":"Get Updates","home.hero_title":"A new way to get together","home.made_with_love":"made with ðŸ¦† by ","home.environment_author_by":" by ","dialog.close":"close","mailing_list.privacy_label":"I'm okay with Mozilla handling my info as explained in","mailing_list.privacy_link":"this Privacy Notice","link.link_page_header_entry":"Enter your code:","link.link_page_header_headset":"Enter headset link code:","link.linking_a_headset":"Linking a Headset?","link.try_again":"We couldn't find that code.\nPlease try again.","help.report_issue":"Report an Issue","scene.logo_tagline":"A new way to get together","scene.create_button":"Create a room with this scene","scene.tweet_button":"Share on Twitter","link.in_your_browser":"In your headset's browser, go to:","link.enter_code":"Then, enter this one-time link code:","link.do_not_close":"Keep this open to use this code.","link.connect_headset":"Link VR Headset","link.cancel":"cancel","invite.enter_via":"Enter via ","invite.tweet":"tweet","invite.and_enter_code":" with code:","invite.or_visit":"or share permalink","spoke.primary_tagline":"make your space","spoke.secondary_tagline":"Create 3D social scenes for ","spoke.thank_you":"Thank you for downloading Spoke!","spoke.download_win":"Download for Windows","spoke.download_macos":"Download for Mac","spoke.download_linux":"Download for Linux","spoke.download_unsupported":"View Releases","spoke.browse_all_versions":"Browse All Versions","spoke.beginner_tutorial_button":"Learn Spoke in 5 Minutes","spoke.advanced_tutorial_button":"Advanced Spoke in 10 minutes","spoke.play_button":"Learn Spoke in 5 Minutes","commands.fly":"Toggle fly mode.","commands.grow":"Increase your avatar's size.","commands.shrink":"Decrease your avatar's size.","commands.help":"Show help.","commands.leave":"Disconnect from the room.","commands.duck":"The duck tested well. Quack.","video_share.notify":"Select again to un-share video."}}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objectTypeForOriginAndContentType=function(e,t){for(const s in o)if(t.startsWith(s)){const t=o[s];return n(e,...t)}return a.UNKNOWN};const i=t.ObjectContentOrigins={URL:1,FILE:2,CLIPBOARD:3,SPAWNER:4},a=t.ObjectTypes={URL_IMAGE:0,URL_VIDEO:1,URL_MODEL:2,URL_PDF:3,URL_AUDIO:4,FILE_IMAGE:8,FILE_VIDEO:9,FILE_MODEL:10,FILE_PDF:11,FILE_AUDIO:12,CLIPBOARD_IMAGE:16,CLIPBOARD_VIDEO:17,CLIPBOARD_MODEL:18,CLIPBOARD_PDF:19,CLIPBOARD_AUDIO:20,SPAWNER_IMAGE:24,SPAWNER_VIDEO:25,SPAWNER_MODEL:26,SPAWNER_PDF:27,SPAWNER_AUDIO:28,CAMERA:30,UNKNOWN:31};function n(e,t,s,a,n){return e===i.URL?t:e===i.FILE?s:e===i.CLIPBOARD?a:n}const o={"image/":[a.URL_IMAGE,a.FILE_IMAGE,a.CLIPBOARD_IMAGE,a.SPAWNER_IMAGE],"model/":[a.URL_MODEL,a.FILE_MODEL,a.CLIPBOARD_MODEL,a.SPAWNER_MODEL],"application/x-zip-compressed":[a.URL_MODEL,a.FILE_MODEL,a.CLIPBOARD_MODEL,a.SPAWNER_MODEL],"video/":[a.URL_VIDEO,a.FILE_VIDEO,a.CLIPBOARD_VIDEO,a.SPAWNER_VIDEO],"audio/":[a.URL_AUDIO,a.FILE_AUDIO,a.CLIPBOARD_AUDIO,a.SPAWNER_AUDIO],"application/pdf":[a.URL_PDF,a.FILE_PDF,a.CLIPBOARD_PDF,a.SPAWNER_PDF]}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.avatars=[{id:"botdefault",model:"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf"},{id:"botbobo",model:"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf"},{id:"botdom",model:"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf"},{id:"botgreg",model:"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf"},{id:"botguest",model:"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf"},{id:"botjim",model:"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf"},{id:"botkev",model:"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf"},{id:"botpinky",model:"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf"},{id:"botrobert",model:"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf"},{id:"botwoody",model:"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf"}]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pose=function(){return{position:new a,direction:new a,orientation:new n,fromOriginAndDirection:function(e,t){return this.position=e,this.direction=t,this.orientation=this.orientation.setFromUnitVectors(o,t),this},fromCameraProjection:function(e,t,s){return this.position.setFromMatrixPosition(e.matrixWorld),this.direction.set(t,s,.5).unproject(e).sub(this.position).normalize(),this.fromOriginAndDirection(this.position,this.direction),this},copy:function(e){this.position.copy(e.position),this.direction.copy(e.direction),this.orientation.copy(e.orientation)}}};const i="undefined"!=typeof window&&window.THREE,a=i&&i.Vector3||function(){},n=i&&i.Quaternion||function(){},o="undefined"!=typeof window&&window.THREE&&new i.Vector3(0,0,-1)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xforms=void 0;var i=s(22),a=s(454);const n=[0,0];t.xforms={noop:function(){},copy:function(e,t,s){e[s.value]=e[t.value]},scale:function(e){return function(t,s,i){void 0!==t[s.value]&&(t[i.value]=t[s.value]*e)}},deadzone:function(e){return function(t,s,i){t[i.value]=Math.abs(t[s.value])<e?0:t[s.value]}},split_vec2:function(e,t,s){void 0!==e[t.value]&&(e[s.x]=e[t.value][0],e[s.y]=e[t.value][1])},compose_vec2:function(e,t,s){void 0!==e[t.x]&&void 0!==e[t.y]&&(e[s.value]=[e[t.x],e[t.y]])},negate:function(e,t,s){e[s.value]=-e[t.value]},copyIfFalse:function(e,t,s){e[s.value]=e[t.bool]?void 0:e[t.value]},copyIfTrue:function(e,t,s){e[s.value]=e[t.bool]?e[t.value]:void 0},zeroIfDefined:function(e,t,s){e[s.value]=void 0!==e[t.bool]?0:e[t.value]},true:function(e,t,s){e[s.value]=!0},rising:function(e,t,s,i){return e[s.value]=e[t.value]&&!1===i,!!e[t.value]},risingWithFrameDelay:function(e){return function(t,s,i,a={values:new Array(e)}){return t[i.value]=a.values.shift(),a.values.push(t[s.value]&&!a.prev),a.prev=t[s.value],a}},falling:function(e,t,s,i){return e[s.value]=!e[t.value]&&i,!!e[t.value]},vec2Zero:function(e,t,s){e[s.value]=n},poseFromCameraProjection:function(){let e;const t=new i.Pose;return function(s,i,a){e||(e=document.querySelector("#player-camera").components.camera.camera),s[a.value]=t.fromCameraProjection(e,s[i.value][0],s[i.value][1])}},vec2dpad:function(e,t=!1,s=!1){const i=e*e;return function(e,n,o){if(!e[n.value])return;const[r,l]=e[n.value],c=r*r+l*l<i,d=c?"center":(0,a.angleTo4Direction)(Math.atan2(t?-r:r,s?-l:l));o[d]&&(e[o[d]]=!0)}},always:function(e){return function(t,s,i){t[i.value]=e}},wasd_to_vec2:function(e,{w:t,a:s,s:i,d:a},{vec2:n}){let o=0,r=0;e[s]&&(o-=1),e[a]&&(o+=1),e[t]&&(r+=1),e[i]&&(r-=1),e[n]=[o,r]},add_vec2:function(e,t,s){const i=e[t.first],a=e[t.second];i&&a?e[s.value]=[i[0]+a[0],i[1]+a[1]]:a?e[s.value]=a:i&&(e[s.value]=i)},max_vec2:function(e,t,s){const i=e[t.first],a=e[t.second];i&&a?e[s.value]=i[0]*i[0]+i[1]*i[1]>a[0]*a[0]+a[1]*a[1]?i:a:a?e[s.value]=a:i&&(e[s.value]=i)},normalize_vec2:function(e,t,s){const i=e[t.value];if(i)if(0===i[0]&&0===i[0])e[s.value]=i;else{const t=Math.sqrt(i[0]*i[0]+i[1]*i[1]);e[s.value]=[i[0]/t,i[1]/t]}},all:function(e,t,s){for(const i in t)if(!e[t[i]])return void(e[s.value]=!1);e[s.value]=!0},any:function(e,t,s){for(const i in t)if(e[t[i]])return void(e[s.value]=!0);e[s.value]=!1},touch_axis_scroll:(e=1)=>(function(t,s,i,a={value:0,touching:!1}){return t[i.value]=a.touching&&t[s.touching]?e*(t[s.value]-a.value):0,a.value=t[s.value],a.touching=t[s.touching],a})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addSetsToBindings=(e=>{for(const t in e)for(const s of e[t])s.sets||(s.sets=[]),s.sets.push(t);return e})},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new Promise(e=>{setTimeout(e,0)})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCHEMA=void 0;var i,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},n=s(82),o=s(83),r=(i=o,i&&i.__esModule?i:{default:i}),l=s(72),c=s(37);const d="___hubs_store",u=Symbol(),h=new n.Validator,p=t.SCHEMA={id:"/HubsStore",definitions:{profile:{type:"object",additionalProperties:!1,properties:{displayName:{type:"string",pattern:"^[A-Za-z0-9-]{3,32}$"},avatarId:{type:"string"}}},credentials:{type:"object",additionalProperties:!1,properties:{token:{type:["null","string"]},email:{type:["null","string"]}}},activity:{type:"object",additionalProperties:!1,properties:{hasFoundFreeze:{type:"boolean"},hasChangedName:{type:"boolean"},lastEnteredAt:{type:"string"}}},settings:{type:"object",additionalProperties:!1,properties:{lastUsedMicDeviceId:{type:"string"}}},uploadPromotionTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{fileId:{type:"string"},promotionToken:{type:"string"}}}}},type:"object",properties:{profile:{$ref:"#/definitions/profile"},credentials:{$ref:"#/definitions/credentials"},activity:{$ref:"#/definitions/activity"},settings:{$ref:"#/definitions/settings"},uploadPromotionTokens:{$ref:"#/definitions/uploadPromotionTokens"}},additionalProperties:!1};t.default=class extends l.EventTarget{constructor(){super(),this.init=(()=>{this.update({profile:a({},(0,c.generateDefaultProfile)(),this.state.profile||{})}),this.state.activity.hasChangedName||this.update({profile:{displayName:(0,c.generateRandomName)()}})}),null===localStorage.getItem(d)&&localStorage.setItem(d,JSON.stringify({})),this.update({activity:{},settings:{},credentials:{},profile:{},uploadPromotionTokens:[]})}get state(){return this.hasOwnProperty(u)||(this[u]=JSON.parse(localStorage.getItem(d))),this[u]}update(e){const t=(0,r.default)(this.state,e),{valid:s}=h.validate(t,p);if(!s)throw new Error("Write to store failed schema validation.");return localStorage.setItem(d,JSON.stringify(t)),delete this[u],this.dispatchEvent(new CustomEvent("statechanged")),t}}},,,,,function(e,t,s){e.exports=s.p+"assets/images/hub-preview-light-no-shadow-5ebb166e8580d819b445892173ec0286.png"},,function(e,t,s){"use strict";var i=s(27),a=x(i),n=s(110),o=x(n),r=s(61),l=x(r),c=s(62),d=x(c),u=s(63),h=x(u),p=s(64),m=x(p),f=s(65),g=x(f),v=s(66),b=x(v),y=s(67),_=x(y),E=s(9);function x(e){return e&&e.__esModule?e:{default:e}}const w={};let S=null;function k(e,t,s){if(!AFRAME.components[t])throw new Error(`Inflator failed. "${t}" component does not exist.`);if(AFRAME.components[t].multiple&&Array.isArray(s))for(let i=0;i<s.length;i++)e.setAttribute(t+"__"+i,s[i]);else e.setAttribute(t,s)}function A(e){const t=new Map,s=e.clone();return function e(t,s,i){i(t,s);for(let a=0;a<t.children.length;a++)e(t.children[a],s.children[a],i)}(e,s,function(e,s){t.set(e,s)}),e.traverse(function(e){if(!e.isSkinnedMesh)return;const s=e.skeleton.bones,i=t.get(e);i.skeleton=e.skeleton.clone(),i.skeleton.bones=s.map(function(e){if(!t.has(e))throw new Error("Required bones are not descendants of the given object.");return t.get(e)}),i.bind(i.skeleton,e.bindMatrix)}),s}AFRAME.GLTFModelPlus={components:{},registerComponent(e,t,s){s=s||k,AFRAME.GLTFModelPlus.components[e]={inflator:s,componentName:t}}};const C=function(e,t,s,i){"Chest"===e.name?e.name="Spine":"Root Scene"===e.name?e.name="AvatarRoot":"Bot_Skinned"===e.name&&(e.name="AvatarMesh");const a=[],n=e.children.slice(0);for(const e of n){const s=C(e,t);s&&a.push(s)}const o=e.userData.gltfExtensions&&e.userData.gltfExtensions.HUBS_components,r=e.userData.components,l=o||r,c=!!l||e.name in t;if(!c&&!a.length&&!s)return null;const d=document.createElement("a-entity");d.append.apply(d,a);const u=(e.name||e.uuid).replace(/[^\w-]/g,"");if(d.classList.add(u),"YXZ"!==e.rotation.order&&e.rotation.setFromQuaternion(e.quaternion,"YXZ"),d.setAttribute("position",{x:e.position.x,y:e.position.y,z:e.position.z}),d.setAttribute("rotation",{x:e.rotation.x*THREE.Math.RAD2DEG,y:e.rotation.y*THREE.Math.RAD2DEG,z:e.rotation.z*THREE.Math.RAD2DEG}),d.setAttribute("scale",{x:e.scale.x*(void 0!==i?i:1),y:e.scale.y*(void 0!==i?i:1),z:e.scale.z*(void 0!==i?i:1)}),e.matrixAutoUpdate=!1,e.matrix.identity(),e.matrix.decompose(e.position,e.rotation,e.scale),d.object3D.matrixNeedsUpdate=!0,d.setObject3D(e.type.toLowerCase(),e),l&&"nav-mesh"in l&&d.setObject3D("mesh",e),d.object3D.name=e.name,e.animations&&(e.parent.animations=e.animations),l)for(const e in l)if(l.hasOwnProperty(e)&&AFRAME.GLTFModelPlus.components.hasOwnProperty(e)){const{componentName:t,inflator:s}=AFRAME.GLTFModelPlus.components[e];s(d,t,l[e],l)}return d};function M(e,t,s){const i=e.querySelectorAll("."+t);for(const e of i){const t=s.cloneNode(!0);for(const s of t.attributes){const{name:t,value:i}=s;e.setAttribute(t,i)}for(;t.children.length>0;)e.appendChild(t.children[0])}}async function R(e,t,s,i){let a,n=e;(t.includes("model/gltf+zip")||t.includes("application/x-zip-compressed"))&&(a=await function(e){return new Promise((t,s)=>{const i=new o.default;i.onmessage=(e=>{const[i,a]=e.data;(i?t:s)(a)}),i.postMessage(e)})}(n),n=a["scene.gtlf"]);const r=new THREE.GLTFLoader;r.customURLResolver=(0,E.getCustomGLTFParserURLResolver)(n),r.setLazy(!0);const{parser:c}=await new Promise((e,t)=>r.load(n,e,i,t)),u=c.json.materials;if(u)for(let e=0;e<u.length;e++){const t=u[e];if(t.extensions&&t.extensions.MOZ_alt_materials&&void 0!==t.extensions.MOZ_alt_materials[s]){const i=t.extensions.MOZ_alt_materials[s];u[e]=u[i]}}S||(S=async function(){const e=[d.default,h.default,m.default,g.default,b.default,_.default],t=await(new THREE.CubeTextureLoader).load(e);return t.format=THREE.RGBFormat,t}());const p=await new Promise((e,t)=>c.parse((t,s,i,a,n)=>{e({scene:t,scenes:s,cameras:i,animations:a,json:n})},e=>{t(e)})),f=await S;return p.scene.traverse(e=>{e.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate,e.material&&"MeshStandardMaterial"===e.material.type&&("KHR_materials_unlit"===s?e.material=l.default.fromStandardMaterial(e.material):(e.material.envMap=f,e.material.needsUpdate=!0))}),a&&Object.keys(a).forEach(URL.revokeObjectURL),p}AFRAME.registerComponent("gltf-model-plus",{schema:{src:{type:"string"},contentType:{type:"string"},useCache:{default:!0},inflate:{default:!1},modelToWorldScale:{type:"number",default:1}},init(){this.preferredTechnique=window.APP&&"low"===window.APP.quality?"KHR_materials_unlit":"pbrMetallicRoughness",this.loadTemplates()},update(){this.applySrc(this.data.src,this.data.contentType)},loadTemplates(){this.templates={},this.el.querySelectorAll(":scope > template").forEach(e=>{const t=document.importNode(e.firstElementChild||e.content.firstElementChild,!0);this.templates[e.getAttribute("data-name")]=t})},async loadModel(e,t,s,i){return i?(w[e]||(w[e]=await R(e,t,s)),a=w[e],{animations:a.animations,scene:A(a.scene)}):await R(e,t,s);var a},async applySrc(e,t){try{if(e&&"#"===e.charAt(0)){const t=document.getElementById(e.substring(1));e=t.getAttribute("src")}if(e===this.lastSrc)return;if(this.lastSrc=e,!e)return void(this.inflatedEl&&(console.warn("gltf-model-plus set to an empty source, unloading inflated model."),this.removeInflatedEl()));const s=await this.loadModel(e,t,this.preferredTechnique,this.data.useCache);if(e!=this.lastSrc)return;this.removeInflatedEl(),this.model=s.scene||s.scenes[0],this.model.animations=s.animations,s.animations.length>0&&(this.el.setAttribute("animation-mixer",{}),this.el.components["animation-mixer"].initMixer(s.animations));let i=this.model;if(this.data.inflate&&(this.inflatedEl=C(this.model,this.templates,!0,this.data.modelToWorldScale))){if(this.el.appendChild(this.inflatedEl),i=this.inflatedEl.object3D,await(0,a.default)(),e!=this.lastSrc)return;for(const e in this.templates)M(this.el,e,this.templates[e])}const n=[];i.traverse(e=>{const t=e.el;t&&n.push(()=>e.el=t)}),this.el.setObject3D("mesh",i),n.forEach(e=>e()),this.el.emit("model-loaded",{format:"gltf",model:this.model})}catch(t){delete w[e],console.error("Failed to load glTF model",t,this),this.el.emit("model-error",{format:"gltf",src:e})}},removeInflatedEl(){this.inflatedEl&&(this.inflatedEl.parentNode.removeChild(this.inflatedEl),delete this.inflatedEl)}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAncestorWithComponent=function(e,t){for(;e&&(!e.components||!e.components[t]);)e=e.parentNode;return e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.avatarIds=void 0,t.generateRandomName=function(){return`${n(a)}-${Math.floor(1e4+1e4*Math.random())}`},t.generateDefaultProfile=function(){return{avatarId:n(o)}};var i=s(21);const a=["Baers-Pochard","Baikal-Teal","Barrows-Goldeneye","Blue-Billed","Blue-Duck","Blue-Winged","Brown-Teal","Bufflehead","Canvasback","Cape-Shoveler","Chestnut-Teal","Chiloe-Wigeon","Cinnamon-Teal","Comb-Duck","Common-Eider","Common-Goldeneye","Common-Merganser","Common-Pochard","Common-Scoter","Common-Shelduck","Cotton-Pygmy","Crested-Duck","Crested-Shelduck","Eatons-Pintail","Falcated","Ferruginous","Freckled-Duck","Gadwall","Garganey","Greater-Scaup","Green-Pygmy","Grey-Teal","Hardhead","Harlequin","Hartlaubs","Hooded-Merganser","Hottentot-Teal","Kelp-Goose","King-Eider","Lake-Duck","Laysan-Duck","Lesser-Scaup","Long-Tailed","Maccoa-Duck","Mallard","Mandarin","Marbled-Teal","Mellers-Duck","Merganser","Northern-Pintail","Orinoco-Goose","Paradise-Shelduck","Plumed-Whistler","Puna-Teal","Pygmy-Goose","Radjah-Shelduck","Red-Billed","Red-Crested","Red-Shoveler","Ring-Necked","Ringed-Teal","Rosy-Billed","Ruddy-Shelduck","Salvadoris-Teal","Scaly-Sided","Shelduck","Shoveler","Silver-Teal","Smew","Spectacled-Eider","Spot-Billed","Spotted-Whistler","Steamerduck","Stellers-Eider","Sunda-Teal","Surf-Scoter","Tufted-Duck","Velvet-Scoter","Wandering-Whistler","Whistling-duck","White-Backed","White-Cheeked","White-Winged","Wigeon","Wood-Duck","Yellow-Billed"];function n(e){return e[Math.floor(Math.random()*e.length)]}const o=t.avatarIds=i.avatars.map(e=>e.id)},function(e,t){},,,function(e,t){},function(e,t){},,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=i.get(e);return""===t||/1|on|true/i.test(t)};const i=new URLSearchParams(location.search)},,,,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.patchWebGLRenderingContext=function(){if(/Android.+Firefox/.test(navigator.userAgent)){const e=WebGLRenderingContext.prototype.getExtension,t=function(){const e=new i.WebGLRenderer,t=new i.Scene,s=new Float32Array(16),a=new i.DataTexture(s,2,2,i.RGBAFormat,i.FloatType),n=new i.Mesh(new i.PlaneBufferGeometry(1,1),new i.MeshBasicMaterial({map:a}));n.material.map.needsUpdate=!0,t.add(n),e.render(t,new i.Camera);const o=0===e.context.getError();return e.dispose(),o}();WebGLRenderingContext.prototype.getExtension=function(s){return"OES_texture_float"!==s||t?e.call(this,s):null}}};const i=AFRAME.THREE},,function(e,t,s){"use strict";AFRAME.registerComponent("animation-mixer",{initMixer(e){this.mixer=new THREE.AnimationMixer(this.el.object3D),this.el.object3D.animations=e,this.animations=e},tick:function(e,t){this.mixer&&this.mixer.update(t/1e3)}})},function(e,t,s){"use strict";AFRAME.registerComponent("networked-audio-analyser",{async init(){this.volume=0,this.prevVolume=0,this.smoothing=.3,this.threshold=.01,this.el.addEventListener("sound-source-set",e=>{const t=THREE.AudioContext.getContext();this.analyser=t.createAnalyser(),this.analyser.fftSize=32,this.levels=new Uint8Array(this.analyser.frequencyBinCount),e.detail.soundSource.connect(this.analyser)})},tick:function(){if(!this.analyser)return;this.analyser.getByteTimeDomainData(this.levels);let e=0;for(let t=0;t<this.levels.length;t++){const s=(this.levels[t]-128)/128;e+=s*s}let t=Math.sqrt(e/this.levels.length);t<this.threshold&&(t=0),this.volume=this.smoothing*t+(1-this.smoothing)*this.prevVolume,this.prevVolume=this.volume}}),AFRAME.registerComponent("scale-audio-feedback",{schema:{minScale:{default:1},maxScale:{default:1.5}},tick(){if(!this.el.object3D.visible)return;const{minScale:e,maxScale:t}=this.data,s=this.el.components["networked-audio-analyser"];if(!s)return;const i=Math.min(t,e+(t-e)*s.volume*8);this.el.object3D.scale.setScalar(i),this.el.object3D.matrixNeedsUpdate=!0}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i="\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n",a="\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n";class n extends THREE.ShaderMaterial{constructor(...e){var t;return t=super(...e),this.type="MobileStandardMaterial",this.isMobileStandardMaterial=!0,t}static fromStandardMaterial(e){const t={vertexShader:i,fragmentShader:a,uniforms:{uvTransform:{value:new THREE.Matrix3},diffuse:{value:e.color},opacity:{value:e.opacity},map:{value:e.map},aoMapIntensity:{value:e.aoMapIntensity},aoMap:{value:e.aoMap},emissive:{value:e.emissive},emissiveMap:{value:e.emissiveMap}},fog:!0,lights:!1,opacity:e.opacity,transparent:e.transparent,skinning:e.skinning,morphTargets:e.morphTargets},s=new n(t);return s.color=e.color,s.map=e.map,s.aoMap=e.aoMap,s.aoMapIntensity=e.aoMapIntensity,s.emissive=e.emissive,s.emissiveMap=e.emissiveMap,s}clone(){return n.fromStandardMaterial(this)}}t.default=n},function(e,t,s){e.exports=s.p+"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg"},function(e,t,s){e.exports=s.p+"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg"},function(e,t,s){e.exports=s.p+"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg"},function(e,t,s){e.exports=s.p+"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg"},function(e,t,s){e.exports=s.p+"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg"},function(e,t,s){e.exports=s.p+"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg"},function(e,t){e.exports="if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo) {\n  float ratio = 0.0;\n\n  if (hubs_EnableSweepingEffect) {\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\n    float line = mod(hubs_Time / 3000.0 * size, size * 2.0) + hubs_SweepParams.s - size / 2.0;\n\n    if (hubs_WorldPosition.y < line) {\n      // Highlight with a sweeping gradient.\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / size * 3.0);\n    }\n  }\n\n  // Highlight with a gradient falling off with distance.\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\n\n  if (hubs_HighlightInteractorOne) {\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\n  } \n\n  if (hubs_HighlightInteractorTwo) {\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\n  }\n\n  ratio = min(1.0, ratio);\n\n  // Gamma corrected highlight color\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\n\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\n}\n"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=t.Layers={reflection:3};AFRAME.registerComponent("layers",{schema:{reflection:{type:"boolean",default:!1},inWorldHud:{type:"boolean",default:!1},exclusive:{type:"boolean",default:!1}},init(){this.update=this.update.bind(this),this.el.addEventListener("model-loaded",this.update)},update(e){const t=this.el.object3D;this.data.exclusive&&t.traverse(e=>e.layers.mask=0);for(const[s,a]of Object.entries(i)){const i=e[s],n=this.data[s];i!==n&&(n?t.traverse(e=>e.layers.enable(a)):t.traverse(e=>e.layers.disable(a)))}},remove(){this.el.removeEventListener("model-loaded",this.update)}})},function(e,t,s){"use strict";var i=s(36);AFRAME.registerComponent("loop-animation",{schema:{clip:{type:"string"}},init(){this.mixerEl=(0,i.findAncestorWithComponent)(this.el,"animation-mixer"),this.mixerEl?this.updateClip():console.warn("loop-animation component could not find an animation-mixer in its ancestors.")},update(e){e.clip!==this.data.clip&&this.mixerEl&&this.updateClip()},updateClip(){const{mixer:e,animations:t}=this.mixerEl.components["animation-mixer"],s=this.data.clip;if(0===t.length)return;let i;if(i=s?t.find(({name:e})=>e===s):t[0],!i)return;const a=e.clipAction(i,this.el.object3D);a.enabled=!0,a.setLoop(THREE.LoopRepeat,1/0).play(),this.currentAction=a},destroy(){this.currentAction&&(this.currentAction.enabled=!1,this.currentAction.stop())}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detectInHMD=r,t.getAvailableVREntryTypes=async function(){const e=navigator.userAgent,t="chrome"===a.name&&/SamsungBrowser/.test(e),s=window.hasNativeWebVRImplementation,i=!(!s||"chrome"!==a.name||t),l=AFRAME.utils.device.isIOS(),c="firefox"===a.name,d=void 0===navigator.mediaDevices,u=l?d?n.maybe:n.yes:n.no,h=s?await navigator.getVRDisplays():[],p=/Oculus/.test(e),m=r(),f=m?n.no:l&&d?n.maybe:n.yes,g=!s&&c;let v=AFRAME.utils.device.isMobile()||g?n.no:n.maybe,b=n.no,y=n.no;(function(e){return/\WAndroid\W/.test(e)})(e)&&(y=p?n.yes:n.maybe);let _=function(e){return/\WAndroid\W/.test(e)}(e)&&!m?n.maybe:n.no;if(s){v=h.find(e=>e.capabilities.canPresent&&!o.find(t=>t.test(e.displayName)))?n.yes:n.no,b=l||c||!h.find(e=>e.capabilities.canPresent&&/cardboard/i.test(e.displayName))?n.no:n.yes;const e=h.find(e=>/daydream/i.test(e.displayName));e?(_=n.yes,v=n.no):i&&(_=n.no)}return{screen:f,generic:v,gearvr:y,daydream:_,cardboard:b,isInHMD:m,safari:u}};const{detect:i}=s(34),a=i(),n=t.VR_DEVICE_AVAILABILITY={yes:"yes",no:"no",maybe:"maybe"};const o=[/cardboard/i];function r(){const e=navigator.userAgent,t=/Firefox/.test(e)&&/Android/.test(e)&&window.hasNativeWebVRImplementation,s=/Oculus/.test(e);return s||t}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableiOSZoom=function(){if("iOS"!==(0,i.detectOS)(navigator.userAgent))return;let e=0;document.addEventListener("touchmove",e=>{1!==e.scale&&e.preventDefault()}),document.addEventListener("touchend",t=>{const s=(new Date).getTime(),i=s-e<=300;e=s,i&&t.preventDefault()})};var i=s(34)},function(e,t,s){"use strict";function i(e,t,s,i){i.networked&&e.setAttribute("networked",{template:s.controls?"#static-controlled-media":"#static-media",owner:"scene",persistent:!0,networkId:i.networked.id});const a={projection:s.projection};"video"===t&&(a.videoPaused=!s.autoPlay,a.volume=s.volume,a.loop=s.loop,a.audioType=s.audioType,"pannernode"===s.audioType&&(a.distanceModel=s.distanceModel,a.rolloffFactor=s.rolloffFactor,a.refDistance=s.refDistance,a.maxDistance=s.maxDistance,a.coneInnerAngle=s.coneInnerAngle,a.coneOuterAngle=s.coneOuterAngle,a.coneOuterGain=s.coneOuterGain)),e.setAttribute("media-loader",{src:s.src,resize:!0,resolve:!0,fileIsOwned:!0,mediaOptions:a})}s(35),AFRAME.GLTFModelPlus.registerComponent("duck","duck"),AFRAME.GLTFModelPlus.registerComponent("quack","quack"),AFRAME.GLTFModelPlus.registerComponent("sound","sound"),AFRAME.GLTFModelPlus.registerComponent("collision-filter","collision-filter"),AFRAME.GLTFModelPlus.registerComponent("css-class","css-class"),AFRAME.GLTFModelPlus.registerComponent("interactable","css-class",(e,t)=>{e.setAttribute(t,"interactable")}),AFRAME.GLTFModelPlus.registerComponent("super-spawner","super-spawner"),AFRAME.GLTFModelPlus.registerComponent("gltf-model-plus","gltf-model-plus"),AFRAME.GLTFModelPlus.registerComponent("media-loader","media-loader"),AFRAME.GLTFModelPlus.registerComponent("body","body"),AFRAME.GLTFModelPlus.registerComponent("hide-when-quality","hide-when-quality"),AFRAME.GLTFModelPlus.registerComponent("light","light"),AFRAME.GLTFModelPlus.registerComponent("ambient-light","ambient-light"),AFRAME.GLTFModelPlus.registerComponent("directional-light","directional-light"),AFRAME.GLTFModelPlus.registerComponent("hemisphere-light","hemisphere-light"),AFRAME.GLTFModelPlus.registerComponent("point-light","point-light"),AFRAME.GLTFModelPlus.registerComponent("spot-light","spot-light"),AFRAME.GLTFModelPlus.registerComponent("skybox","skybox"),AFRAME.GLTFModelPlus.registerComponent("layers","layers"),AFRAME.GLTFModelPlus.registerComponent("shadow","shadow"),AFRAME.GLTFModelPlus.registerComponent("water","water"),AFRAME.GLTFModelPlus.registerComponent("scale-audio-feedback","scale-audio-feedback"),AFRAME.GLTFModelPlus.registerComponent("animation-mixer","animation-mixer"),AFRAME.GLTFModelPlus.registerComponent("loop-animation","loop-animation"),AFRAME.GLTFModelPlus.registerComponent("shape","shape"),AFRAME.GLTFModelPlus.registerComponent("heightfield","heightfield"),AFRAME.GLTFModelPlus.registerComponent("box-collider","shape",(()=>{const e=new THREE.Euler;return(t,s,i)=>{const{scale:a,rotation:n}=i;e.set(n.x,n.y,n.z);const o=(new THREE.Quaternion).setFromEuler(e);t.setAttribute(s,{shape:"box",offset:i.position,halfExtents:{x:a.x/2,y:a.y/2,z:a.z/2},orientation:o})}})()),AFRAME.GLTFModelPlus.registerComponent("visible","visible",(e,t,s)=>{"object"==typeof s?e.setAttribute(t,s.visible):e.setAttribute(t,s)}),AFRAME.GLTFModelPlus.registerComponent("spawn-point","spawn-point"),AFRAME.GLTFModelPlus.registerComponent("hoverable","hoverable"),AFRAME.GLTFModelPlus.registerComponent("sticky-zone","sticky-zone"),AFRAME.GLTFModelPlus.registerComponent("nav-mesh","nav-mesh",(e,t,s)=>{const i=AFRAME.scenes[0].systems.nav,a=s.zone||"character";let n=!1;e.object3D.traverse(e=>{e.isMesh&&!n&&(n=!0,i.loadMesh(e,a))}),e.setAttribute("nav-mesh")}),AFRAME.GLTFModelPlus.registerComponent("pinnable","pinnable"),AFRAME.GLTFModelPlus.registerComponent("media","media",(e,t,s)=>{s.id&&e.setAttribute("networked",{template:"#interactable-media",owner:"scene",persistent:!0,networkId:s.id}),e.setAttribute("media-loader",{src:s.src,resize:!0,resolve:!0,fileIsOwned:!0}),s.pageIndex&&e.setAttribute("media-pager",{index:s.pageIndex}),void 0!==s.paused&&e.setAttribute("media-video",{videoPaused:s.paused}),s.time&&e.setAttribute("media-video",{time:s.time})}),AFRAME.GLTFModelPlus.registerComponent("image","image",i),AFRAME.GLTFModelPlus.registerComponent("video","video",i)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var i,a=s(28),n=(i=a,i&&i.__esModule?i:{default:i});t.App=class{constructor(){this.scene=null,this.quality="low",this.store=new n.default}setQuality(e){return this.quality!==e&&(this.quality=e,this.scene&&this.scene.dispatchEvent(new CustomEvent("quality-changed",{detail:e})),!0)}}},,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addAnimationComponents=function(e){if(!e.components["animation-mixer"])return;e.querySelector("[loop-animation]")||e.setAttribute("loop-animation","")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBox=function(e,t){const s=new THREE.Box3;i.copy(e.object3D.rotation),e.object3D.rotation.set(0,0,0),e.object3D.updateMatrices(!0,!0),t.updateMatrices(!0,!0),s.setFromObject(t),s.isEmpty()||(e.object3D.worldToLocal(s.min),e.object3D.worldToLocal(s.max),e.object3D.rotation.copy(i),e.object3D.matrixNeedsUpdate=!0);return s},t.getScaleCoefficient=function(e,t){if(t.isEmpty())return 1;const{max:s,min:i}=t,a=Math.abs(s.x-i.x),n=Math.abs(s.y-i.y),o=Math.abs(s.z-i.z),r=Math.max(a,n,o);return e/r};const i=new THREE.Euler},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RIGHT_CONTROLLER_OFFSETS=t.LEFT_CONTROLLER_OFFSETS=void 0;var i=s(3);const a="open",n="point",o="fist",r="thumbUp",l="thumbDown",c="indexDown",d="pinch",u="mrpDown",h=t.LEFT_CONTROLLER_OFFSETS={default:new THREE.Matrix4,"oculus-touch-controls":(new THREE.Matrix4).makeTranslation(-.025,-.03,.1),"oculus-go-controls":new THREE.Matrix4,"vive-controls":(new THREE.Matrix4).compose(new THREE.Vector3(0,0,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),"windows-motion-controls":(new THREE.Matrix4).compose(new THREE.Vector3(0,-.017,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),"daydream-controls":(new THREE.Matrix4).makeTranslation(0,0,-.04),"gearvr-controls":new THREE.Matrix4},p=t.RIGHT_CONTROLLER_OFFSETS={default:new THREE.Matrix4,"oculus-touch-controls":(new THREE.Matrix4).makeTranslation(.025,-.03,.1),"oculus-go-controls":new THREE.Matrix4,"vive-controls":(new THREE.Matrix4).compose(new THREE.Vector3(0,0,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),"windows-motion-controls":(new THREE.Matrix4).compose(new THREE.Vector3(0,-.017,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),"daydream-controls":(new THREE.Matrix4).makeTranslation(0,0,-.04),"gearvr-controls":new THREE.Matrix4};AFRAME.registerComponent("hand-controls2",{schema:{default:"left"},getLeftControllerOffset(){return void 0===h[this.connectedController]?h.default:h[this.connectedController]},getRightControllerOffset(){return void 0===p[this.connectedController]?p.default:p[this.connectedController]},init(){this.pose=a,this.el.setAttribute("visible",!1),this.connectedController=null,this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),this.el.addEventListener("controllerconnected",this.onControllerConnected),this.el.addEventListener("controllerdisconnected",this.onControllerDisconnected)},update(e){const t=this.el,s=this.data,i={hand:s,model:!1,orientationOffset:{x:0,y:0,z:0}};s!==e&&(t.setAttribute("vive-controls",i),t.setAttribute("oculus-touch-controls",i),t.setAttribute("oculus-go-controls",i),t.setAttribute("windows-motion-controls",i),t.setAttribute("daydream-controls",i),t.setAttribute("gearvr-controls",i))},poseForFingers:(e,t,s)=>e||t||s?e&&t&&s?o:!e&&t&&s?r:e||t||!s?e||!t||s?!e||t||s?e&&t&&!s?d:e&&!t&&s?n:(console.warn(`Did not find matching pose for thumb ${e}, index ${t}, middleRingPinky ${s}`),a):l:c:u:a,tick(){const e=this.data,t=AFRAME.scenes[0].systems.userinput,s="left"===e?i.paths.actions.leftHand:i.paths.actions.rightHand,a=t.get(s.pose),n=t.get(s.thumb),o=t.get(s.index),r=t.get(s.middleRingPinky),l=this.poseForFingers(n,o,r);l!==this.pose&&(this.el.emit("hand-pose",{previous:this.pose,current:l}),this.pose=l),this.el.object3D.visible=!!a},onControllerConnected(e){this.connectedController=e.detail.name,this.el.setAttribute("visible",!0)},onControllerDisconnected(){this.connectedController=null,this.el.setAttribute("visible",!1)}})},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInWorldLogMessage=async function({name:e,type:t,body:s}){if("chat"!==t)return;const i=AFRAME.utils.device.isMobile(),a=await S(s,e,!1,i),n=document.createElement("a-entity"),o=document.createElement("a-entity");document.querySelector("a-scene").appendChild(n),n.appendChild(o),n.setAttribute("follow-in-lower-fov",{target:"#player-camera",offset:{x:0,y:0,z:-.8}});const r=URL.createObjectURL(a);o.setAttribute("animation__float",{property:"position",dur:1e4,from:{x:0,y:0,z:0},to:{x:0,y:.05,z:-.05},easing:"easeOutQuad"}),n.setAttribute("animation__spawn",{property:"scale",dur:200,from:{x:.1,y:.1,z:.1},to:{x:1,y:1,z:1},easing:"easeOutElastic"}),o.setAttribute("animation__opacity",{property:"meshMaterial.opacity",isRawProperty:!0,delay:3e3,dur:8e3,from:1,to:0,easing:"easeInQuad"}),o.addEventListener("animationcomplete__opacity",()=>{n.parentNode.removeChild(n)}),x.load(r,e=>{const t=new THREE.MeshBasicMaterial;t.transparent=!0,t.map=e,t.generateMipmaps=!1,t.needsUpdate=!0;const s=new THREE.PlaneGeometry,a=new THREE.Mesh(s,t);o.setObject3D("mesh",a),o.meshMaterial=t;const n=4e3/(i?3:1);o.object3DMap.mesh.scale.set(e.image.width/n,e.image.height/n,1)})},t.spawnChatMessage=k,t.default=A;var i=s(1),a=b(i),n=s(26),o=b(n),r=s(0),l=b(r),c=s(643),d=b(c),u=s(11),h=b(u),p=s(400),m=b(p),f=s(403),g=s(170),v=b(g);function b(e){return e&&e.__esModule?e:{default:e}}const y=document.createElement("canvas"),_=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/,E=/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)$/,x=new THREE.TextureLoader,w=(e,t)=>{const s=e.split("\n").length>1,i=s?d.default.messageWrapMulti:d.default.messageWrap,n=e.startsWith("`")&&e.endsWith("`"),o={[d.default.messageBody]:!0,[d.default.messageBodyMulti]:s,[d.default.messageBodyMono]:n};s||(e=(e=>{const t=e.split(" "),s=[];let i=0;for(let e=0;e<t.length;e++){const a=t[e];a.startsWith(":")&&a.endsWith(":")?i++:i+=a.length,s.push(a),i>=40&&(i=0,s.push("\n"))}return s.join(" ")})(e));const r=(n?e.substring(1,e.length-1):e).trim();return a.default.createElement("div",{className:i},t&&a.default.createElement("div",{className:d.default.messageSource},t,":"),a.default.createElement("div",{className:(0,h.default)(o)},a.default.createElement(m.default,{properties:{target:"_blank",rel:"noopener referrer"}},(0,f.toArray)(r))))};function S(e,t,s,i){const n=1===e.split("\n").length,r=y.getContext("2d"),l=(0,f.toArray)(e),c=s&&1===l.length&&l[0].props&&l[0].props.children.match&&l[0].props.children.match(_),u=document.createElement("div");u.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),u.setAttribute("class",`${d.default.presenceLog} ${d.default.presenceLogSpawn}`),document.body.appendChild(u);const p=a.default.createElement("div",{className:(0,h.default)({[d.default.presenceLogEntry]:!c,[d.default.presenceLogEntryOneLine]:!c&&n,[d.default.presenceLogEmoji]:c})},w(e,t));return new Promise(e=>{o.default.render(p,u,()=>{let t="8.33%",s=12;i&&(t="25%",s=4),y.width=u.offsetWidth*(s+.1),y.height=u.offsetHeight*(s+.1);const a=encodeURIComponent(`\n          <svg xmlns="http://www.w3.org/2000/svg" width="${y.width}" height="${y.height}">\n            <foreignObject width="${t}" height="${t}" style="transform: scale(${s});">\n              ${(0,v.default)(u)}\n            </foreignObject>\n          </svg>\n    `),n=new Image;n.onload=(async()=>{r.drawImage(n,0,0);const t=await new Promise(e=>y.toBlob(e));u.parentNode.removeChild(u),e(t)}),n.src="data:image/svg+xml,"+a})})}async function k(e,t){if(0===e.length)return;if(e.match(E))return void document.querySelector("a-scene").emit("add_media",e);const s=await S(e,t,!0,!1);document.querySelector("a-scene").emit("add_media",new File([s],"message.png",{type:"image/png"}))}function A(e){return a.default.createElement("div",{className:e.className},e.maySpawn&&a.default.createElement("button",{className:(0,h.default)(d.default.iconButton,d.default.spawnMessage),onClick:()=>k(e.body)}),w(e.body,e.name))}A.propTypes={name:l.default.string,maySpawn:l.default.bool,body:l.default.string,className:l.default.string}},,,,,,,,,,,,,function(e,t,s){"use strict";var i=s(98),a=r(i),n=s(46),o=r(n);function r(e){return e&&e.__esModule?e:{default:e}}const l=new URLSearchParams(location.search),c=(0,o.default)("debug"),d=l.get("log_filter")||c&&"naf-janus-adapter:*";d&&a.default.enable(d)},,,,,,function(e,t,s){"use strict";const i=new THREE.Vector3(0,0,0),a=new THREE.Quaternion,n=new THREE.Vector3(1,1,1),o=new THREE.Matrix4;o.identity();const r=THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning,l=THREE.PropertyBinding.prototype.Versioning;for(let e=0;e<r.length;e++){const t=r[e][l.MatrixWorldNeedsUpdate];t&&(r[e][l.MatrixWorldNeedsUpdate]=function(){const e=t.apply(this,arguments);return this.targetObject.matrixNeedsUpdate=!0,e})}THREE.Object3D.prototype.getWorldPosition=function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new THREE.Vector3),this.updateMatrices(),e.setFromMatrixPosition(this.matrixWorld)},THREE.Object3D.prototype.getWorldQuaternion=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(s){return void 0===s&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),s=new THREE.Quaternion),this.updateMatrices(),this.matrixWorld.decompose(e,s,t),s}}(),THREE.Object3D.getWorldScale=function(){const e=new THREE.Vector3,t=new THREE.Quaternion;return function(s){return void 0===s&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),s=new THREE.Vector3),this.updateMatrices(),this.matrixWorld.decompose(e,t,s),s}}();const c=e=>{e.matrixIsModified||(e.matrixIsModified=!0,e.cachedMatrixWorld&&(e.cachedMatrixWorld.copy(e.matrixWorld),e.matrixWorld=e.cachedMatrixWorld))},d=THREE.Object3D.prototype.updateMatrix;THREE.Object3D.prototype.updateMatrix=function(){d.apply(this,arguments),c(this)};const u=THREE.Object3D.prototype.applyMatrix;THREE.Object3D.prototype.applyMatrix=function(){u.apply(this,arguments),c(this)},THREE.Object3D.prototype.updateMatrices=function(e,t,s){this.hasHadFirstMatrixUpdate?(this.matrixNeedsUpdate||this.matrixAutoUpdate||e)&&(this.updateMatrix(),this.matrixNeedsUpdate&&(this.matrixNeedsUpdate=!1)):(this.position.equals(i)&&this.quaternion.equals(a)&&this.scale.equals(n)&&this.matrix.equals(o)||this.updateMatrix(),this.hasHadFirstMatrixUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.cachedMatrixWorld=this.matrixWorld),!s&&this.parent&&(this.parent.updateMatrices(!1,t,!1),this.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate||this.parent.childrenNeedMatrixWorldUpdate),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixIsModified?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld=this.parent.matrixWorld,this.childrenNeedMatrixWorldUpdate=!0,this.matrixWorldNeedsUpdate=!1)},THREE.Object3D.prototype.updateMatrixWorld=function(e,t){if(!this.visible&&!t)return;this.updateMatrices(!1,e,!0);const s=this.children,i=this.childrenNeedMatrixWorldUpdate||e;for(let e=0,a=s.length;e<a;e++)s[e].updateMatrixWorld(i,t);this.childrenNeedMatrixWorldUpdate&&(this.childrenNeedMatrixWorldUpdate=!1)}},function(e,t,s){"use strict";s(105),s(59),s(60),s(106),s(107),s(109),s(35),s(111),s(112),s(113),s(69),s(70),s(114),s(116),s(117),s(118),s(119),s(120),s(121),s(122),s(123),s(125)},function(e,t,s){"use strict";AFRAME.registerComponent("ambient-light",{schema:{color:{type:"color"},intensity:{default:1}},init(){const e=this.el;this.light=new THREE.AmbientLight,this.el.setObject3D("ambient-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update(e){this.data.color!==e.color&&this.light.color.set(this.data.color),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("ambient-light")}})},function(e,t,s){"use strict";AFRAME.registerComponent("css-class",{schema:{type:"string"},multiple:!0,init(){this.el.classList.add(this.data)},update(e){this.data!==e&&(this.el.classList.remove(e),this.el.classList.add(this.data))},remove(){this.el.classList.remove(this.data)}})},function(e,t,s){"use strict";var i,a=s(108),n=(i=a,i&&i.__esModule?i:{default:i});AFRAME.registerComponent("directional-light",{schema:{color:{type:"color"},intensity:{default:1},castShadow:{default:!0},shadowMapResolution:{default:[512,512]}},init(){const e=this.el;this.light=new THREE.DirectionalLight,this.light.position.set(0,0,0),this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.light.matrixNeedsUpdate=!0,this.el.setObject3D("directional-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update(e){const t=this.light;this.data.color!==e.color&&t.color.set(this.data.color),this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow);const[s,i]=this.data.shadowMapResolution,[a,n]=e.shadowMapResolution?e.shadowMapResolution:[512,512];s===a&&i===n||(t.shadow.mapSize.set(s,i),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null))},tick(){window.APP&&"low"===window.APP.quality||(0,n.default)(this.light,this.el.sceneEl.object3D)},remove:function(){this.el.removeObject3D("directional-light")}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){a.makeEmpty(),i.makeEmpty(),t.traverse(e=>{const t=e.geometry;t&&e.castShadow&&(t.boundingBox||t.computeBoundingBox(),o.copy(t.boundingBox),o.applyMatrix4(e.matrixWorld),i.union(o))});const s=i.min,u=i.max;d[0].set(s.x,s.y,s.z),d[1].set(s.x,s.y,u.z),d[2].set(s.x,u.y,s.z),d[3].set(s.x,u.y,u.z),d[4].set(u.x,s.y,s.z),d[5].set(u.x,s.y,u.z),d[6].set(u.x,u.y,s.z),d[7].set(u.x,u.y,u.z),n.getInverse(e.shadow.camera.matrixWorld);for(let e=0;e<d.length;e++)d[e].applyMatrix4(n),a.expandByPoint(d[e]);const h=e.shadow.camera;h.left=a.min.x-r,h.right=a.max.x+r,h.bottom=a.min.y-r,h.top=a.max.y+r,h.near=a.min.z+l,h.far=a.max.z+c,h.updateProjectionMatrix()};const i=new THREE.Box3,a=new THREE.Box3,n=new THREE.Matrix4,o=new THREE.Box3,r=1,l=-500,c=500,d=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]},function(e,t,s){"use strict";AFRAME.registerComponent("duck",{schema:{initialForce:{default:0},maxForce:{default:6.5},maxScale:{default:5}},init:function(){this.physicsSystem=this.el.sceneEl.systems.physics,this.hasBody=!1,this.position=new CANNON.Vec3,this.force=new CANNON.Vec3(0,this.data.initialForce,0),this.initialScale=this.el.object3D.scale.x,this.maxScale=this.data.maxScale*this.initialScale},play:function(){this.physicsSystem.addComponent(this)},pause:function(){this.physicsSystem.removeComponent(this)},beforeStep:function(){if(this.el.body&&NAF.utils.isMine(this.el)){const e=this.el.object3D.scale.x,t=Math.min(1,(e-this.initialScale)/(this.maxScale-this.initialScale)),s=t*this.data.maxForce;if(s>0){const e=Math.random()*Math.PI*2,t=Math.cos(e),i=Math.sin(e);this.force.set(t,s,i),this.position.set(.01*t,0,.01*i),this.el.object3D.matrixNeedsUpdate=!0,this.el.body.applyForce(this.force,this.position)}}}})},,function(e,t,s){"use strict";AFRAME.registerComponent("heightfield",{init(){this.el.addEventListener("componentinitialized",e=>{"static-body"===e.detail.name&&this.generateAndAddHeightfield(this.el.components["static-body"])}),this.el.setAttribute("static-body",{shape:"none",mass:0})},generateAndAddHeightfield(e){const{offset:t,distance:s,data:i}=this.data,a=new CANNON.Quaternion;a.setFromAxisAngle(new CANNON.Vec3(1,0,0),-Math.PI/2);const n=new CANNON.Quaternion;n.setFromAxisAngle(new CANNON.Vec3(0,1,0),-Math.PI/2),n.mult(a,a);const o=new CANNON.Vec3(t.x,t.y,t.z),r=new CANNON.Heightfield(i,{elementSize:s});e.addShape(r,o,a)}})},function(e,t,s){"use strict";AFRAME.registerComponent("hemisphere-light",{schema:{skyColor:{type:"color"},groundColor:{type:"color"},intensity:{default:1}},init(){const e=this.el;this.light=new THREE.HemisphereLight,this.light.position.set(0,0,0),this.light.matrixNeedsUpdate=!0,this.el.setObject3D("hemisphere-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update(e){this.data.skyColor!==e.skyColor&&this.light.color.set(this.data.skyColor),this.data.groundColor!==e.groundColor&&this.light.groundColor.set(this.data.groundColor),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("hemisphere-light")}})},function(e,t,s){"use strict";AFRAME.registerComponent("hide-when-quality",{schema:{type:"string",default:"low"},init(){this.onQualityChanged=this.onQualityChanged.bind(this),this.el.sceneEl.addEventListener("quality-changed",this.onQualityChanged)},onQualityChanged(e){this.updateComponentState(e.detail)},update(e){this.data!==e&&this.updateComponentState(window.APP.quality)},updateComponentState(e){this.el.setAttribute("visible",e!==this.data)}})},function(e,t,s){"use strict";var i=s(80),a=s(9),n=s(79);s(58);var o,r=s(115),l=(o=r,o&&o.__esModule?o:{default:o});const c=new THREE.GLTFLoader;let d;c.load(l.default,e=>{d=e});const u=new THREE.Box3;AFRAME.registerComponent("media-loader",{schema:{fileId:{type:"string"},fileIsOwned:{type:"boolean"},src:{type:"string"},resize:{default:!1},resolve:{default:!1},contentType:{default:null},mediaOptions:{default:{},parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.onError=this.onError.bind(this),this.showLoader=this.showLoader.bind(this),this.clearLoadingTimeout=this.clearLoadingTimeout.bind(this),this.onMediaLoaded=this.onMediaLoaded.bind(this),this.shapeAdded=!1,this.hasBakedShapes=!1},setShapeAndScale(e){const t=this.el.getObject3D("mesh"),s=(0,i.getBox)(this.el,t),a=e?(0,i.getScaleCoefficient)(.5,s):1;if(this.el.object3DMap.mesh.scale.multiplyScalar(a),this.el.body&&this.shapeAdded&&this.el.body.shapes.length>1)this.el.removeAttribute("shape"),this.shapeAdded=!1;else if(!this.hasBakedShapes&&!s.isEmpty()){const e=new THREE.Vector3,{min:i,max:n}=s,o={x:Math.abs(i.x-n.x)/2*a,y:Math.abs(i.y-n.y)/2*a,z:Math.abs(i.z-n.z)/2*a};e.addVectors(i,n).multiplyScalar(.5*a),t.position.sub(e),this.el.setAttribute("shape",{shape:"box",halfExtents:o}),this.shapeAdded=!0}t.matrixNeedsUpdate=!0},tick(e,t){this.loaderMixer&&this.loaderMixer.update(t/1e3)},onError(){this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-pager"),this.el.removeAttribute("media-video"),this.el.setAttribute("media-image",{src:"error"}),clearTimeout(this.showLoaderTimeout),delete this.showLoaderTimeout},showLoader(){const e=!!d,t=e?d.scene.clone():new THREE.Mesh(new THREE.BoxGeometry,new THREE.MeshBasicMaterial);e&&(this.loaderMixer=new THREE.AnimationMixer(t),this.loadingClip=this.loaderMixer.clipAction(d.animations[0]),this.loadingClip.play()),this.el.setObject3D("mesh",t),this.hasBakedShapes=!!(this.el.body&&this.el.body.shapes.length>0),this.setShapeAndScale(!0),delete this.showLoaderTimeout},clearLoadingTimeout(){clearTimeout(this.showLoaderTimeout),this.loaderMixer&&(this.loadingClip.stop(),delete this.loaderMixer),delete this.showLoaderTimeout},setupHoverableVisuals(){const e=this.el.components["hoverable-visuals"];e&&(e.uniforms=(0,a.injectCustomShaderChunks)(this.el.object3D),u.setFromObject(this.el.object3DMap.mesh),u.getBoundingSphere(e.boundingSphere))},onMediaLoaded(){this.clearLoadingTimeout(),this.setupHoverableVisuals()},async update(e){try{const{src:t}=this.data;if(t===e.src||this.showLoaderTimeout||(this.showLoaderTimeout=setTimeout(this.showLoader,100)),!t)return;let s=t,i=t,o=this.data.contentType;if(this.data.resolve){const e=await(0,a.resolveUrl)(t);s=e.origin,o=e.meta&&e.meta.expected_content_type||o}if(i=(0,a.proxiedUrlFor)(s,null),o=o||(0,a.guessContentType)(s)||await(e=>fetch(e,{method:"HEAD"}).then(e=>e.headers.get("content-type")))(i),t!==e.src&&this.el.emit("media_resolved",{src:t,raw:i,contentType:o}),o.startsWith("video/")||o.startsWith("audio/"))this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-image"),this.el.addEventListener("video-loaded",this.onMediaLoaded,{once:!0}),this.el.setAttribute("media-video",Object.assign({},this.data.mediaOptions,{src:i})),this.el.components["position-at-box-shape-border"]&&this.el.setAttribute("position-at-box-shape-border",{dirs:["forward","back"]});else if(o.startsWith("image/"))this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-video"),this.el.addEventListener("image-loaded",this.onMediaLoaded,{once:!0}),this.el.removeAttribute("media-pager"),this.el.setAttribute("media-image",Object.assign({},this.data.mediaOptions,{src:i,contentType:o})),this.el.components["position-at-box-shape-border"]&&this.el.setAttribute("position-at-box-shape-border",{dirs:["forward","back"]});else if(o.startsWith("application/pdf"))this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-video"),this.el.setAttribute("media-pager",Object.assign({},this.data.mediaOptions,{src:s})),this.el.addEventListener("image-loaded",this.clearLoadingTimeout,{once:!0}),this.el.addEventListener("preview-loaded",this.onMediaLoaded,{once:!0}),this.el.components["position-at-box-shape-border"]&&this.el.setAttribute("position-at-box-shape-border",{dirs:["forward","back"]});else{if(!(o.includes("application/octet-stream")||o.includes("x-zip-compressed")||o.startsWith("model/gltf")))throw new Error(`Unsupported content type: ${o}`);this.el.removeAttribute("media-image"),this.el.removeAttribute("media-video"),this.el.removeAttribute("media-pager"),this.el.addEventListener("model-loaded",()=>{this.clearLoadingTimeout(),this.hasBakedShapes=!!(this.el.body&&this.el.body.shapes.length>(this.shapeAdded?1:0)),this.setShapeAndScale(this.data.resize),this.setupHoverableVisuals(),(0,n.addAnimationComponents)(this.el)},{once:!0}),this.el.addEventListener("model-error",this.onError,{once:!0}),this.el.setAttribute("gltf-model-plus",Object.assign({},this.data.mediaOptions,{src:i,contentType:o,inflate:!0,modelToWorldScale:this.data.resize?1e-4:1}))}}catch(e){console.error("Error adding media",e),this.onError()}}}),AFRAME.registerComponent("media-pager",{schema:{src:{type:"string"},index:{default:0}},init(){this.toolbar=null,this.imageSrc=null,this.onNext=this.onNext.bind(this),this.onPrev=this.onPrev.bind(this),this.el.addEventListener("image-loaded",async e=>{this.imageSrc=e.detail.src,await this._ensureUI(),this.update()})},async _ensureUI(){if(this.toolbar||!this.imageSrc)return;this.maxIndex=await(e=>fetch(e).then(e=>parseInt(e.headers.get("x-max-content-index"))))(this.imageSrc);const e=document.getElementById("paging-toolbar");this.el.querySelector(".interactable-ui").appendChild(document.importNode(e.content,!0)),this.toolbar=this.el.querySelector(".paging-toolbar"),setTimeout(()=>{this.nextButton=this.el.querySelector(".next-button [text-button]"),this.prevButton=this.el.querySelector(".prev-button [text-button]"),this.pageLabel=this.el.querySelector(".page-label"),this.nextButton.addEventListener("grab-start",this.onNext),this.prevButton.addEventListener("grab-start",this.onPrev),this.update(),this.el.emit("preview-loaded")},0)},async update(){if(!this.data.src)return;const e=(0,a.proxiedUrlFor)(this.data.src,this.data.index);this.el.setAttribute("media-image",{src:e,contentType:"image/png"}),await this._ensureUI(),this.pageLabel&&(this.pageLabel.setAttribute("text","value",`${this.data.index+1}/${this.maxIndex+1}`),this.repositionToolbar())},remove(){this.toolbar&&this.toolbar.parentNode.removeChild(this.toolbar)},onNext(){this.el.setAttribute("media-pager","index",Math.min(this.data.index+1,this.maxIndex)),this.el.emit("pager-page-changed")},onPrev(){this.el.setAttribute("media-pager","index",Math.max(this.data.index-1,0)),this.el.emit("pager-page-changed")},repositionToolbar(){this.toolbar.object3D.position.y=-this.el.getAttribute("shape").halfExtents.y-.2,this.toolbar.object3D.matrixNeedsUpdate=!0}})},function(e,t,s){e.exports=s.p+"assets/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb"},function(e,t,s){"use strict";AFRAME.registerComponent("point-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},castShadow:{default:!0},shadowMapResolution:{default:[512,512]}},init(){const e=this.el;this.light=new THREE.PointLight,this.light.decay=2,this.light.shadow.camera.matrixAutoUpdate=!0,this.el.setObject3D("point-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update(e){const t=this.light;this.data.color!==e.color&&t.color.set(this.data.color),this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.range!==e.range&&(t.distance=this.data.range),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow);const[s,i]=this.data.shadowMapResolution,[a,n]=e.shadowMapResolution?e.shadowMapResolution:[512,512];s===a&&i===n||(t.shadow.mapSize.set(s,i),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null))},remove:function(){this.el.removeObject3D("point-light")}})},function(e,t,s){"use strict";AFRAME.registerComponent("quack",{schema:{quackPercentage:{default:1},specialQuackPercentage:{default:.01}},init:function(){this._handleGrabStart=this._handleGrabStart.bind(this)},play:function(){this.el.addEventListener("grab-start",this._handleGrabStart)},pause:function(){this.el.removeEventListener("grab-start",this._handleGrabStart)},_handleGrabStart:function(){const e=Math.random();e<this.data.specialQuackPercentage?this.el.emit("specialquack"):e<this.data.quackPercentage&&this.el.emit("quack")}})},function(e,t,s){"use strict";function i(e,t,s){return(1-s)*e+s*t}AFRAME.registerComponent("scene-preview-camera",{schema:{duration:{default:90,type:"number"},positionOnly:{default:!1,type:"boolean"}},init:function(){this.startPoint=this.el.object3D.position.clone(),this.startRotation=new THREE.Quaternion,this.startRotation.setFromEuler(this.el.object3D.rotation),this.targetPoint=new THREE.Vector3(1,.5,-.5),this.targetPoint.applyMatrix4(this.el.object3D.matrix),this.targetPoint.add(new THREE.Vector3(0,0,-2));const e=new THREE.Euler(-.15,0,.15);this.targetRotation=new THREE.Quaternion,this.targetRotation.setFromEuler(e),this.targetRotation.premultiply(this.startRotation),this.startTime=(new Date).getTime(),this.backwards=!1,this.ranOnePass=!1},tick:function(){let e=((new Date).getTime()-this.startTime)/(1e3*this.data.duration);e=Math.min(1,Math.max(0,e)),this.ranOnePass?e=e<.5?2*e*e:(4-2*e)*e-1:e*=2-e;const t=this.backwards?this.targetPoint:this.startPoint,s=this.backwards?this.startPoint:this.targetPoint,a=this.backwards?this.targetRotation:this.startRotation,n=this.backwards?this.startRotation:this.targetRotation,o=new THREE.Quaternion;THREE.Quaternion.slerp(a,n,o,e),this.el.object3D.position.set(i(t.x,s.x,e),i(t.y,s.y,e),i(t.z,s.z,e)),this.data.positionOnly||this.el.object3D.rotation.setFromQuaternion(o),this.el.object3D.matrixNeedsUpdate=!0,e>=.9999&&(this.ranOnePass=!0,this.backwards=!this.backwards,this.startTime=(new Date).getTime())}})},function(e,t,s){"use strict";THREE.Sky=function(){const e=THREE.Sky.SkyShader,t=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:THREE.UniformsUtils.clone(e.uniforms),side:THREE.BackSide});THREE.Mesh.call(this,new THREE.BoxBufferGeometry(1,1,1),t)},THREE.Sky.prototype=Object.create(THREE.Mesh.prototype),THREE.Sky.prototype.constructor=THREE.Sky,THREE.Sky.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new THREE.Vector3}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")},AFRAME.registerComponent("skybox",{schema:{turbidity:{type:"number",default:10},rayleigh:{type:"number",default:2},luminance:{type:"number",default:1},mieCoefficient:{type:"number",default:.005},mieDirectionalG:{type:"number",default:.8},inclination:{type:"number",default:0},azimuth:{type:"number",default:0},distance:{type:"number",default:8e3}},init(){this.sky=new THREE.Sky,this.el.setObject3D("mesh",this.sky)},update(e){const t=this.sky.material.uniforms;if(this.data.turbidity!==e.turbidity&&(t.turbidity.value=this.data.turbidity),this.data.rayleigh!==e.rayleigh&&(t.rayleigh.value=this.data.rayleigh),this.data.luminance!==e.luminance&&(t.luminance.value=this.data.luminance),this.data.mieCoefficient!==e.mieCoefficient&&(t.mieCoefficient.value=this.data.mieCoefficient),this.data.mieDirectionalG!==e.mieDirectionalG&&(t.mieDirectionalG.value=this.data.mieDirectionalG),this.data.inclination!==e.inclination||this.data.azimuth!==e.azimuth||this.data.distance!==e.distance){const e=Math.PI*(this.data.inclination-.5),s=2*Math.PI*(this.data.azimuth-.5),i=this.data.distance,a=i*Math.cos(s),n=i*Math.sin(s)*Math.sin(e),o=i*Math.sin(s)*Math.cos(e);t.sunPosition.value.set(a,n,o).normalize(),1===this.el.object3D.scale.x&&this.sky.scale.set(i,i,i),this.el.object3D.matrixNeedsUpdate=!0}},remove(){this.el.removeObject3D("mesh")}})},function(e,t,s){"use strict";var i=s(13);AFRAME.registerComponent("spawn-controller",{schema:{target:{type:"selector"},loadedEvent:{type:"string"}},init(){this.onLoad=this.onLoad.bind(this),this.data.target.addEventListener(this.data.loadedEvent,this.onLoad)},onLoad(){const e=document.querySelectorAll("[spawn-point]");if(0===e.length)return;const t=Math.round((e.length-1)*Math.random()),s=e[t];(0,i.getLastWorldPosition)(s.object3D,this.el.object3D.position),this.el.object3D.rotation.copy(s.object3D.rotation),this.el.object3D.matrixNeedsUpdate=!0}}),AFRAME.registerComponent("spawn-point",{})},function(e,t,s){"use strict";AFRAME.registerComponent("spot-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},innerConeAngle:{default:0},outerConeAngle:{default:Math.PI/4},castShadow:{default:!0},shadowMapResolution:{default:[512,512]}},init(){const e=this.el;this.light=new THREE.SpotLight,this.light.position.set(0,0,0),this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.light.decay=2,this.light.matrixNeedsUpdate=!0,this.light.target.matrixNeedsUpdate=!0,this.el.setObject3D("spot-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update(e){const t=this.light;this.data.color!==e.color&&t.color.set(this.data.color),this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.range!==e.range&&(t.distance=this.data.range),this.data.innerConeAngle===e.innerConeAngle&&this.data.outerConeAngle===e.outerConeAngle||(t.angle=this.data.outerConeAngle,t.penumbra=1-this.data.innerConeAngle/this.data.outerConeAngle),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow);const[s,i]=this.data.shadowMapResolution,[a,n]=e.shadowMapResolution?e.shadowMapResolution:[512,512];s===a&&i===n||(t.shadow.mapSize.set(s,i),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null))},remove:function(){this.el.removeObject3D("spot-light")}})},function(e,t,s){"use strict";var i=s(13);AFRAME.registerComponent("sticky-object",{dependencies:["body"],schema:{autoLockOnLoad:{default:!1},autoLockOnRelease:{default:!1},autoLockSpeedLimit:{default:.5}},init(){this._onGrab=this._onGrab.bind(this),this._onRelease=this._onRelease.bind(this),this._onBodyLoaded=this._onBodyLoaded.bind(this)},play(){this.el.addEventListener("grab-start",this._onGrab),this.el.addEventListener("grab-end",this._onRelease),this.hasSetupBodyLoaded||(this.hasSetupBodyLoaded=!0,this.el.body?this._onBodyLoaded():this.el.addEventListener("body-loaded",this._onBodyLoaded,{once:!0}))},pause(){this.el.removeEventListener("grab-start",this._onGrab),this.el.removeEventListener("grab-end",this._onRelease)},setLocked(e){this.el.components.networked&&!NAF.utils.isMine(this.el)||(this.locked=e,this.el.setAttribute("body",{type:e?"static":"dynamic"}))},_onBodyLoaded(){this.data.autoLockOnLoad&&this.setLocked(!0)},_onRelease(){this.el.is("grabbed")||(this.data.autoLockOnRelease&&(0===this.data.autoLockSpeedLimit||this.el.body.velocity.lengthSquared()<this.data.autoLockSpeedLimit*this.data.autoLockSpeedLimit)&&this.setLocked(!0),this.el.body.collisionResponse=!0)},_onGrab(){this.el.components.grabbable&&0!==this.el.components.grabbable.data.maxGrabbers&&(this.setLocked(!1),this.el.body.collisionResponse=!1)},remove(){if(this.el.removeEventListener("body-loaded",this._onBodyLoaded),this.stuckTo){const e=this.stuckTo;delete this.stuckTo,e._unstickObject()}}}),AFRAME.registerComponent("sticky-object-zone",{dependencies:["physics"],init(){this.worldQuaternion=new THREE.Quaternion,this.worldPosition=new THREE.Vector3,(0,i.getLastWorldPosition)(this.el.object3D,this.worldPosition),(0,i.getLastWorldQuaternion)(this.el.object3D,this.worldQuaternion);const e=new THREE.Vector3(0,0,5).applyQuaternion(this.el.object3D.quaternion);this.bootImpulsePosition=new CANNON.Vec3(0,0,0),this.bootImpulse=new CANNON.Vec3,this.bootImpulse.copy(e),this._onCollisions=this._onCollisions.bind(this),this.el.addEventListener("collisions",this._onCollisions)},remove(){this.el.removeEventListener("collisions",this._onCollisions)},_onCollisions(e){e.detail.els.forEach(e=>{const t=e.components["sticky-object"];t&&this._setStuckObject(t)}),this.stuckObject&&e.detail.clearedEls.forEach(e=>{this.stuckObject&&this.stuckObject.el===e&&this._unstickObject()})},_setStuckObject(e){if(e.setLocked(!0),e.el.object3D.position.copy(this.worldPosition),e.el.object3D.quaternion.copy(this.worldQuaternion),e.el.object3D.matrixNeedsUpdate=!0,e.el.body.collisionResponse=!1,e.stuckTo=this,this.stuckObject&&NAF.utils.isMine(this.stuckObject.el)){const e=this.stuckObject.el;this._unstickObject(),e.body.applyImpulse(this.bootImpulse,this.bootImpulsePosition)}this.stuckObject=e},_unstickObject(){this.stuckObject.stuckTo===this&&(this.stuckObject.setLocked(!1),this.stuckObject.el.body.collisionResponse=!0,delete this.stuckObject.stuckTo),delete this.stuckObject}})},function(e,t,s){"use strict";var i=s(3),a=s(9),n=s(124),o=s(19),r=s(13);let l=0;AFRAME.registerComponent("super-spawner",{schema:{src:{default:""},resolve:{default:!1},template:{default:""},useCustomSpawnPosition:{default:!1},spawnPosition:{type:"vec3"},useCustomSpawnRotation:{default:!1},spawnRotation:{type:"vec4"},useCustomSpawnScale:{default:!1},spawnScale:{type:"vec3"},grabEvents:{default:["cursor-grab","primary_hand_grab"]},releaseEvents:{default:["cursor-release","primary_hand_release"]},spawnCooldown:{default:1},centerSpawnedObject:{default:!1},spawnEvent:{type:"string"},superHand:{type:"selector"},cursorSuperHand:{type:"selector"}},init(){this.heldEntities=new Map,this.cooldownTimeout=null,this.onGrabStart=this.onGrabStart.bind(this),this.onGrabEnd=this.onGrabEnd.bind(this),this.onSpawnEvent=this.onSpawnEvent.bind(this),this.sceneEl=document.querySelector("a-scene"),this.el.setAttribute("hoverable-visuals",{cursorController:"#cursor-controller",enableSweepingEffect:!1})},play(){this.el.addEventListener("grab-start",this.onGrabStart),this.el.addEventListener("grab-end",this.onGrabEnd),this.data.spawnEvent&&this.sceneEl.addEventListener(this.data.spawnEvent,this.onSpawnEvent)},pause(){this.el.removeEventListener("grab-start",this.onGrabStart),this.el.removeEventListener("grab-end",this.onGrabEnd),this.data.spawnEvent&&this.sceneEl.removeEventListener(this.data.spawnEvent,this.onSpawnEvent),this.cooldownTimeout&&(clearTimeout(this.cooldownTimeout),this.cooldownTimeout=null,this.el.setAttribute("visible",!0),this.el.classList.add("interactable"))},remove(){this.heldEntities.clear()},async onSpawnEvent(){const e=AFRAME.scenes[0].systems.userinput,t=e.get(i.paths.actions.leftHand.pose),s=e.get(i.paths.actions.rightHand.pose),l=t&&s?2:t||s?1:0,c=l>1&&this.el.sceneEl.is("vr-mode"),d=c?this.data.superHand:this.data.cursorSuperHand;if(this.cooldownTimeout||!d)return;const u=(0,a.addMedia)(this.data.src,this.data.template,o.ObjectContentOrigins.SPAWNER,this.data.resolve).entity;if((0,r.getLastWorldPosition)(d.object3D,u.object3D.position),(0,r.getLastWorldQuaternion)(d.object3D,u.object3D.quaternion),this.data.useCustomSpawnScale&&u.object3D.scale.copy(this.data.spawnScale),this.activateCooldown(),await(0,n.waitForEvent)("body-loaded",u),(0,r.getLastWorldPosition)(d.object3D,u.object3D.position),u.object3D.matrixNeedsUpdate=!0,!c)for(let e=0;e<this.data.grabEvents.length;e++)d.emit(this.data.grabEvents[e],{targetEntity:u})},async onGrabStart(e){if(this.cooldownTimeout)return;e.preventDefault();const t=e.detail.hand,s=l++;this.heldEntities.set(t,s);const i=(0,a.addMedia)(this.data.src,this.data.template,o.ObjectContentOrigins.SPAWNER,this.data.resolve).entity;if(i.object3D.position.copy(this.data.useCustomSpawnPosition?this.data.spawnPosition:this.el.object3D.position),i.object3D.rotation.copy(this.data.useCustomSpawnRotation?this.data.spawnRotation:this.el.object3D.rotation),i.object3D.scale.copy(this.data.useCustomSpawnScale?this.data.spawnScale:this.el.object3D.scale),i.object3D.matrixNeedsUpdate=!0,await(0,n.waitForEvent)("body-loaded",i),this.heldEntities.get(t)===s){this.data.centerSpawnedObject&&i.body.position.copy(t.object3D.position);for(let e=0;e<this.data.grabEvents.length;e++)t.emit(this.data.releaseEvents[e]),t.emit(this.data.grabEvents[e],{targetEntity:i})}this.activateCooldown()},onGrabEnd(e){this.heldEntities.delete(e.detail.hand),e.preventDefault()},activateCooldown(){this.data.spawnCooldown>0&&(this.el.setAttribute("visible",!1),this.el.classList.remove("interactable"),this.cooldownTimeout=setTimeout(()=>{this.el.setAttribute("visible",!0),this.el.classList.add("interactable"),this.cooldownTimeout=null},1e3*this.data.spawnCooldown))}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.waitForEvent=function(e,t){return new Promise(s=>{t.addEventListener(e,s,{once:!0})})}},function(e,t,s){"use strict";var i=s(69);function a(e,t){THREE.Mesh.call(this,e);t=t||{};const s=void 0!==t.time?t.time:0,i=void 0!==t.waterNormals?t.waterNormals:null,a=void 0!==t.sunDirection?t.sunDirection:new THREE.Vector3(.70707,.70707,0),n=new THREE.Color(void 0!==t.sunColor?t.sunColor:16777215),o=new THREE.Color(void 0!==t.waterColor?t.waterColor:8355711),r=void 0!==t.eye?t.eye:new THREE.Vector3(0,0,0),l=void 0!==t.distortionScale?t.distortionScale:20,c=void 0!==t.side?t.side:THREE.FrontSide,d=void 0!==t.fog&&t.fog,u={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.lights,{normalSampler:{value:null},time:{value:0},size:{value:1},distortionScale:{value:20},sunColor:{value:new THREE.Color(8355711)},sunDirection:{value:new THREE.Vector3(.70707,.70707,0)},eye:{value:new THREE.Vector3},waterColor:{value:new THREE.Color(5592405)}}]),vertexShader:"\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    ",fragmentShader:`\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk.common}\n      ${THREE.ShaderChunk.packing}\n      ${THREE.ShaderChunk.bsdfs}\n      ${THREE.ShaderChunk.lights_pars_begin}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `},h=new THREE.ShaderMaterial({fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:THREE.UniformsUtils.clone(u.uniforms),transparent:!1,lights:!0,side:c,fog:d});h.uniforms.time.value=s,h.uniforms.normalSampler.value=i,h.uniforms.sunColor.value=n,h.uniforms.waterColor.value=o,h.uniforms.sunDirection.value=a,h.uniforms.distortionScale.value=l,h.uniforms.eye.value=r,this.material=h}s(159),a.prototype=Object.create(THREE.Mesh.prototype),a.prototype.constructor=THREE.Water,AFRAME.registerComponent("water",{schema:{waterColor:{type:"color",default:"#001e0f"},distortionScale:{type:"number",default:3.7},sunColor:{type:"color",default:"#ffffff"},inclination:{type:"number",default:0},azimuth:{type:"number",default:0},distance:{type:"number",default:1},speed:{type:"number",default:.1},forceMobile:{type:"boolean",default:!1},normalMap:{type:"asset",default:"#water-normal-map"}},init(){const e=this.el.getObject3D("mesh"),t=e.geometry;e.visible=!1;const s=new THREE.Texture(this.data.normalMap);s.wrapS=s.wrapT=THREE.RepeatWrapping,s.needsUpdate=!0;const n={textureWidth:512,textureHeight:512,waterNormals:s,sunDirection:this.data.sunDirection,sunColor:new THREE.Color(this.data.sunColor),waterColor:new THREE.Color(this.data.waterColor),distortionScale:this.data.distortionScale,fog:!1};AFRAME.utils.device.isMobile()||this.data.forceMobile?this.water=new a(t,n):(this.water=new THREE.Water(t,n),this.water.mirrorCamera.layers.set(i.Layers.reflection)),this.el.setObject3D("water",this.water)},update(e){const t=this.water.material.uniforms;if(this.data.forceMobile!==e.forceMobile)return this.el.removeObject3D("water"),void this.init();if(this.data.waterColor!==e.waterColor&&t.waterColor.value.setStyle(this.data.waterColor),this.data.distortionScale!==e.distortionScale&&(t.distortionScale.value=this.data.distortionScale),this.data.sunColor!==e.sunColor&&t.sunColor.value.setStyle(this.data.sunColor),this.data.inclination!==e.inclination||this.data.azimuth!==e.azimuth||this.data.distance!==e.distance){const e=Math.PI*(this.data.inclination-.5),s=2*Math.PI*(this.data.azimuth-.5),i=this.data.distance,a=i*Math.cos(s),n=i*Math.sin(s)*Math.sin(e),o=i*Math.sin(s)*Math.cos(e);t.sunDirection.value.set(a,n,o)}},tick(e){this.water.material.uniforms.time.value=e/1e3*this.data.speed},remove(){this.el.removeObject3D("water");const e=this.el.getObject3D("mesh");e.visible=!0}})},function(e,t,s){"use strict";AFRAME.registerComponent("log-events",{init:function(){const e=this.el,t=this.log.bind(this),s=this.el.dispatchEvent;this.el.dispatchEvent=function(){return t(Array.from(arguments)),s.apply(e,arguments)}},log:function([e]){if(["componentchanged"].includes(e.type))return;let t=!0;console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail,(e,s)=>s&&"object"==typeof s&&void 0===s.length?t?(t=!1,s):"[object]":s)}`)}}),AFRAME.registerComponent("lifecycle-checker",{schema:{name:{type:"string"},tick:{default:!1}},init:function(){this.log("init")},update:function(){this.log("update")},tick:function(){this.data.tick&&this.log("tick")},remove:function(){this.log("remove")},pause:function(){this.log("pause")},play:function(){this.log("play")},log:function(e){console.info(`lifecycle-checker:${this.data.name} ${e}`)}})},function(e,t,s){"use strict";AFRAME.registerComponent("gamma-factor",{schema:{gammaFactor:{type:"number",default:2.2}},init(){const e=this.el;e.isScene||console.warn("gamma-factor component can only be applied to <a-scene>")},update(e){const t=this.data,s=this.el,i=s.renderer;let a=!1;t.gammaFactor!==e.gammaFactor&&(i.gammaFactor=t.gammaFactor,a=!0),a&&0!==s.time&&s.object3D.traverse(function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach(function(e){e.needsUpdate=!0}):e.material.needsUpdate=!0)})}})},function(e,t,s){"use strict";AFRAME.registerComponent("scene-sound",{multiple:!0,schema:{sound:{type:"string"},on:{type:"string"},off:{type:"string"}},init(){const e=this.el.components[`${this.attrName.replace("scene-","")}`];this.el.sceneEl.addEventListener(this.data.on,e.playSound),e.stopSound=e.stopSound.bind(e),this.data.off&&this.el.sceneEl.addEventListener(this.data.off,e.stopSound)}})},,function(e,t,s){e.exports=s.p+"assets/images/generic_vr_entry-6cb5c6205420ac7e9c3ca3e0c0a6db2c.svg"},,,function(e,t,s){e.exports=s.p+"assets/images/hub-preview-white-ccefba3b70ae589a0ca5ae3230c39299.png"},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(136);const n=1e4;t.default=class{constructor(e){this.setSocket=(e=>{this.socket=e}),this.generateCode=(()=>new Promise(e=>{const t=new Promise(s=>{const o=()=>{const r=()=>"ABCDEFGHI"[Math.floor(9*Math.random())],l=`${r()}${r()}${r()}${r()}`;let c=!1,d=!1;const u=this.socket.channel(`link:${l}`,{timeout:n}),h=()=>{d||u.leave(),d=!0},p=()=>h();u.on("link_expired",()=>s("expired")),u.on("presence_state",s=>{c||(Object.keys(s).length>0?o():(c=!0,e({code:l,cancel:p,onFinished:t})))}),u.on("link_request",e=>{if(c){const t={path:location.pathname};this.store.state.activity.hasChangedName&&(t.profile=i({},this.store.state.profile)),t.credentials=i({},this.store.state.credentials),(0,a.generatePublicKeyAndEncryptedObject)(e.public_key,t).then(({publicKeyString:t,encryptedData:i})=>{const a={target_session_id:e.reply_to_session_id,public_key:t,data:i};d||u.push("link_response",a),h(),s("used"),c=!1})}}),u.join().receive("error",e=>console.error(e))};o()})})),this.attemptLink=(e=>new Promise((t,s)=>{const i=this.socket.channel(`link:${e}`,{timeout:n});let o=!1;(0,a.generateKeys)().then(({publicKeyString:e,privateKey:r})=>{i.on("presence_state",t=>{const a=Object.keys(t).length;1===a?(i.push("link_request",{reply_to_session_id:this.socket.params().session_id,public_key:e}),setTimeout(()=>{o||(i.leave(),s(new Error("no_response")))},n)):0===a?(i.leave(),s(new Error("failed"))):(console.warn("link code channel already has 2 or more occupants, something fishy is going on."),i.leave(),s(new Error("in_use")))}),i.on("link_response",e=>{o=!0,i.leave(),(0,a.decryptObject)(e.public_key,r,e.data).then(t)}),i.join().receive("error",e=>console.error(e))})})),this.store=e}}},function(e,t,s){"use strict";async function i(e,t){return crypto.subtle.deriveKey({name:"ECDH",public:t},e,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"])}async function a(e){return JSON.stringify(await crypto.subtle.exportKey("jwk",e))}async function n(e){return await crypto.subtle.importKey("jwk",JSON.parse(e),{name:"ECDH",namedCurve:"P-256"},!0,[])}function o(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}function r(e){const t=new Uint8Array(e);let s="";for(let e=0;e<t.byteLength;e++)s+=String.fromCharCode(t[e]);return s}Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeys=async function(){const e=await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),t=await a(e.publicKey);return{publicKeyString:t,privateKey:e.privateKey}},t.generatePublicKeyAndEncryptedObject=async function(e,t){const s=new Uint8Array(16),l=await n(e),c=await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),d=await a(c.publicKey),u=await i(c.privateKey,l),h=btoa(r(await crypto.subtle.encrypt({name:"AES-CBC",iv:s},u,o(JSON.stringify(t)))));return{publicKeyString:d,encryptedData:h}},t.decryptObject=async function(e,t,s){const a=new Uint8Array(16),l=await n(e),c=await i(t,l),d=o(atob(s)),u=await crypto.subtle.decrypt({name:"AES-CBC",iv:a},c,d);return JSON.parse(r(u))}},function(e,t,s){"use strict";const{Pathfinding:i}=s(171);AFRAME.registerSystem("nav",{init:function(){this.pathfinder=new i},loadMesh:function(e,t){this.el.object3D.updateMatrixWorld();const s=(new THREE.Geometry).fromBufferGeometry(e.geometry);s.applyMatrix(e.matrixWorld),this.pathfinder.setZoneData(t,i.createZone(s))}})},,,,,function(e,t,s){"use strict";AFRAME.registerComponent("event-repeater",{schema:{eventSource:{type:"selector"},events:{type:"array"}},play:function(){this.data.eventListeners=[];const e=this.data.events;for(let t=0;t<e.length;t++){const s=e[t];this.data.eventListeners[s]=this._handleEvent.bind(this,s),this.data.eventSource.addEventListener(s,this.data.eventListeners[s])}},pause:function(){const e=this.data.events;for(let t=0;t<e.length;t++){const s=e[t];this.data.eventSource.removeEventListener(s,this.data.eventListeners[s])}this.data.eventListeners=[]},_handleEvent:function(e,t){this.el.emit(e,t.detail)}})},function(e,t,s){"use strict";var i=s(81);AFRAME.registerComponent("controls-shape-offset",{schema:{additionalOffset:{type:"vec3",default:{x:0,y:0,z:-.04}}},init:function(){this.controller=null,this.shapeAdded=!1,this.isLeft="left"===this.el.getAttribute("hand-controls2"),this._handleControllerConnected=this._handleControllerConnected.bind(this),this.el.addEventListener("controllerconnected",this._handleControllerConnected)},remove:function(){this.el.removeEventListener("controllerconnected",this._handleControllerConnected)},tick:function(){if(!this.shapeAdded&&this.controller){this.shapeAdded=!0;const e=this.isLeft?i.LEFT_CONTROLLER_OFFSETS:i.RIGHT_CONTROLLER_OFFSETS,t=e.hasOwnProperty(this.controller),s=t?e[this.controller]:e.default,a=new THREE.Vector3,n=new THREE.Quaternion,o=new THREE.Vector3;s.decompose(a,n,o),a.add(this.data.additionalOffset),n.conjugate();const r={shape:"box",halfExtents:{x:.03,y:.04,z:.05},orientation:n,offset:a};this.el.setAttribute("shape",r)}},_handleControllerConnected:function(e){this.controller=e.detail.name}})},,,,,,,,,,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=t.AppModes=Object.freeze({DEFAULT:"default",HUD:"hud"});AFRAME.registerSystem("app-mode",{init(){this.setMode(i.DEFAULT)},setMode(e){Object.values(i).includes(e)&&e!==this.mode&&(this.mode=e,this.el.emit("app-mode-change",{mode:this.mode}))}}),AFRAME.registerComponent("app-mode-toggle-playing",{multiple:!0,schema:{mode:{type:"string"},invert:{type:"boolean",default:!1}},init(){const e=this.el.sceneEl.systems["app-mode"];this.el.sceneEl.addEventListener("app-mode-change",e=>{this.updateComponentState(e.detail.mode===this.data.mode)}),this.updateComponentState(e.mode===this.data.mode)},updateComponentState(e){const t=this.id;this.el.components[t][e!==this.data.invert?"play":"pause"]()}}),AFRAME.registerComponent("app-mode-toggle-attribute",{multiple:!0,schema:{mode:{type:"string"},invert:{type:"boolean",default:!1},property:{type:"string"}},init(){const e=this.el.sceneEl.systems["app-mode"];this.el.sceneEl.addEventListener("app-mode-change",e=>{this.updateComponentState(e.detail.mode===this.data.mode)}),this.updateComponentState(e.mode===this.data.mode)},updateComponentState(e){const t=this.id;this.el.setAttribute(t,this.data.property,e!==this.data.invert)}}),AFRAME.registerComponent("app-mode-input-mappings",{schema:{modes:{default:[]},actionSets:{default:[]}},init(){this.el.sceneEl.addEventListener("app-mode-change",e=>{const{modes:t,actionSets:s}=this.data,i=t.indexOf(e.detail.mode);-1!=i&&t[i]&&s[i]&&AFRAME.inputActions[s[i]]?AFRAME.currentInputMapping=s[i]:console.error(`no valid action set for ${e.detail.mode}`)})}}),AFRAME.registerComponent("vr-mode-toggle-visibility",{schema:{invert:{type:"boolean",default:!1}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){const e=this.el.sceneEl.is("vr-mode");this.el.setAttribute("visible",e!==this.data.invert)}}),AFRAME.registerComponent("vr-mode-toggle-playing",{multiple:!0,schema:{invert:{type:"boolean",default:!1}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){const e=this.id,t=this.el.sceneEl.is("vr-mode");this.el.components[e][t!==this.data.invert?"play":"pause"]()}}),AFRAME.registerComponent("vr-mode-toggle-class",{multiple:!0,schema:{invert:{type:"boolean",default:!1},class:{type:"string",default:!1}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){const e=this.el.sceneEl.is("vr-mode");e?this.el.classList.add(this.data.class):this.el.classList.remove(this.data.class)}})},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.share=function(e){if(navigator.share)return navigator.share(e);{const{title:t,url:s}=e,i=550,a=420,n=(screen.width-i)/2,o=(screen.height-a)/2,r=`scrollbars=no,menubar=no,toolbar=no,status=no,width=${i},height=${a},top=${o},left=${n}`,l=`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}&text=${encodeURIComponent(t)}`;return window.open(l,"_blank",r),Promise.resolve()}}},,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warmSerializeElement=l,t.default=function(e){0===Object.keys(i).length&&l();if(e.nodeType!==Node.ELEMENT_NODE)throw new TypeError;const t=[],s=e.querySelectorAll("*");for(let e=0;e<s.length;e++){const i=s[e];if(!a[i.tagName]){const s=getComputedStyle(i),a=r(i.tagName);t[e]=i.style.cssText;for(let e=0;e<s.length;e++){const t=s[e];t.startsWith("-webkit")||s[t]!==a[t]&&(i.style[t]=s[t])}}}const n=e.outerHTML;for(let e=0;e<s.length;e++)s[e].style.cssText=t[e];return n};const i={},a={BASE:!0,HEAD:!0,HTML:!0,META:!0,NOFRAME:!0,NOSCRIPT:!0,PARAM:!0,SCRIPT:!0,STYLE:!0,TITLE:!0},n=["A","ABBR","ADDRESS","AREA","ARTICLE","ASIDE","AUDIO","B","BASE","BDI","BDO","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","COMMAND","DATALIST","DD","DEL","DETAILS","DFN","DIV","DL","DT","EM","EMBED","FIELDSET","FIGCAPTION","FIGURE","FONT","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEAD","HEADER","HGROUP","HR","HTML","I","IFRAME","IMG","INPUT","INS","KBD","KEYGEN","LABEL","LEGEND","LI","LINK","MAP","MARK","MATH","MENU","META","METER","NAV","NOBR","NOSCRIPT","OBJECT","OL","OPTION","OPTGROUP","OUTPUT","P","PARAM","PRE","PROGRESS","Q","RP","RT","RUBY","S","SAMP","SCRIPT","SECTION","SELECT","SMALL","SOURCE","SPAN","STRONG","STYLE","SUB","SUMMARY","SUP","SVG","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TIME","TITLE","TR","TRACK","U","UL","VAR","VIDEO","WBR"];function o(e){const t={},s=document.body.appendChild(document.createElement(e)),i=getComputedStyle(s);for(let e=0;e<i.length;e++)t[i[e]]=i[i[e]];return document.body.removeChild(s),t}function r(e){return e=e.toUpperCase(),i[e]||(i[e]=o(e)),i[e]}function l(){for(let e=0;e<n.length;e++)a[n[e]]||(i[n[e]]=o(n[e]))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e};s(241),s(621),s(96),s(97);var a=s(57);s(58),s(244),s(260),s(264),s(268),s(269),s(270),s(271),s(283),s(284),s(292),s(293),s(103);var n=s(34),o=s(12),r=s(27),l=W(r),c=s(79),d=s(45);s(104),s(295),s(296),s(297),s(298),s(299),s(300),s(302),s(81),s(303),s(304),s(305),s(306),s(307),s(308),s(126),s(309),s(310),s(311),s(312),s(313),s(314),s(315),s(316),s(317),s(318),s(319),s(320),s(323),s(324),s(325),s(326),s(327),s(328),s(329),s(330),s(331),s(332),s(333),s(127),s(334),s(335),s(128),s(337),s(338),s(339),s(340),s(341),s(343),s(344),s(345),s(346);var u=s(26),h=W(u),p=s(1),m=W(p),f=s(347),g=W(f),v=s(428),b=W(v),y=s(429),_=W(y),E=s(135),x=W(E),w=s(73),S=s(9),k=s(430),A=W(k),C=s(431),M=W(C),R=s(434),T=W(R),D=s(84);s(137),s(435),s(160),s(436),s(437),s(438),s(466),s(467),s(468),s(74);var H=s(75);s(172),s(188),s(512),s(523),s(524),s(142),s(143),s(525),s(526),s(527),s(528),s(529),s(530),s(531),s(534);var P=s(535),L=W(P),O=s(15),I=W(O),N=s(170),F=s(71),j=s(536),B=W(j),V=s(46),U=W(V);function W(e){return e&&e.__esModule?e:{default:e}}console.log(`Hubs version: ${{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.BUILD_VERSION||"?"}`),(0,a.patchWebGLRenderingContext)(),window.APP=new H.App,window.APP.RENDER_ORDER={HUD_BACKGROUND:1,HUD_ICONS:2,CURSOR:3};const z=window.APP.store,G=new URLSearchParams(location.search),$=AFRAME.utils.device.isMobile();THREE.Object3D.DefaultMatrixAutoUpdate=!1,window.APP.quality=G.get("quality")||$?"low":"high";const q=(0,U.default)("bot"),Y=(0,U.default)("disable_telemetry"),X=(0,U.default)("debug");q||Y||(0,I.default)(),(0,w.disableiOSZoom)();const J=new B.default;J.start(),z.init();let Q={};function K(e){Q=i({},Q,e),function(e={}){const t=document.querySelector("a-scene"),s=(0,U.default)("allow_multi"),a=G.get("vr_entry_type");h.default.render(m.default.createElement(g.default,i({scene:t,isBotMode:q,concurrentLoadDetector:J,disableAutoExitOnConcurrentLoad:s,forcedVREntryType:a,store:z},e)),document.getElementById("ui-root"))}(Q)}document.addEventListener("DOMContentLoaded",async()=>{(0,N.warmSerializeElement)();const e=(0,n.detectOS)(navigator.userAgent),t=(0,n.detect)();if(["iOS","Mac OS"].includes(e)&&["safari","ios"].includes(t.name))try{await navigator.mediaDevices.getUserMedia({audio:!0})}catch(e){return void K({showSafariMicDialog:!0})}const s=G.get("hub_id")||document.location.pathname.substring(1).split("/")[0];console.log(`Hub ID: ${s}`);const i=new T.default(s);if(navigator.serviceWorker)try{navigator.serviceWorker.register("/hub.service.js").then(()=>{navigator.serviceWorker.ready.then(e=>i.setRegistration(e)).catch(()=>i.setRegistrationFailed())}).catch(()=>i.setRegistrationFailed())}catch(e){i.setRegistrationFailed()}const a=document.querySelector("a-scene");a.removeAttribute("keyboard-shortcuts"),a.setAttribute("shadow",{enabled:"low"!==window.APP.quality});const r=new b.default(z),u=new _.default(z),h=new M.default(u);h.onRequestAuthentication=((e,t,s,i)=>{K({showSignInDialog:!0,signInMessageId:e,signInCompleteMessageId:t,signInContinueTextId:s,onContinueAfterSignIn:()=>{K({showSignInDialog:!1}),i()}})}),h.init();const p=new x.default(z);window.APP.scene=a,a.addEventListener("enter-vr",()=>{document.body.classList.add("vr-mode"),a.is("entered")||(console.log("Pre-emptively exiting VR mode."),a.exitVR())}),a.addEventListener("exit-vr",()=>document.body.classList.remove("vr-mode")),(0,L.default)(),K({authChannel:r,hubChannel:u,linkChannel:p,subscriptions:i,enterScene:h.enterScene,exitScene:h.exitScene,initialIsSubscribed:i.isSubscribed()}),a.addEventListener("action_focus_chat",()=>document.querySelector(".chat-focus-target").focus()),function(e){const t=(0,o.getReticulumFetchUrl)("/api/v1/support/availability");let s=null;const i=()=>fetch(t).then(({ok:t})=>{s!==t&&(s=t,e(s))});i(),setInterval(i,3e4)}(e=>K({isSupportAvailable:e}));const m="undefined"==typeof RTCDataChannelEvent?"no_data_channels":null;if(m)return K({platformUnsupportedReason:m}),void h.exitScene();if(G.get("required_version")&&{NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.BUILD_VERSION){const e={NODE_ENV:"production",RETICULUM_SERVER:"dev.reticulum.io",FARSPARK_SERVER:"farspark-dev.reticulum.io",NON_CORS_PROXY_DOMAINS:"hubs.local,reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.BUILD_VERSION.split(" ",1)[0];if(G.get("required_version")!==e)return K({roomUnavailableReason:"version_mismatch"}),setTimeout(()=>document.location.reload(),5e3),void h.exitScene()}const f=await(0,F.getAvailableVREntryTypes)();if(f.isInHMD){if(K({availableVREntryTypes:f,forcedVREntryType:"vr"}),/Oculus/.test(navigator.userAgent)){const e=await navigator.getVRDisplays(),t=e.length&&e[0];AFRAME.utils.device.getVRDisplay=(()=>t)}}else K({availableVREntryTypes:f});const g=document.querySelector("#environment-scene");g.addEventListener("bundleloaded",()=>{K({environmentSceneLoaded:!0});for(const e of g.children)(0,c.addAnimationComponents)(e);!function(){const e=document.querySelector("#player-camera"),t=document.querySelector("#environment-scene").object3D.getObjectByName("scene-preview-camera");if(t)e.object3D.position.copy(t.position),e.object3D.rotation.copy(t.rotation),e.object3D.rotation.reorder("YXZ");else{const t=e.object3D.position;e.object3D.position.set(t.x,2.5,t.z)}e.object3D.matrixNeedsUpdate=!0,e.setAttribute("scene-preview-camera","positionOnly: true; duration: 60"),e.components["pitch-yaw-rotator"].set(e.object3D.rotation.x,e.object3D.rotation.y)}(),q&&async function(e,t){const s=()=>{};for(e.renderer={setAnimationLoop:s,render:s};!NAF.connection.isConnected();)await(0,l.default)();t.enterSceneWhenLoaded(new MediaStream,!1)}(a,h)});const v=(0,o.connectToReticulum)(X);K({sessionId:v.params().session_id});const y={mobile:$,hmd:f.isInHMD},E=v.channel("ret",{hub_id:s});E.join().receive("ok",async e=>i.setVapidPublicKey(e.vapid_public_key)).receive("error",e=>{i.setVapidPublicKey(null),console.error(e)});const w=await i.getCurrentEndpoint(),k={profile:z.state.profile,push_subscription_endpoint:w,context:y},C=v.channel(`hub:${s}`,k),R=[],H=e=>{e.key=Date.now().toString(),R.push(e),K({presenceLogEntries:R}),a.emit(`presence-log-${e.type}`),setTimeout(()=>{e.expired=!0,K({presenceLogEntries:R}),setTimeout(()=>{R.splice(R.indexOf(e),1),K({presenceLogEntries:R})},5e3)},2e4)},P=new A.default(a,h,u,H,K);C.join().receive("ok",async e=>{u.setPhoenixChannel(C);const{token:t}=z.state.credentials;t&&await u.signIn(t),i.setHubChannel(u),i.setSubscribed(e.subscriptions.web_push),K({initialIsSubscribed:i.isSubscribed()}),await async function(e,t,s,i){const a=document.querySelector("a-scene");if(NAF.connection.isConnected())return void NAF.connection.entities.completeSync(null,!0);const n=i.hubs[0],r=n.topics[0],c=r.assets.find(e=>"glb"===e.asset_type),d=r.assets.find(e=>"gltf_bundle"===e.asset_type),u=(c||d).src,h=/\.gltf/i.test(u)||/\.glb/i.test(u);console.log(`Scene URL: ${u}`),console.log(`Janus host: ${n.host}`);const p=document.querySelector("#environment-scene"),m=document.querySelector("#objects-scene"),f=(0,o.getReticulumFetchUrl)(`/${n.hub_id}/objects.gltf`),g=document.createElement("a-entity");if(g.setAttribute("gltf-model-plus",{src:f,useCache:!1,inflate:!0}),m.appendChild(g),c||h){const e=document.createElement("a-entity");e.setAttribute("gltf-model-plus",{src:(0,S.proxiedUrlFor)(u),useCache:!1,inflate:!0}),e.addEventListener("model-loaded",()=>p.emit("bundleloaded")),p.appendChild(e)}else p.setAttribute("gltf-bundle",`src: ${u}`);K({hubId:n.hub_id,hubName:n.name,hubEntryCode:n.entry_code,onSendMessage:s.dispatch}),document.querySelector("#hud-hub-entry-link").setAttribute("text",{value:`hub.link/${n.entry_code}`,width:1.1,align:"center"}),g.addEventListener("model-loaded",async s=>{if(s.target===g){for(a.setAttribute("networked-scene",{room:n.hub_id,serverURL:`wss://${n.host}`,debug:!!X});!a.components["networked-scene"]||!a.components["networked-scene"].data;)await(0,l.default)();a.components["networked-scene"].connect().then(()=>{let e=null;NAF.connection.adapter.setReconnectionListeners(()=>{e||(e=setInterval(async()=>{const e=NAF.connection.adapter.serverUrl,s=await t.getHost(),i=`wss://${s}`;e!==i&&(console.log("Connecting to new Janus server "+i),a.setAttribute("networked-scene",{serverURL:i}),NAF.connection.adapter.serverUrl=i)},1e3))},()=>{clearInterval(e),e=null},null),NAF.connection.adapter.reliableTransport=((e,s,i)=>{const a={dataType:s,data:i};e&&(a.clientId=e),t.channel.push("naf",a)})}).catch(t=>{const s=t.error&&t.error.msg.match(/\bfull\b/i);console.error(t),K({roomUnavailableReason:s?"full":"connect_error"}),e.exitScene()})}})}(h,u,P,e)}).receive("error",e=>{"closed"===e.reason&&(h.exitScene(),K({roomUnavailableReason:"closed"})),console.error(e)});const O=new d.Presence(C);let I=!0;const j=document.querySelector("#hud-presence-count");O.onSync(()=>{K({presences:O.state});const e=Object.entries(O.state).length;j.setAttribute("text","value",e.toString()),I&&(I=!1,O.onJoin((e,t,s)=>{const i=s.metas[s.metas.length-1];if(t){const s=e===v.params().session_id,a=t.metas[0];!s&&a.presence!==i.presence&&i.profile.displayName&&H({type:"entered",presence:i.presence,name:i.profile.displayName}),a.profile&&i.profile&&a.profile.displayName!==i.profile.displayName&&H({type:"display_name_changed",oldName:a.profile.displayName,newName:i.profile.displayName})}else{const e=s.metas[0];e.presence&&e.profile.displayName&&H({type:"join",presence:e.presence,name:e.profile.displayName})}}),O.onLeave((e,t,s)=>{if(t&&t.metas.length>0)return;const i=s.metas[0];i.profile.displayName&&H({type:"leave",name:i.profile.displayName})}))}),C.on("naf",e=>{NAF.connection.adapter&&NAF.connection.adapter.onData(e)}),C.on("message",({session_id:e,type:t,body:s})=>{const i=O.state[e];if(!i)return;const n=a.is("entered"),o={name:i.metas[0].profile.displayName,type:t,body:s,maySpawn:n};a.is("vr-mode")&&(0,D.createInWorldLogMessage)(o),H(o)}),r.setSocket(v),p.setSocket(v)})},function(module,exports,__webpack_require__){"use strict";var _qs_truthy=__webpack_require__(46),_qs_truthy2=_interopRequireDefault(_qs_truthy);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const showLog=(0,_qs_truthy2.default)("debug_log");if(showLog){const template=document.createElement("template");template.innerHTML='\n\t<style>\n\t  #debug-log {\n\t\tposition: absolute;\n\t\ttop: 13em;\n\t\tbackground: white;\n\t\topacity: 0.7;\n      }\n      #debug-log, #debug-log-input {\n\t\tfont-family: monospace;\n\t\tfont-size: 11px;\n\t\twidth: 100%;\n\t  }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n\t</style>\n\t<div id="debug-log">\n        <div id="debug-log-controls">\n          <form id="debug-log-eval">\n            <input id="debug-log-input" placeholder="&gt;&gt;" autocorrect="off" autocapitalize="none" />\n            <button>&gt;</button>\n          </form>\n          <button id="debug-log-minimize">_</button>\n        </div>\n\t\t<div id="debug-log-log"></div>\n\t</div>\n  ',document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(template.content)});const debugLog=template.content.querySelector("#debug-log-log");debugLog.addEventListener("wheel",e=>e.stopPropagation());const debugLogInput=template.content.querySelector("#debug-log-input"),debugLogEval=template.content.querySelector("#debug-log-eval");debugLogEval.onsubmit=(e=>{e.preventDefault(),console.log(eval(`(${debugLogInput.value})`))});let minimized=!1;const debugLogMinimize=template.content.querySelector("#debug-log-minimize");debugLogMinimize.onclick=(()=>{minimized=!minimized,debugLog.className=minimized?"minimized":"",debugLog.scrollTop=debugLog.scrollHeight-debugLog.clientHeight});const origConsoleLog=console.log,origConsoleError=console.error,origConsoleWarn=console.warn,log=function(e,t){let s;debugLog.childNodes.length>1e3?s=debugLog.firstChild:(s=document.createElement("div"),s.classList.add("entry")),s.classList.remove("warn","error"),s.classList.add(e);const i=Array.from(t),a=i[0];let n;n="string"==typeof a&&a.includes("%c")?a.replace(/%c/g,""):a instanceof Error?`${a.message}\n${a.stack}`:i.map(e=>"string"==typeof e?e:JSON.stringify(e)).join(" ");const o=(new Date).toISOString().substring(11,23);s.textContent=`[${o}] ${n}`;const r=debugLog.scrollTop===debugLog.scrollHeight-debugLog.clientHeight;debugLog.append(s),r&&(debugLog.scrollTop=debugLog.scrollHeight-debugLog.clientHeight)};console.warn=function(){origConsoleWarn.apply(null,arguments),log("warn",arguments)},console.error=function(){origConsoleError.apply(null,arguments),log("error",arguments)},console.log=function(){origConsoleLog.apply(null,arguments),log("log",arguments)},window.onunhandledrejection=(e=>log("error",[e.reason.message,e.reason.code,e.reason.name])),window.onerror=(e=>log("error",[e]))}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";AFRAME.registerComponent("teleport-controls-matrix-auto-update",{init:function(){this.teleportControls=this.el.components["teleport-controls"],this._updateMatrixNeedsUpdate=this._updateMatrixNeedsUpdate.bind(this)},play:function(){this.el.sceneEl.addEventListener("teleported",this._updateMatrixNeedsUpdate)},pause:function(){this.el.sceneEl.removeEventListener("teleported",this._updateMatrixNeedsUpdate)},tick:function(){this.lastHitEntity!==this.teleportControls.hitEntity&&(this.teleportControls.hitEntity.object3D.traverse(e=>e.matrixAutoUpdate=!0),this.lastHitEntity=this.teleportControls.hitEntity)},_updateMatrixNeedsUpdate:function(){this.teleportControls.data.cameraRig.matrixNeedsUpdate=!0}})},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";document.addEventListener("DOMContentLoaded",()=>{const e=THREE.AudioContext.getContext();function t(){e.resume(),setTimeout(function(){"running"===e.state&&(document.body.removeEventListener("touchend",t,!1),document.body.removeEventListener("mouseup",t,!1))},0)}document.body.addEventListener("touchend",t,!1),document.body.addEventListener("mouseup",t,!1)})},function(e,t,s){"use strict";THREE.PositionalAudio.prototype.updateMatrixWorld=function(){const e=new THREE.Vector3,t=new THREE.Quaternion,s=new THREE.Vector3,i=new THREE.Vector3;return function(a){THREE.Object3D.prototype.updateMatrixWorld.call(this,a);let n=!1;this._lastPosition||(n=!0,this._lastPosition=new THREE.Vector3,this._lastOrientation=new THREE.Vector3,this._lastListenerPosition=new THREE.Vector3);const o=this.panner,r=o.context.listener;this.matrixWorld.decompose(e,t,s),i.set(0,0,1).applyQuaternion(t),(n||Math.abs(e.x-this._lastPosition.x)>Number.EPSILON||Math.abs(e.y-this._lastPosition.y)>Number.EPSILON||Math.abs(e.z-this._lastPosition.z)>Number.EPSILON||Math.abs(i.x-this._lastOrientation.x)>Number.EPSILON||Math.abs(i.y-this._lastOrientation.y)>Number.EPSILON||Math.abs(i.z-this._lastOrientation.z)>Number.EPSILON||r.positionX&&Math.abs(r.positionX.value-this._lastListenerPosition.x)>Number.EPSILON||r.positionY&&Math.abs(r.positionY.value-this._lastListenerPosition.y)>Number.EPSILON||r.positionZ&&Math.abs(r.positionZ.value-this._lastListenerPosition.z)>Number.EPSILON)&&(o.setPosition(e.x,e.y,e.z),o.setOrientation(i.x,i.y,i.z),this._lastPosition.x=e.x,this._lastPosition.y=e.y,this._lastPosition.z=e.z,this._lastOrientation.x=i.x,this._lastOrientation.y=i.y,this._lastOrientation.z=i.z,r.positionX&&r.positionY&&r.positionZ&&(this._lastListenerPosition.x=r.positionX.value,this._lastListenerPosition.y=r.positionY.value,this._lastListenerPosition.z=r.positionZ.value))}}()},,function(e,t,s){"use strict";AFRAME.registerComponent("wasd-to-analog2d",{schema:{analog2dOutputAction:{default:"wasd_analog2d"}},init:function(){this.output=[0,0],this.vectors={w:[0,1],a:[-1,0],s:[0,-1],d:[1,0]},this.keys={},this.onWasd=this.onWasd.bind(this),this.move=this.move.bind(this),this.onBlur=this.onBlur.bind(this)},play:function(){const e=["w_down","w_up","a_down","a_up","s_down","s_up","d_down","d_up"];for(const t of e)this.el.sceneEl.addEventListener(t,this.onWasd);this.el.sceneEl.addEventListener(this.data.analog2dOutputAction,this.move),window.addEventListener("blur",this.onBlur)},pause:function(){this.el.sceneEl.removeEventListener("wasd",this.onWasd),this.el.sceneEl.removeEventListener(this.data.analog2dOutputAction,this.move),window.removeEventListener("blur",this.onBlur),this.keys={}},onBlur:function(){this.keys={}},move:function(e){this.el.emit("move",{axis:e.detail.axis})},onWasd:function(e){const t=e.type,s=-1!==t.indexOf("down"),i=t[0].toLowerCase();this.keys[i]=s},tick:function(){this.target=[0,0];for(const e in this.keys)this.keys[e]&&this.vectors[e]&&(this.target=[this.target[0]+this.vectors[e][0],this.target[1]+this.vectors[e][1]]);const e=Math.sqrt(this.target[0]*this.target[0]+this.target[1]*this.target[1]);0!==e&&(this.target[0]=this.target[0]/e,this.target[1]=this.target[1]/e);if(Math.abs(this.output[0])<.01&&Math.abs(this.output[1])<.01&&0===this.target[0]&&0===this.target[1])return;this.output=[this.output[0]+.25*(this.target[0]-this.output[0]),this.output[1]+.25*(this.target[1]-this.output[1])],this.output!==[0,0]&&this.el.emit(this.data.analog2dOutputAction,{axis:this.output})}})},function(e,t,s){"use strict";const i=function(e,t,s){if(e&&e.length)for(const i of e)t.length&&t.forEach(e=>{i.addEventListener(e,s)})},a=function(e,t,s){if(e&&e.length)for(const i of e)t.length&&t.forEach(e=>{i.removeEventListener(e,s)})};AFRAME.registerComponent("mute-mic",{schema:{eventSrc:{type:"selectorAll"},toggleEvents:{type:"array"},muteEvents:{type:"array"},unmuteEvents:{type:"array"}},init:function(){this.onToggle=this.onToggle.bind(this),this.onMute=this.onMute.bind(this),this.onUnmute=this.onUnmute.bind(this)},play:function(){const{eventSrc:e,toggleEvents:t,muteEvents:s,unmuteEvents:a}=this.data;i(e,t,this.onToggle),i(e,s,this.onMute),i(e,a,this.onUnmute)},pause:function(){const{eventSrc:e,toggleEvents:t,muteEvents:s,unmuteEvents:i}=this.data;a(e,t,this.onToggle),a(e,s,this.onMute),a(e,i,this.onUnmute)},onToggle:function(){NAF.connection.adapter&&(this.el.is("muted")?(NAF.connection.adapter.enableMicrophone(!0),this.el.removeState("muted")):(NAF.connection.adapter.enableMicrophone(!1),this.el.addState("muted")))},onMute:function(){NAF.connection.adapter&&(this.el.is("muted")||(NAF.connection.adapter.enableMicrophone(!1),this.el.addState("muted")))},onUnmute:function(){this.el.is("muted")&&(NAF.connection.adapter.enableMicrophone(!0),this.el.removeState("muted"))}})},function(e,t,s){"use strict";AFRAME.registerComponent("bone-mute-state-indicator",{schema:{unmutedBoneName:{default:"Watch_Joint_MicON"},mutedBoneName:{default:"Watch_Joint_Muted"},onPos:{default:.81},offPos:{default:.5}},init(){this.onStateToggled=this.onStateToggled.bind(this),this.el.addEventListener("model-loaded",()=>{this.unmutedBone=this.el.object3D.getObjectByName(this.data.unmutedBoneName),this.mutedBone=this.el.object3D.getObjectByName(this.data.mutedBoneName),this.modelLoaded=!0,this.updateMuteState()})},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateToggled),this.el.sceneEl.addEventListener("stateremoved",this.onStateToggled)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateToggled),this.el.sceneEl.removeEventListener("stateremoved",this.onStateToggled)},onStateToggled(e){"muted"!==!e.detail.state&&this.updateMuteState()},updateMuteState(){if(!this.modelLoaded)return;const e=this.el.sceneEl.is("muted");this.mutedBone.position.y=e?this.data.onPos:this.data.offPos,this.unmutedBone.position.y=e?this.data.offPos:this.data.onPos,this.mutedBone.matrixNeedsUpdate=!0,this.unmutedBone.matrixNeedsUpdate=!0}})},function(e,t,s){"use strict";AFRAME.registerComponent("bone-visibility",{tick(){const{visible:e}=this.el.object3D;this.lastVisible!==e&&(e?this.el.object3D.scale.set(1,1,1):this.el.object3D.scale.set(1e-8,1e-8,1e-8),this.lastVisible=e,this.el.object3D.updateMatrices(!0,!0),this.el.object3D.updateMatrixWorld(!0,!0))}})},function(e,t,s){"use strict";AFRAME.registerComponent("in-world-hud",{schema:{haptic:{type:"selector"},raycaster:{type:"selector"}},init(){this.mic=this.el.querySelector(".mic"),this.freeze=this.el.querySelector(".freeze"),this.pen=this.el.querySelector(".penhud"),this.cameraBtn=this.el.querySelector(".camera-btn"),this.background=this.el.querySelector(".bg");const e=window.APP.RENDER_ORDER;this.mic.object3DMap.mesh.renderOrder=e.HUD_ICONS,this.freeze.object3DMap.mesh.renderOrder=e.HUD_ICONS,this.pen.object3DMap.mesh.renderOrder=e.HUD_ICONS,this.cameraBtn.object3DMap.mesh.renderOrder=e.HUD_ICONS,this.background.object3DMap.mesh.renderORder=e.HUD_BACKGROUND,this.updateButtonStates=(()=>{this.mic.setAttribute("icon-button","active",this.el.sceneEl.is("muted")),this.freeze.setAttribute("icon-button","active",this.el.sceneEl.is("frozen")),this.pen.setAttribute("icon-button","active",this.el.sceneEl.is("pen"))}),this.updateButtonStates(),this.onStateChange=(e=>{"muted"!==e.detail&&"frozen"!==e.detail&&"pen"!==e.detail||this.updateButtonStates()}),this.onMicClick=(()=>{this.el.emit("action_mute")}),this.onFreezeClick=(()=>{this.el.emit("action_freeze")}),this.onPenClick=(()=>{this.el.emit("spawn_pen")}),this.onCameraClick=(()=>{this.el.emit("action_spawn_camera")})},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange),this.mic.addEventListener("mousedown",this.onMicClick),this.freeze.addEventListener("mousedown",this.onFreezeClick),this.pen.addEventListener("mousedown",this.onPenClick),this.cameraBtn.addEventListener("mousedown",this.onCameraClick)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange),this.mic.removeEventListener("mousedown",this.onMicClick),this.freeze.removeEventListener("mousedown",this.onFreezeClick),this.pen.removeEventListener("mousedown",this.onPenClick),this.cameraBtn.removeEventListener("mousedown",this.onCameraClick)}})},function(e,t,s){"use strict";var i=s(301),a=r(i),n=s(625),o=r(n);function r(e){return e&&e.__esModule?e:{default:e}}AFRAME.registerComponent("virtual-gamepad-controls",{schema:{},init(){this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this),this.onFirstInteraction=this.onFirstInteraction.bind(this),this.onMoveJoystickChanged=this.onMoveJoystickChanged.bind(this),this.onMoveJoystickEnd=this.onMoveJoystickEnd.bind(this),this.onLookJoystickChanged=this.onLookJoystickChanged.bind(this),this.onLookJoystickEnd=this.onLookJoystickEnd.bind(this),this.mockJoystickContainer=document.createElement("div"),this.mockJoystickContainer.classList.add(o.default.mockJoystickContainer);const e=document.createElement("div");e.classList.add(o.default.mockJoystick);const t=document.createElement("div");t.classList.add(o.default.mockJoystick,o.default.inner),e.appendChild(t),this.mockJoystickContainer.appendChild(e);const s=document.createElement("div");s.classList.add(o.default.mockJoystick);const i=document.createElement("div");i.classList.add(o.default.mockJoystick,o.default.inner),s.appendChild(i),this.mockJoystickContainer.appendChild(s),document.body.appendChild(this.mockJoystickContainer);const n=document.createElement("div");n.classList.add(o.default.touchZone,o.default.left),document.body.appendChild(n),this.leftTouchZone=n,this.leftStick=a.default.create({zone:this.leftTouchZone,color:"white",fadeTime:0}),this.leftStick.on("start",this.onFirstInteraction),this.leftStick.on("move",this.onMoveJoystickChanged),this.leftStick.on("end",this.onMoveJoystickEnd);const r=document.createElement("div");r.classList.add(o.default.touchZone,o.default.right),document.body.appendChild(r),this.rightTouchZone=r,this.rightStick=a.default.create({zone:this.rightTouchZone,color:"white",fadeTime:0}),this.rightStick.on("start",this.onFirstInteraction),this.rightStick.on("move",this.onLookJoystickChanged),this.rightStick.on("end",this.onLookJoystickEnd),this.inVr=!1,this.moving=!1,this.rotating=!1,this.moveEvent={axis:[0,0]},this.rotateYEvent={value:0},this.rotateXEvent={value:0},this.el.sceneEl.addEventListener("enter-vr",this.onEnterVr),this.el.sceneEl.addEventListener("exit-vr",this.onExitVr)},onFirstInteraction(){this.leftStick.off("start",this.onFirstInteraction),this.rightStick.off("start",this.onFirstInteraction),document.body.removeChild(this.mockJoystickContainer)},onMoveJoystickChanged(e,t){const s=t.angle.radian,i=t.force<1?t.force:1,a=Math.cos(s)*i*1.85,n=Math.sin(s)*i*1.85;this.moving=!0,this.moveEvent.axis[0]=a,this.moveEvent.axis[1]=n},onMoveJoystickEnd(){this.moving=!1,this.moveEvent.axis[0]=0,this.moveEvent.axis[1]=0,this.el.sceneEl.emit("move",this.moveEvent)},onLookJoystickChanged(e,t){const s=t.angle.radian,i=t.force<1?t.force:1;this.rotating=!0,this.rotateYEvent.value=Math.cos(s)*i*.5,this.rotateXEvent.value=Math.sin(s)*i*.5},onLookJoystickEnd(){this.rotating=!1,this.rotateYEvent.value=0,this.rotateXEvent.value=0,this.el.sceneEl.emit("rotateY",this.rotateYEvent),this.el.sceneEl.emit("rotateX",this.rotateXEvent)},tick(){this.inVr||(this.moving&&this.el.sceneEl.emit("move",this.moveEvent),this.rotating&&(this.el.sceneEl.emit("rotateY",this.rotateYEvent),this.el.sceneEl.emit("rotateX",this.rotateXEvent)))},onEnterVr(){this.inVr=!0,this.leftTouchZone.style.display="none",this.rightTouchZone.style.display="none"},onExitVr(){this.inVr=!1,this.leftTouchZone.style.display="block",this.rightTouchZone.style.display="block"},remove(){this.el.sceneEl.removeEventListener("entervr",this.onEnterVr),this.el.sceneEl.removeEventListener("exitvr",this.onExitVr),document.body.removeChild(this.mockJoystickContainer),document.body.removeChild(this.leftTouchZone),document.body.removeChild(this.rightTouchZone)}})},,function(e,t,s){"use strict";const{Vector3:i,Quaternion:a,Matrix4:n,Euler:o}=THREE;AFRAME.registerComponent("ik-root",{schema:{camera:{type:"string",default:".camera"},leftController:{type:"string",default:".left-controller"},rightController:{type:"string",default:".right-controller"}},update(e){this.data.camera!==e.camera&&(this.camera=this.el.querySelector(this.data.camera)),this.data.leftController!==e.leftController&&(this.leftController=this.el.querySelector(this.data.leftController)),this.data.rightController!==e.rightController&&(this.rightController=this.el.querySelector(this.data.rightController))}}),AFRAME.registerComponent("ik-controller",{schema:{leftEye:{type:"string",default:"LeftEye"},rightEye:{type:"string",default:"RightEye"},head:{type:"string",default:"Head"},neck:{type:"string",default:"Neck"},leftHand:{type:"string",default:"LeftHand"},rightHand:{type:"string",default:"RightHand"},chest:{type:"string",default:"Spine"},hips:{type:"string",default:"Hips"},rotationSpeed:{default:5}},init(){this.flipY=(new n).makeRotationY(Math.PI),this.cameraForward=new n,this.headTransform=new n,this.hipsPosition=new i,this.invHipsToHeadVector=new i,this.middleEyeMatrix=new n,this.middleEyePosition=new i,this.invMiddleEyeToHead=new n,this.cameraYRotation=new o,this.cameraYQuaternion=new a,this.invHipsQuaternion=new a,this.headQuaternion=new a,this.rootToChest=new n,this.invRootToChest=new n,this.ikRoot=function(e){for(;e&&(!e.components||!e.components["ik-root"]);)e=e.parentNode;return e&&e.components["ik-root"]}(this.el),this.hands={left:{rotation:(new n).makeRotationFromEuler(new o(-Math.PI/2,Math.PI/2,0))},right:{rotation:(new n).makeRotationFromEuler(new o(Math.PI/2,Math.PI/2,0))}}},update(e){this.data.leftEye!==e.leftEye&&(this.leftEye=this.el.object3D.getObjectByName(this.data.leftEye)),this.data.rightEye!==e.rightEye&&(this.rightEye=this.el.object3D.getObjectByName(this.data.rightEye)),this.data.head!==e.head&&(this.head=this.el.object3D.getObjectByName(this.data.head)),this.data.neck!==e.neck&&(this.neck=this.el.object3D.getObjectByName(this.data.neck)),this.data.leftHand!==e.leftHand&&(this.leftHand=this.el.object3D.getObjectByName(this.data.leftHand)),this.data.rightHand!==e.rightHand&&(this.rightHand=this.el.object3D.getObjectByName(this.data.rightHand)),this.data.chest!==e.chest&&(this.chest=this.el.object3D.getObjectByName(this.data.chest)),this.data.hips!==e.hips&&(this.hips=this.el.object3D.getObjectByName(this.data.hips)),this.middleEyePosition.addVectors(this.leftEye.position,this.rightEye.position),this.middleEyePosition.divideScalar(2),this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x,this.middleEyePosition.y,this.middleEyePosition.z),this.invMiddleEyeToHead=this.middleEyeMatrix.getInverse(this.middleEyeMatrix),this.invHipsToHeadVector.addVectors(this.chest.position,this.neck.position).add(this.head.position).negate()},tick(e,t){if(!this.ikRoot)return;const s=this.ikRoot.el.object3D,{camera:i,leftController:n,rightController:o}=this.ikRoot,{hips:r,head:l,neck:c,chest:d,cameraForward:u,headTransform:h,invMiddleEyeToHead:p,invHipsToHeadVector:m,flipY:f,cameraYRotation:g,cameraYQuaternion:v,invHipsQuaternion:b,leftHand:y,rightHand:_,rootToChest:E,invRootToChest:x}=this;i.object3D.updateMatrix(),u.multiplyMatrices(i.object3D.matrix,f),h.multiplyMatrices(u,p),r.position.setFromMatrixPosition(h).add(m),g.setFromRotationMatrix(u,"YXZ"),g.x=0,g.z=0,v.setFromEuler(g),a.slerp(r.quaternion,v,r.quaternion,this.data.rotationSpeed*t/1e3),b.copy(r.quaternion).inverse(),l.quaternion.setFromRotationMatrix(h).premultiply(b),r.updateMatrix(),E.multiplyMatrices(r.matrix,d.matrix),x.getInverse(E),s.matrixNeedsUpdate=!0,c.matrixNeedsUpdate=!0,l.matrixNeedsUpdate=!0,d.matrixNeedsUpdate=!0,this.updateHand(this.hands.left,y,n,!0),this.updateHand(this.hands.right,_,o,!1)},updateHand(e,t,s,i){const a=t.el,n=t.matrix,o=s.object3D,r=a.components["personal-space-invader"],l=r&&r.invading;if(t.visible=!l&&o.visible,o.visible){n.multiplyMatrices(this.invRootToChest,o.matrix);const a=s.components["hand-controls2"];a&&n.multiply(i?a.getLeftControllerOffset():a.getRightControllerOffset()),n.multiply(e.rotation),t.position.setFromMatrixPosition(n),t.rotation.setFromRotationMatrix(n),t.matrixNeedsUpdate=!0}}})},function(e,t,s){"use strict";var i=s(3);const a=Math.PI/2;AFRAME.registerComponent("character-controller",{schema:{groundAcc:{default:5.5},easing:{default:10},pivot:{type:"selector"},snapRotationDegrees:{default:45*THREE.Math.DEG2RAD},rotationSpeed:{default:-3},fly:{default:!1}},init:function(){this.navZone="character",this.navGroup=null,this.navNode=null,this.velocity=new THREE.Vector3(0,0,0),this.accelerationInput=new THREE.Vector3(0,0,0),this.pendingSnapRotationMatrix=new THREE.Matrix4,this.angularVelocity=0,this._withinWarningLimit=!0,this._warningCount=0,this.setAccelerationInput=this.setAccelerationInput.bind(this),this.snapRotateLeft=this.snapRotateLeft.bind(this),this.snapRotateRight=this.snapRotateRight.bind(this),this.setAngularVelocity=this.setAngularVelocity.bind(this),this.handleTeleport=this.handleTeleport.bind(this)},update:function(){this.leftRotationMatrix=(new THREE.Matrix4).makeRotationY(this.data.snapRotationDegrees),this.rightRotationMatrix=(new THREE.Matrix4).makeRotationY(-this.data.snapRotationDegrees)},play:function(){const e=this.el.sceneEl;e.addEventListener("move",this.setAccelerationInput),e.addEventListener("rotateY",this.setAngularVelocity),e.addEventListener("teleported",this.handleTeleport)},pause:function(){const e=this.el.sceneEl;e.removeEventListener("move",this.setAccelerationInput),e.removeEventListener("rotateY",this.setAngularVelocity),e.removeEventListener("teleported",this.handleTeleport),this.reset()},reset(){this.accelerationInput.set(0,0,0),this.velocity.set(0,0,0),this.angularVelocity=0,this.pendingSnapRotationMatrix.identity()},setAccelerationInput:function(e){const t=e.detail.axis;this.accelerationInput.set(t[0],0,t[1])},setAngularVelocity:function(e){this.angularVelocity=e.detail.value},snapRotateLeft:function(){this.pendingSnapRotationMatrix.copy(this.leftRotationMatrix),this.el.emit("snap_rotate_left")},snapRotateRight:function(){this.pendingSnapRotationMatrix.copy(this.rightRotationMatrix),this.el.emit("snap_rotate_right")},handleTeleport:function(e){const t=e.detail.newPosition,s=e.detail.hitPoint;this.resetPositionOnNavMesh(t,s,this.el.object3D)},tick:function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,s=new THREE.Matrix4,a=new THREE.Vector3,n=new THREE.Vector3(0,1,0),o=new THREE.Matrix4,r=new THREE.Matrix4,l=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Matrix4,u=new THREE.Vector3,h=new THREE.Vector3;return function(p,m){if(!this.el.sceneEl.is("entered"))return;const f=m/1e3,g=this.el.object3D,v=this.data.pivot.object3D,b=this.data.groundAcc*f,y=this.data.rotationSpeed*this.angularVelocity*f;h.copy(g.scale),u.copy(g.position),g.updateMatrix();const _=AFRAME.scenes[0].systems.userinput;_.get(i.paths.actions.snapRotateLeft)&&this.snapRotateLeft(),_.get(i.paths.actions.snapRotateRight)&&this.snapRotateRight();const E=_.get(i.paths.actions.characterAcceleration);E&&this.accelerationInput.set(this.accelerationInput.x+E[0],this.accelerationInput.y+0,this.accelerationInput.z+E[1]),a.copy(v.position),a.applyMatrix4(g.matrix),t.setPosition(a),s.makeTranslation(-a.x,-a.y,-a.z),r.makeRotationAxis(n,g.rotation.y),l.makeRotationAxis(n,-g.rotation.y),c.makeRotationAxis(n,v.rotation.y),d.makeRotationAxis(n,-v.rotation.y),this.updateVelocity(f,v),this.accelerationInput.set(0,0,0);const x=_.get(i.paths.actions.boost)?2:1;e.makeTranslation(this.velocity.x*b*x,this.velocity.y*b*x,this.velocity.z*b*x),o.makeRotationAxis(n,y),g.matrix.premultiply(s),g.matrix.premultiply(l),g.matrix.premultiply(d),g.matrix.premultiply(e),g.matrix.premultiply(o),g.matrix.premultiply(this.pendingSnapRotationMatrix),g.matrix.premultiply(c),g.matrix.premultiply(r),g.matrix.premultiply(t),g.matrix.decompose(g.position,g.quaternion,g.scale),g.scale.copy(h),this.pendingSnapRotationMatrix.identity(),this.velocity.lengthSq()>1e-5&&!this.data.fly&&this.setPositionOnNavMesh(u,g.position,g),g.matrixNeedsUpdate=!0}}(),_warnWithWarningLimit:function(e){this._withinWarningLimit&&(this._warningCount++,this._warningCount>10&&(this._withinWarningLimit=!1,e="Warning count exceeded. Will not log further warnings"),console.warn("character-controller",e))},_setNavNode:function(e){if(null!==this.navNode)return;const{pathfinder:t}=this.el.sceneEl.systems.nav;this.navNode=t.getClosestNode(e,this.navZone,this.navGroup,!0)||t.getClosestNode(e,this.navZone,this.navGroup)},setPositionOnNavMesh:function(e,t,s){const{pathfinder:i}=this.el.sceneEl.systems.nav;this.navZone in i.zones&&(null===this.navGroup&&(this.navGroup=i.getGroup(this.navZone,t,!0,!0)),this._setNavNode(t),this.navNode=i.clampStep(e,t,this.navNode,this.navZone,this.navGroup,s.position),s.matrixNeedsUpdate=!0)},resetPositionOnNavMesh:function(e,t,s){const{pathfinder:i}=this.el.sceneEl.systems.nav;this.navZone in i.zones&&(this.navGroup=i.getGroup(this.navZone,t,!0,!0),this.navNode=null,this._setNavNode(t),i.clampStep(e,t,this.navNode,this.navZone,this.navGroup,s.position),s.matrixNeedsUpdate=!0)},updateVelocity:function(e,t){const s=this.data,i=this.velocity;if(e>.2)return i.x=0,i.y=0,void(i.z=0);0!==i.x&&(i.x-=i.x*s.easing*e),0!==i.y&&(i.y-=i.y*s.easing*e),0!==i.z&&(i.z-=i.z*s.easing*e);const n=s.groundAcc*e*this.accelerationInput.x,o=s.groundAcc*e*-this.accelerationInput.z;if(i.x+=n,this.data.fly){const e=t.rotation.x/a;i.y+=o*-e,i.z+=o*(1-e)}else i.z+=o;this.accelerationInput.x=.7*this.accelerationInput.x,this.accelerationInput.z=.7*this.accelerationInput.z,Math.abs(i.x)<.01&&(i.x=0),this.data.fly&&Math.abs(i.y)<.01&&(i.y=0),Math.abs(i.z)<.01&&(i.z=0)}})},function(e,t,s){"use strict";const i=[],a=[];AFRAME.registerComponent("hoverable-visuals",{schema:{cursorController:{type:"selector"},enableSweepingEffect:{type:"boolean",default:!0}},init(){this.uniforms=null,this.boundingSphere=new THREE.Sphere,this.sweepParams=[0,0]},remove(){this.uniforms=null,this.boundingBox=null},tick(e){if(!this.uniforms||!this.uniforms.size)return;const{hoverers:t}=this.el.components.hoverable;let s,n;for(const e of t)"player-left-controller"===e.id?s=e.object3D:"cursor"===e.id?this.data.cursorController.components["cursor-controller"].enabled&&(n=e.object3D):n=e.object3D;if(s&&s.matrixWorld.toArray(i),n&&n.matrixWorld.toArray(a),s||n){const e=this.el.object3D.matrixWorld.elements[13],t=this.el.object3D.scale.y*this.boundingSphere.radius;this.sweepParams[0]=e-t,this.sweepParams[1]=e+t}for(const t of this.uniforms.values())t.hubs_EnableSweepingEffect.value=this.data.enableSweepingEffect,t.hubs_SweepParams.value=this.sweepParams,t.hubs_HighlightInteractorOne.value=!!s,t.hubs_InteractorOnePos.value[0]=i[12],t.hubs_InteractorOnePos.value[1]=i[13],t.hubs_InteractorOnePos.value[2]=i[14],t.hubs_HighlightInteractorTwo.value=!!n,t.hubs_InteractorTwoPos.value[0]=a[12],t.hubs_InteractorTwoPos.value[1]=a[13],t.hubs_InteractorTwoPos.value[2]=a[14],(s||n)&&(t.hubs_Time.value=e)}})},function(e,t,s){"use strict";AFRAME.registerComponent("hover-visuals",{schema:{hand:{type:"string"},controller:{type:"selector"}},init(){this.uniforms=null},remove(){this.uniforms=null},tick(){if(!this.uniforms||!this.uniforms.size)return;const e=this.el.object3D.matrixWorld.elements,t=this.data.controller.components["super-hands"].state.has("hover-start");for(const s of this.uniforms.values())"left"===this.data.hand?(s.hubs_HighlightInteractorOne.value=t,s.hubs_InteractorOnePos.value[0]=e[12],s.hubs_InteractorOnePos.value[1]=e[13],s.hubs_InteractorOnePos.value[2]=e[14]):(s.hubs_HighlightInteractorTwo.value=t,s.hubs_InteractorTwoPos.value[0]=e[12],s.hubs_InteractorTwoPos.value[1]=e[13],s.hubs_InteractorTwoPos.value[2]=e[14])}})},function(e,t,s){"use strict";const i={low:.07,medium:.2,high:1};AFRAME.registerComponent("haptic-feedback",{schema:{hapticEventName:{default:"haptic_pulse"}},init:function(){this.handlePulse=this.handlePulse.bind(this),this.getActuator=this.getActuator.bind(this),this.getActuator().then(e=>{this.actuator=e})},getActuator(){return new Promise(e=>{const t=()=>{const s=this.el.components["tracked-controls"];s&&s.controller&&s.controller.hapticActuators&&s.controller.hapticActuators.length?e(s.controller.hapticActuators[0]):setTimeout(t,1e3)};setTimeout(t,1e3)})},play:function(){this.el.addEventListener(this.data.hapticEventName,this.handlePulse)},pause:function(){this.el.removeEventListener(this.data.hapticEventName,this.handlePulse)},handlePulse:function(e){const{intensity:t}=e.detail;i[t]?this.pulse(i[t]):Number(t)===t?this.pulse(t):console.warn(`Invalid intensity : ${t}`)},pulse:function(e){this.actuator&&this.actuator.pulse(e,15)}})},function(e,t,s){"use strict";AFRAME.registerComponent("offset-relative-to",{schema:{target:{type:"selector"},offset:{type:"vec3"},on:{type:"string"},orientation:{default:1},selfDestruct:{default:!1}},init(){this.updateOffset=this.updateOffset.bind(this),this.data.on?this.el.sceneEl.addEventListener(this.data.on,this.updateOffset):this.updateOffset()},updateOffset:function(){const e=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,0,-1),s=Math.PI/2,i=new THREE.Vector3;return function(){const a=this.el.object3D,n=this.data.target.object3D;switch(i.copy(this.data.offset),n.localToWorld(i),a.parent&&a.parent.worldToLocal(i),a.position.copy(i),this.el.body&&this.el.body.position.copy(a.position),n.getWorldQuaternion(a.quaternion),this.el.body&&this.el.body.quaternion.copy(a.quaternion),this.data.orientation){case 8:a.rotateOnAxis(t,3*s);break;case 7:a.rotateOnAxis(t,3*s),a.rotateOnAxis(e,2*s);break;case 6:a.rotateOnAxis(t,s);break;case 5:a.rotateOnAxis(t,s),a.rotateOnAxis(e,2*s);break;case 4:a.rotateOnAxis(t,2*s),a.rotateOnAxis(e,2*s);break;case 3:a.rotateOnAxis(t,2*s);break;case 2:a.rotateOnAxis(e,2*s)}a.matrixNeedsUpdate=!0,this.data.selfDestruct&&(this.data.on&&this.el.sceneEl.removeEventListener(this.data.on,this.updateOffset),this.el.removeAttribute("offset-relative-to"))}}()})},function(e,t,s){"use strict";var i=s(9);AFRAME.registerComponent("player-info",{schema:{displayName:{type:"string"},avatarSrc:{type:"string"}},init(){this.applyProperties=this.applyProperties.bind(this)},play(){this.el.addEventListener("model-loaded",this.applyProperties)},pause(){this.el.removeEventListener("model-loaded",this.applyProperties)},update(){this.applyProperties()},applyProperties(){const e=this.el.querySelector(".nametag");this.data.displayName&&e&&e.setAttribute("text",{value:this.data.displayName});const t=this.el.querySelector(".model");this.data.avatarSrc&&t&&t.setAttribute("gltf-model-plus","src",this.data.avatarSrc);const s=(0,i.injectCustomShaderChunks)(this.el.object3D);this.el.querySelectorAll("[hover-visuals]").forEach(e=>{e.components["hover-visuals"].uniforms=s})}})},function(e,t,s){"use strict";var i=s(36);const a={open:"allOpen",thumbDown:"thumbDown",indexDown:"indexDown",mrpDown:"mrpDown",thumbUp:"thumbsUp",point:"point",fist:"allGrip",pinch:"pinch"},n=["allOpen","thumbDown","indexDown","mrpDown","thumbsUp","point","allGrip","pinch"];AFRAME.registerComponent("hand-pose",{multiple:!0,init(){this.pose=0,this.animatePose=this.animatePose.bind(this);const e=(0,i.findAncestorWithComponent)(this.el,"animation-mixer"),t="left"==this.id?"_L":"_R";if(this.mixer=e&&e.components["animation-mixer"].mixer,!this.mixer||!this.mixer.clipAction(a.open+t))return console.warn("Avatar does not an 'allOpen' animation, disabling hand animations"),void this.el.removeAttribute("hand-pose");this.from=this.to=this.mixer.clipAction(a.open+t),this.from.play();const s=e=>{const t=e.components["networked-avatar"];return t||s(e.parentEl)};this.networkedAvatar=s(this.el)},tick(){this.networkedAvatar&&this.networkedAvatar.data&&this.networkedAvatar.data[`${this.id}_hand_pose`]!==this.pose&&(this.animatePose(n[this.pose],n[this.networkedAvatar.data[`${this.id}_hand_pose`]]),this.pose=this.networkedAvatar.data[`${this.id}_hand_pose`])},animatePose(e,t){this.from.stop(),this.to.stop();const s="left"==this.id?"_L":"_R";this.from=this.mixer.clipAction(e+s),this.to=this.mixer.clipAction(t+s),this.from.fadeOut(.065),this.to.fadeIn(.065),this.to.play(),this.from.play(),this.mixer.update(.001)}}),AFRAME.registerComponent("hand-pose-controller",{multiple:!0,schema:{eventSrc:{type:"selector"},networkedAvatar:{type:"selector"}},init:function(){this.setHandPose=this.setHandPose.bind(this)},play:function(){this.data.eventSrc.addEventListener("hand-pose",this.setHandPose)},pause:function(){this.data.eventSrc.removeEventListener("hand-pose",this.setHandPose)},setHandPose:function(e){this.data.networkedAvatar.setAttribute("networked-avatar",`${this.id}_hand_pose`,n.indexOf(a[e.detail.current]))}})},function(e,t,s){"use strict";AFRAME.registerComponent("gltf-bundle",{schema:{src:{default:""}},init:async function(){this._addGltfEntitiesForBundleJson=this._addGltfEntitiesForBundleJson.bind(this),this.baseURL=new URL(THREE.LoaderUtils.extractUrlBase(this.data.src),window.location.href);const e=await fetch(this.data.src),t=await e.json();this._addGltfEntitiesForBundleJson(t)},_addGltfEntitiesForBundleJson:function(e){const t=[];for(let s=0;s<e.assets.length;s++){const i=e.assets[s];if("resource"===i.type)continue;const a=new URL(i.src,this.baseURL).href,n=document.createElement("a-entity");n.setAttribute("gltf-model-plus",{src:a,useCache:!1,inflate:!0}),t.push(new Promise(e=>n.addEventListener("model-loaded",e))),this.el.appendChild(n)}Promise.all(t).then(()=>this.el.emit("bundleloaded"))}})},function(e,t,s){"use strict";var i=s(160);const a=2*Math.PI;AFRAME.registerComponent("hud-controller",{schema:{head:{type:"selector"},offset:{default:.7},lookCutoff:{default:20},animRange:{default:30},yawCutoff:{default:50},showTip:{type:"bool"}},init(){this.isYLocked=!1,this.lockedHeadPositionY=0,this.lookDir=new THREE.Vector3,this.lookEuler=new THREE.Euler},pause(){const e=this.el.sceneEl.systems["app-mode"];e.setMode(i.AppModes.DEFAULT)},tick(){const e=this.el.object3D,t=this.data.head.object3D,s=this.el.sceneEl,{offset:n,lookCutoff:o,animRange:r,yawCutoff:l,showTip:c}=this.data,d=t.rotation.x*THREE.Math.RAD2DEG,u=function(e,t){const s=Math.abs(t-e)%a;return s>Math.PI?a-s:s}(t.rotation.y,e.rotation.y)*THREE.Math.RAD2DEG;let h=1-THREE.Math.clamp(o-d,0,r)/r;c&&(h=1),1===h?(this.lockedHeadPositionY=t.position.y,this.hudLocked=!0):this.hudLocked&&d<o-r/2&&(this.hudLocked=!1),this.hudLocked&&(h=1);const p=u>=l||d<o-r/2;p&&(this.lookDir.set(0,0,-1),this.lookDir.applyQuaternion(t.quaternion),this.lookDir.add(t.position),e.position.x=this.lookDir.x,e.position.z=this.lookDir.z,e.rotation.copy(t.rotation),e.rotation.x=0,e.rotation.z=0),e.visible=!p,e.position.y=(this.isYLocked?this.lockedHeadPositionY:t.position.y)+n+(1-h)*n,e.rotation.x=(1-h)*THREE.Math.DEG2RAD*90,e.matrixNeedsUpdate=!0;const m=s.systems["app-mode"];d>o&&m.mode!==i.AppModes.HUD?m.setMode(i.AppModes.HUD):d<o&&m.mode===i.AppModes.HUD&&m.setMode(i.AppModes.DEFAULT)}})},function(e,t,s){"use strict";var i=s(3);AFRAME.registerComponent("freeze-controller",{schema:{toggleEvent:{type:"string"}},init:function(){this.onToggle=this.onToggle.bind(this)},play:function(){this.el.addEventListener(this.data.toggleEvent,this.onToggle)},pause:function(){this.el.removeEventListener(this.data.toggleEvent,this.onToggle)},tick:function(){const e=AFRAME.scenes[0].systems.userinput,t=e.frame[i.paths.actions.ensureFrozen],s=e.frame[i.paths.actions.thaw],a=this.el.is("frozen")&&s||!this.el.is("frozen")&&t;a&&this.onToggle()},onToggle:function(){window.APP.store.update({activity:{hasFoundFreeze:!0}}),NAF.connection.adapter&&(NAF.connection.adapter.toggleFreeze(),NAF.connection.adapter.frozen?(this.el.emit("play_freeze_sound"),this.el.addState("frozen")):(this.el.emit("play_thaw_sound"),this.el.removeState("frozen")))}})},function(e,t,s){"use strict";AFRAME.registerComponent("icon-button",{schema:{image:{type:"string"},hoverImage:{type:"string"},activeImage:{type:"string"},activeHoverImage:{type:"string"},active:{type:"boolean"},haptic:{type:"selector"},tooltip:{type:"selector"},tooltipText:{type:"string"},activeTooltipText:{type:"string"}},init(){this.onHover=(()=>{this.hovering=!0,this.updateButtonState(),this.emitHapticPulse()}),this.onHoverOut=(()=>{this.hovering=!1,this.updateButtonState()}),this.onClick=(()=>{this.emitHapticPulse()})},emitHapticPulse(){this.data.haptic&&this.data.haptic.emit("haptic_pulse",{intensity:"low"})},play(){this.updateButtonState(),this.el.addEventListener("hover-start",this.onHover),this.el.addEventListener("hover-end",this.onHoverOut),this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("hover-start",this.onHover),this.el.removeEventListener("hover-end",this.onHoverOut),this.el.removeEventListener("grab-start",this.onClick)},update(){this.updateButtonState()},updateButtonState(){const e=this.hovering,t=this.data.active,s=t?e?"activeHoverImage":"activeImage":e?"hoverImage":"image";this.el.setAttribute("src",this.data[s]),this.data.tooltip&&(this.data.tooltip.setAttribute("visible",this.hovering),this.data.tooltip.querySelector("[text]").setAttribute("text","value",this.data.active?this.data.activeTooltipText:this.data.tooltipText))}})},function(e,t,s){"use strict";AFRAME.registerComponent("text-button",{schema:{haptic:{type:"selector"},textHoverColor:{type:"string"},textColor:{type:"string"},backgroundHoverColor:{type:"string"},backgroundColor:{type:"string"}},init(){this.onHover=(()=>{this.hovering=!0,this.updateButtonState(),this.emitHapticPulse()}),this.onHoverOut=(()=>{this.hovering=!1,this.updateButtonState()}),this.onClick=(()=>{this.emitHapticPulse()}),this.textEl=this.el.parentEl.querySelector("[text]")},emitHapticPulse(){this.data.haptic&&this.data.haptic.emit("haptic_pulse",{intensity:"low"})},play(){this.updateButtonState(),this.el.addEventListener("mouseover",this.onHover),this.el.addEventListener("mouseout",this.onHoverOut),this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("mouseover",this.onHover),this.el.removeEventListener("mouseout",this.onHoverOut),this.el.removeEventListener("grab-start",this.onClick)},update(){this.updateButtonState()},updateButtonState(){const e=this.hovering;this.el.setAttribute("slice9","color",e?this.data.backgroundHoverColor:this.data.backgroundColor),this.textEl.setAttribute("text","color",e?this.data.textHoverColor:this.data.textColor)}});const i=function(){};AFRAME.registerComponent("text-raycast-hack",{dependencies:["text"],init(){this.el.getObject3D("text").raycast=i}})},function(e,t,s){"use strict";AFRAME.registerComponent("block-button",{init(){this.onClick=(()=>{this.block(this.owner)}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.owner=e.components.networked.data.owner})},play(){this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("grab-start",this.onClick)},block(e){NAF.connection.adapter.block(e)},unblock(e){NAF.connection.adapter.unblock(e),NAF.connection.entities.completeSync(e)}})},function(e,t,s){"use strict";var i=s(13);AFRAME.registerComponent("visibility-while-frozen",{schema:{withinDistance:{type:"number"},visible:{type:"boolean",default:!0}},init(){this.updateVisibility=this.updateVisibility.bind(this),this.camWorldPos=new THREE.Vector3,this.objWorldPos=new THREE.Vector3,this.cam=this.el.sceneEl.camera.el.object3D,this.onStateChange=(e=>{"frozen"!==!e.detail&&this.updateVisibility()}),this.updateVisibility()},tick(){if(!this.data.withinDistance)return;const e=this.el.sceneEl.is("frozen"),t=this.el.getAttribute("visible");(e||t)&&this.updateVisibility()},updateVisibility(){const e=this.el.sceneEl.is("frozen");let t=!0;const s=this.el.object3D.visible;void 0!==this.data.withinDistance&&(s||this.el.object3D.updateMatrices(!0,!0),(0,i.getLastWorldPosition)(this.cam,this.camWorldPos),this.objWorldPos.copy(this.el.object3D.position),this.el.object3D.localToWorld(this.objWorldPos),t=this.camWorldPos.distanceToSquared(this.objWorldPos)<this.data.withinDistance*this.data.withinDistance);const a=(e&&this.data.visible||!e&&!this.data.visible)&&t;s!==a&&this.el.setAttribute("visible",a)},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange)}}),AFRAME.registerComponent("ui-class-while-frozen",{init(){this.onStateChange=(e=>{"frozen"!==!e.detail&&this.el.classList.toggle("ui",this.el.sceneEl.is("frozen"))}),this.el.classList.toggle("ui",this.el.sceneEl.is("frozen"))},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange)}})},function(e,t,s){"use strict";s(627);AFRAME.registerComponent("stats-plus",{schema:{default:!1},init(){this.onExpand=this.onExpand.bind(this),this.onCollapse=this.onCollapse.bind(this),this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this);const e=this.el.sceneEl;this.stats=function(e){const t=new window.threeStats(e.renderer),s=new window.aframeStats(e),i=e.isMobile?[]:[t,s];return new window.rStats({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:i})}(e),this.statsEl=document.querySelector(".rs-base");const t=document.createElement("div");t.classList.add("rs-header");const s=document.createElement("h1");s.innerHTML="Stats",t.appendChild(s);const i=document.createElement("div");i.classList.add("rs-collapse-btn"),i.innerHTML="X",i.addEventListener("click",this.onCollapse),t.appendChild(i),this.statsEl.insertBefore(t,this.statsEl.firstChild),this.fpsEl=document.createElement("div"),this.fpsEl.addEventListener("click",this.onExpand),this.fpsEl.classList.add("rs-fps-counter"),document.body.appendChild(this.fpsEl),this.lastFpsUpdate=performance.now(),this.lastFps=0,this.frameCount=0,e.isMobile&&(this.statsEl.classList.add("rs-mobile"),this.fpsEl.classList.add("rs-mobile")),e.addEventListener("enter-vr",this.onEnterVr),e.addEventListener("exit-vr",this.onExitVr)},update(e){e!==this.data&&(this.data?(this.statsEl.classList.remove("a-hidden"),this.fpsEl.classList.add("a-hidden")):(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.remove("a-hidden")))},tick(){if(this.data){const e=this.stats;e("rAF").tick(),e("FPS").frame(),e().update()}else{const e=performance.now();if(this.frameCount++,e>=this.lastFpsUpdate+1e3){const t=Math.round(this.frameCount/((e-this.lastFpsUpdate)/1e3));t!==this.lastFps&&(this.fpsEl.innerHTML=Math.round(t)+" FPS",this.lastFps=t),this.lastFpsUpdate=e,this.frameCount=0}}},onEnterVr(){this.el.sceneEl.isMobile&&(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.add("a-hidden"))},onExitVr(){this.el.sceneEl.isMobile&&(this.data?this.statsEl.classList.remove("a-hidden"):this.fpsEl.classList.remove("a-hidden"))},onExpand(){this.el.setAttribute(this.name,!0)},onCollapse(){this.el.setAttribute(this.name,!1)},remove(){this.el.sceneEl.removeEventListener("enter-vr",this.hide),this.el.sceneEl.removeEventListener("exit-vr",this.show),this.statsEl&&(this.statsEl.parentNode.removeChild(this.statsEl),this.fpsEl.parentNode.removeChild(this.fpsEl))}})},function(e,t,s){"use strict";AFRAME.registerComponent("networked-avatar",{schema:{left_hand_pose:{default:0},right_hand_pose:{default:0}}})},function(e,t,s){"use strict";const i=["tracked-controls","hand-controls2","vive-controls","oculus-touch-controls","windows-motion-controls","daydream-controls","gearvr-controls"];AFRAME.registerComponent("avatar-replay",{schema:{camera:{type:"selector"},leftController:{type:"selector"},rightController:{type:"selector"},recordingUrl:{type:"string"}},init:function(){this.modelLoaded=new Promise(e=>this.el.addEventListener("model-loaded",e))},update:function(){const{camera:e,leftController:t,rightController:s,recordingUrl:i}=this.data;if(!i)return;const a=fetch(i).then(e=>e.json());e.setAttribute("motion-capture-replayer",{loop:!0}),this._setupController(t),this._setupController(s),this.dataLoaded=Promise.all([a,this.modelLoaded]).then(([i])=>{const a=e.components["motion-capture-replayer"];a.startReplaying(i.camera);const n=t.components["motion-capture-replayer"];n.startReplaying(i.left);const o=s.components["motion-capture-replayer"];o.startReplaying(i.right)})},_setupController:function(e){i.forEach(t=>e.removeAttribute(t)),e.setAttribute("visible",!0),e.setAttribute("motion-capture-replayer",{loop:!0})}})},function(e,t,s){"use strict";var i=s(321),a=r(i),n=s(322),o=r(n);function r(e){return e&&e.__esModule?e:{default:e}}class l extends THREE.Texture{constructor(e,t,s){super(document.createElement("canvas")),this.image.width=e[0].width,this.image.height=e[0].height,this._ctx=this.image.getContext("2d"),this.generateMipmaps=!1,this.isVideoTexture=!0,this.minFilter=THREE.NearestFilter,this.frames=e,this.delays=t,this.disposals=s,this.frame=0,this.frameStartTime=Date.now()}update(){if(!this.frames||!this.delays||!this.disposals)return;const e=Date.now();e-this.frameStartTime>this.delays[this.frame]&&(2===this.disposals[this.frame]&&this._ctx.clearRect(0,0,this.image.width,this.image.width),this.frame=(this.frame+1)%this.frames.length,this.frameStartTime=e,this._ctx.drawImage(this.frames[this.frame],0,0,this.image.width,this.image.height),this.needsUpdate=!0)}}const c=AFRAME.utils.device.isIOS();function d(e){return new Promise(async(t,s)=>{const i=await async function(e){const t=document.createElement("video");if(t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.autoplay=!0,t.muted=c,t.preload="auto",t.crossOrigin="anonymous",e.startsWith("hubs://")){const s=e.substring(7).split("/")[1],i=await NAF.connection.adapter.getMediaStream(s,"video");t.srcObject=new MediaStream(i.getVideoTracks())}else t.src=e;return t}(e),a=new THREE.VideoTexture(i);a.minFilter=THREE.LinearFilter,a.encoding=THREE.sRGBEncoding,i.addEventListener("loadedmetadata",()=>t(a),{once:!0}),i.onerror=s,c&&AFRAME.utils.material.isHLS(i.src||i.getAttribute("src"),i.type||i.getAttribute("type"))&&(a.format=THREE.RGBAFormat,a.needsCorrectionBGRA=!0,a.flipY=!1,a.needsCorrectionFlipY=!0)})}function u(e,t){const s=(t.image.videoHeight||t.image.height||1)/(t.image.videoWidth||t.image.width||1),i=Math.min(1,1/s),a=Math.min(1,s);e.object3DMap.mesh.scale.set(i,a,1),e.setAttribute("shape",{shape:"box",halfExtents:{x:i/2,y:a/2,z:.05}})}const h=new THREE.TextureLoader;function p(e){if(e.image instanceof HTMLVideoElement){const t=e.image;t.pause(),t.src="",t.load()}e.dispose()}h.setCrossOrigin("anonymous");const m=new class{constructor(){this.cache=new Map}set(e,t){this.cache.set(e,{texture:t,count:0}),this.retain(e)}has(e){return this.cache.has(e)}get(e){return this.cache.get(e).texture}retain(e){const t=this.cache.get(e);return t.count++,t.texture}release(e){const t=this.cache.get(e);t.count--,t.count<=0&&(p(t.texture),this.cache.delete(e))}},f=new Image;f.src=o.default;const g=new THREE.Texture(f);g.magFilter=THREE.NearestFilter,f.onload=(()=>{g.needsUpdate=!0}),AFRAME.registerComponent("media-video",{schema:{src:{type:"string"},volume:{type:"number",default:.5},loop:{type:"boolean",default:!0},audioType:{type:"string",default:"pannernode"},distanceModel:{type:"string",default:"inverse"},rolloffFactor:{type:"number",default:1},refDistance:{type:"number",default:1},maxDistance:{type:"number",default:1e4},coneInnerAngle:{type:"number",default:360},coneOuterAngle:{type:"number",default:0},coneOuterGain:{type:"number",default:0},videoPaused:{type:"boolean"},projection:{type:"string",default:"flat"},time:{type:"number"},tickRate:{default:1e3},syncTolerance:{default:2}},init(){if(this.onPauseStateChange=this.onPauseStateChange.bind(this),this.tryUpdateVideoPlaybackState=this.tryUpdateVideoPlaybackState.bind(this),this._grabStart=this._grabStart.bind(this),this._grabEnd=this._grabEnd.bind(this),this.lastUpdate=0,!this.data.src)return;NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this.updatePlaybackState(),"scene"===NAF.utils.getNetworkOwner(this.networkedEl)&&setTimeout(()=>{"scene"===NAF.utils.getNetworkOwner(this.networkedEl)&&NAF.utils.takeOwnership(this.networkedEl)},2e3+Math.floor(2e3*Math.random()))});const e=this.el.sceneEl;e.audioListener=e.audioListener||new THREE.AudioListener,e.camera&&e.camera.add(e.audioListener),e.addEventListener("camera-set-active",function(t){t.detail.cameraEl.getObject3D("camera").add(e.audioListener)})},play(){this.el.addEventListener("grab-start",this._grabStart),this.el.addEventListener("grab-end",this._grabEnd)},pause(){this.el.removeEventListener("grab-start",this._grabStart),this.el.removeEventListener("grab-end",this._grabEnd)},_grabStart(){this.el.components.grabbable&&0!==this.el.components.grabbable.data.maxGrabbers&&(this.video&&this.video.muted&&!this.video.paused&&(this.video.muted=!1),this.grabStartPosition=this.el.object3D.position.clone())},_grabEnd(){this.grabStartPosition&&this.grabStartPosition.distanceToSquared(this.el.object3D.position)<1e-4&&(this.togglePlayingIfOwner(),this.grabStartPosition=null)},togglePlayingIfOwner(){this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this.video&&this.tryUpdateVideoPlaybackState(!this.data.videoPaused)},remove(){this.mesh&&this.mesh.material&&p(this.mesh.material.map),this.video&&(this.video.removeEventListener("pause",this.onPauseStateChange),this.video.removeEventListener("play",this.onPauseStateChange))},onPauseStateChange(){this.el.setAttribute("media-video","videoPaused",this.video.paused),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this.el.emit("owned-video-state-changed")},updatePlaybackState(e){(e||this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&this.video)&&(Math.abs(this.data.time-this.video.currentTime)>this.data.syncTolerance?this.tryUpdateVideoPlaybackState(this.data.videoPaused,this.data.time):this.tryUpdateVideoPlaybackState(this.data.videoPaused))},tryUpdateVideoPlaybackState(e,t){this._playbackStateChangeTimeout&&clearTimeout(this._playbackStateChangeTimeout),e?(this.video.pause(),t&&(this.video.currentTime=t)):this.video.play().then(()=>{t&&(this.video.currentTime=t)}).catch(()=>{this._playbackStateChangeTimeout=setTimeout(()=>this.tryUpdateVideoPlaybackState(e,t),1e3)})},async update(e){const{src:t}=this.data;if(this.updatePlaybackState(),!t||t===e.src)return;let s;this.remove(),this.mesh&&this.mesh.material&&(this.mesh.material.map=null,this.mesh.material.needsUpdate=!0);try{if(s=await d(t),this.data.src!==t)return void p(s);if(!t.startsWith("hubs://")){let e;s.audioSource=this.el.sceneEl.audioListener.context.createMediaElementSource(s.image),"pannernode"===this.data.audioType?(e=new THREE.PositionalAudio(this.el.sceneEl.audioListener),e.setDistanceModel(this.data.distanceModel),e.setRolloffFactor(this.data.rolloffFactor),e.setRefDistance(this.data.refDistance),e.setMaxDistance(this.data.maxDistance),e.panner.coneInnerAngle=this.data.coneInnerAngle,e.panner.coneOuterAngle=this.data.coneOuterAngle,e.panner.coneOuterGain=this.data.coneOuterGain):e=new THREE.Audio(this.el.sceneEl.audioListener),e.gain.gain.value=this.data.volume,e.setNodeSource(s.audioSource),this.el.setObject3D("sound",e)}if(this.video=s.image,this.video.loop=this.data.loop,this.video.addEventListener("pause",this.onPauseStateChange),this.video.addEventListener("play",this.onPauseStateChange),c){const e=document.getElementById("video-unmute");this.el.appendChild(document.importNode(e.content,!0)),this.el.setAttribute("position-at-box-shape-border__unmute-ui",{target:".unmute-ui",dirs:["forward","back"]})}}catch(e){console.error("Error loading video",this.data.src,e),s=g}const i=this.data.projection;if(!this.mesh||i!==e.projection){const e=new THREE.MeshBasicMaterial;let t;"360-equirectangular"===i?(t=new THREE.SphereBufferGeometry(1,64,32),t.scale(-1,1,1)):(t=new THREE.PlaneGeometry,e.side=THREE.DoubleSide),this.mesh=new THREE.Mesh(t,e),this.el.setObject3D("mesh",this.mesh)}this.mesh.material.map=s,this.mesh.material.needsUpdate=!0,"flat"===i&&u(this.el,s),this.updatePlaybackState(!0),this.el.emit("video-loaded")},tick(){if(this.data.videoPaused||!this.video||!this.networkedEl||!NAF.utils.isMine(this.networkedEl))return;const e=performance.now();e-this.lastUpdate>this.data.tickRate&&(this.el.setAttribute("media-video","time",this.video.currentTime),this.lastUpdate=e)}}),AFRAME.registerComponent("media-image",{schema:{src:{type:"string"},projection:{type:"string",default:"flat"},contentType:{type:"string"}},remove(){m.release(this.data.src)},async update(e){let t;try{const{src:i,contentType:n}=this.data;if(!i)return;if(this.mesh&&this.mesh.map&&i!==e.src&&(this.mesh.material.map=null,this.mesh.material.needsUpdate=!0,this.mesh.map!==g&&m.release(e.src)),m.has(i))t=m.retain(i);else{if("error"===i)t=g;else if(n.includes("image/gif"))t=await async function(e){return new Promise((t,s)=>{const i=new a.default;i.onmessage=(i=>{const[a,n,o,r]=i.data;if(!a)return void s(`error loading gif: ${i.data[1]}`);let c=0;for(let s=0;s<n.length;s++){const i=new Image;i.onload=(i=>{if(c++,n[s]=i.target,c===n.length){const s=new l(n,o,r);s.image.src=e,s.encoding=THREE.sRGBEncoding,s.minFilter=THREE.LinearFilter,t(s)}}),i.src=n[s]}}),fetch(e,{mode:"cors"}).then(e=>e.arrayBuffer()).then(e=>{i.postMessage(e,[e])}).catch(s)})}(i);else{if(!n.startsWith("image/"))throw new Error(`Unknown image content type: ${n}`);t=await(s=i,new Promise((e,t)=>{h.load(s,t=>{t.encoding=THREE.sRGBEncoding,t.minFilter=THREE.LinearFilter,e(t)},null,function(e){t(`'${s}' could not be fetched (Error code: ${e.status}; Response: ${e.statusText})`)})}))}if(m.set(i,t),this.data.src!==i)return void m.release(i)}}catch(e){console.error("Error loading image",this.data.src,e),t=g}var s;const i=this.data.projection;if(!this.mesh||i!==e.projection){const e=new THREE.MeshBasicMaterial;let t;"360-equirectangular"===i?(t=new THREE.SphereBufferGeometry(1,64,32),t.scale(-1,1,1)):(t=new THREE.PlaneGeometry,e.side=THREE.DoubleSide),this.mesh=new THREE.Mesh(t,e),this.el.setObject3D("mesh",this.mesh)}this.mesh.material.map=t,this.mesh.material.transparent=t.format===THREE.RGBAFormat,this.mesh.material.needsUpdate=!0,"flat"===i&&u(this.el,t),this.el.emit("image-loaded",{src:this.data.src})}})},,function(e,t){e.exports="data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw=="},function(e,t,s){"use strict";var i=s(3);AFRAME.registerComponent("pinch-to-move",{schema:{speed:{default:.25}},init(){this.axis=[0,0]},tick(){const e=AFRAME.scenes[0].systems.userinput,t=e.get(i.paths.device.touchscreen.pinchDelta);t&&(this.axis[1]=t*this.data.speed,this.el.emit("move",{axis:this.axis}))}})},function(e,t,s){"use strict";var i=s(3);const a=THREE.Math.degToRad,n=THREE.Math.radToDeg;AFRAME.registerComponent("pitch-yaw-rotator",{schema:{minPitch:{default:-65},maxPitch:{default:65}},init(){this.pitch=0,this.yaw=0,this.onRotateX=this.onRotateX.bind(this),this.el.sceneEl.addEventListener("rotateX",this.onRotateX),this.pendingXRotation=0},onRotateX(e){this.pendingXRotation+=e.detail.value},look(e,t){const{minPitch:s,maxPitch:i}=this.data;this.pitch+=e,this.pitch=THREE.Math.clamp(this.pitch,s,i),this.yaw+=t},set(e,t){const{minPitch:s,maxPitch:i}=this.data;this.pitch=THREE.Math.clamp(n(e),s,i),this.yaw=n(t)},tick(){const e=AFRAME.scenes[0].systems.userinput,t=e.get(i.paths.actions.cameraDelta);let s=this.pendingXRotation,n=0;t&&(n+=t[0],s+=t[1]),0===s&&0===n||(this.look(s,n),this.el.object3D.rotation.set(a(this.pitch),a(this.yaw),0),this.el.object3D.rotation.order="YXZ"),this.pendingXRotation=0}})},function(e,t,s){"use strict";AFRAME.registerComponent("auto-scale-cannon-physics-body",{dependencies:["body"],schema:{equalityEpsilon:{default:.001},debounceDelay:{default:100}},init(){this.body=this.el.components.body,this.prevScale=this.el.object3D.scale.clone(),this.nextUpdateTime=-1},tick(e){const t=this.el.object3D.scale;var s,i,a;s=this.data.equalityEpsilon,i=t,a=this.prevScale,Math.abs(i.x-a.x)<s&&Math.abs(i.y-a.y)<s&&Math.abs(i.z-a.z)<s||(this.prevScale.copy(t),this.nextUpdateTime=e+this.data.debounceDelay),this.nextUpdateTime>0&&e>this.nextUpdateTime&&(this.nextUpdateTime=-1,this.body.updateCannonScale())}})},function(e,t,s){"use strict";var i=s(80),a=s(13);const n=Math.PI,o=n/2,r=3*o,l=new THREE.Vector3(1,0,0),c=new THREE.Vector3(0,0,1),d=new THREE.Vector3(-1,0,0),u=new THREE.Vector3(0,0,-1),h={left:{dir:d,rotation:r,halfExtent:"x"},right:{dir:l,rotation:o,halfExtent:"x"},forward:{dir:c,rotation:0,halfExtent:"z"},back:{dir:u,rotation:n,halfExtent:"z"}},p={x:"z",z:"x"};AFRAME.registerComponent("position-at-box-shape-border",{multiple:!0,schema:{target:{type:"string"},dirs:{default:["left","right","forward","back"]}},init(){this.cam=this.el.sceneEl.camera.el.object3D,this._updateBox=this._updateBox.bind(this),this.halfExtents=new THREE.Vector3,this.el.sceneEl.systems["frame-scheduler"].schedule(this._updateBox,"media-components")},remove(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._updateBox,"media-components")},update(){this.dirs=this.data.dirs.map(e=>h[e])},tick(){if(!this.target)return this.targetEl=this.el.querySelector(this.data.target),this.target=this.targetEl.object3D,this.targetEl.addEventListener("animationcomplete",()=>{this.targetEl.removeAttribute("animation__show")}),this.target.scale.setScalar(.01),void(this.target.matrixNeedsUpdate=!0);if(!this.el.getObject3D("mesh"))return;const e=this.targetEl.getAttribute("visible"),t=e&&!this.wasVisible,s=this.el.object3D.scale.x!==this.previousScaleX||this.el.object3D.scale.y!==this.previousScaleY||this.el.object3D.scale.z!==this.previousScaleZ,i=this.targetEl.getAttribute("animation__show");(t||s&&i)&&this._updateBox(!0),this.wasVisible=e,this.previousScaleX=this.el.object3D.scale.x,this.previousScaleY=this.el.object3D.scale.y,this.previousScaleZ=this.el.object3D.scale.z},_updateBox:function(){const e=new THREE.Vector3,t=new THREE.Vector3,s=new THREE.Vector3,n=new THREE.Vector3;return function(o){if(!this.halfExtents||this.mesh!==this.el.getObject3D("mesh")||this.shape!==this.el.components.shape)if(this.mesh=this.el.getObject3D("mesh"),this.shape=this.el.components.shape,this.el.components.shape)this.shape=this.el.components.shape,this.halfExtents.copy(this.shape.data.halfExtents);else{const e=(0,i.getBox)(this.el,this.mesh);this.halfExtents=e.min.clone().negate().add(e.max).multiplyScalar(.51/this.el.object3D.scale.x)}(0,a.getLastWorldPosition)(this.cam,e);let r=1/0,l=this.dirs[0].dir,c=this.dirs[0].halfExtent,d=this.halfExtents[c],u=this.dirs[0].rotation;for(let t=0;t<this.dirs.length;t++){const i=this.dirs[t].dir,a=this.dirs[t].halfExtent,n=this.halfExtents[a];s.copy(i).multiplyScalar(n),this.el.object3D.localToWorld(s);const o=s.distanceToSquared(e);o<r&&(r=o,l=i,d=n,u=this.dirs[t].rotation,c=a)}this.target.position.copy(t.copy(l).multiplyScalar(d)),this.target.rotation.set(0,u,0),n.setFromMatrixScale(this.target.parent.matrixWorld);const h=Math.sqrt(r),m=this.halfExtents[p[c]]*h,f=Math.min(2,Math.max(.5,m*n.x)),g=f/n.x;o?(this.targetEl.removeAttribute("animation__show"),this.targetEl.setAttribute("animation__show",{property:"scale",dur:300,from:{x:.8*g,y:.8*g,z:.8*g},to:{x:g,y:g,z:g},easing:"easeOutElastic"})):this.targetEl.getAttribute("animation__show")||this.target.scale.setScalar(g),this.target.matrixNeedsUpdate=!0}}()})},function(e,t,s){"use strict";AFRAME.registerComponent("pinnable",{schema:{pinned:{default:!1}},init(){this._applyState=this._applyState.bind(this),this._fireEvents=this._fireEvents.bind(this),this._allowApplyOnceComponentsReady=this._allowApplyOnceComponentsReady.bind(this),this._allowApply=!1,this.el.sceneEl.addEventListener("stateadded",this._applyState),this.el.sceneEl.addEventListener("stateremoved",this._applyState),this.el.addEventListener("grab-end",this._fireEvents),this.el.addEventListener("pager-page-changed",this._fireEvents),this.el.addEventListener("owned-video-state-changed",this._fireEvents),this.el.addEventListener("componentinitialized",this._allowApplyOnceComponentsReady),this._allowApplyOnceComponentsReady()},remove(){this.el.sceneEl.removeEventListener("stateadded",this._applyState),this.el.sceneEl.removeEventListener("stateremoved",this._applyState),this.el.removeEventListener("componentinitialized",this._allowApplyOnceComponentsReady)},update(){this._applyState(),this._fireEvents()},_fireEvents(){if(!this.el.components.networked.data||NAF.utils.isMine(this.el))if(this.data.pinned){this.el.emit("pinned",{el:this.el}),this.el.removeAttribute("animation__pin-start"),this.el.removeAttribute("animation__pin-end");const e=this.el.object3D.scale;this.el.setAttribute("animation__pin-start",{property:"scale",dur:200,from:{x:e.x,y:e.y,z:e.z},to:{x:1.1*e.x,y:1.1*e.y,z:1.1*e.z},easing:"easeOutElastic"}),this.el.setAttribute("animation__pin-end",{property:"scale",delay:200,dur:200,from:{x:1.1*e.x,y:1.1*e.y,z:1.1*e.z},to:{x:e.x,y:e.y,z:e.z},easing:"easeOutElastic"})}else this.el.emit("unpinned",{el:this.el})},_allowApplyOnceComponentsReady(){!this._allowApply&&this.el.components.grabbable&&this.el.components.stretchable&&(this._allowApply=!0,this._applyState())},_applyState(){if(!this._allowApply)return;const e=this.el.sceneEl.is("frozen");this.data.pinned&&!e?(this.el.components.stretchable&&this.el.removeAttribute("stretchable"),this.el.setAttribute("body",{type:"static"}),0!==this.el.components.grabbable.data.maxGrabbers&&(this.prevMaxGrabbers=this.el.components.grabbable.data.maxGrabbers),this.el.setAttribute("grabbable",{maxGrabbers:0})):(this.el.setAttribute("grabbable",{maxGrabbers:this.prevMaxGrabbers}),this.el.components.stretchable||this.el.setAttribute("stretchable",""))}})},function(e,t,s){"use strict";var i=s(9);AFRAME.registerComponent("pin-networked-object-button",{schema:{labelSelector:{type:"string"},hideWhenPinnedSelector:{type:"string"}},init(){this._updateUI=this._updateUI.bind(this),this._updateUIOnStateChange=this._updateUIOnStateChange.bind(this),this.el.sceneEl.addEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.addEventListener("stateremoved",this._updateUIOnStateChange),this.labelEl=this.el.parentNode.querySelector(this.data.labelSelector),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this._updateUI(),this.targetEl.addEventListener("pinned",this._updateUI),this.targetEl.addEventListener("unpinned",this._updateUI)}),this.onClick=(()=>{if(!NAF.utils.isMine(this.targetEl)&&!NAF.utils.takeOwnership(this.targetEl))return;const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned;this.targetEl.setAttribute("pinnable","pinned",!e)})},play(){this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("grab-start",this.onClick)},remove(){this.el.sceneEl.removeEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.removeEventListener("stateremoved",this._updateUIOnStateChange),this.targetEl&&(this.targetEl.removeEventListener("pinned",this._updateUI),this.targetEl.removeEventListener("unpinned",this._updateUI))},_updateUIOnStateChange(e){"frozen"===e.detail&&this._updateUI()},_updateUI(){const{fileIsOwned:e,fileId:t}=this.targetEl.components["media-loader"].data,s=!!(e||t&&(0,i.getPromotionTokenForFile)(t));if(this.el.setAttribute("visible",s),this.labelEl.setAttribute("visible",s),!s)return;const a=this.targetEl.getAttribute("pinnable")&&this.targetEl.getAttribute("pinnable").pinned;this.labelEl.setAttribute("text","value",a?"un-pin":"pin"),this.el.setAttribute("text-button","backgroundColor",a?"#fff":"#ff0520"),this.el.setAttribute("text-button","backgroundHoverColor",a?"#aaa":"#cc0515"),this.el.parentNode.querySelectorAll(this.data.hideWhenPinnedSelector).forEach(e=>{e.setAttribute("visible",!a)})}})},function(e,t,s){"use strict";AFRAME.registerComponent("remove-networked-object-button",{init(){this.onClick=(()=>{(NAF.utils.isMine(this.targetEl)||NAF.utils.takeOwnership(this.targetEl))&&(this.targetEl.setAttribute("animation__remove",{property:"scale",dur:200,to:{x:.01,y:.01,z:.01},easing:"easeInQuad"}),this.el.parentNode.removeAttribute("visibility-while-frozen"),this.el.parentNode.setAttribute("visible",!1),this.targetEl.addEventListener("animationcomplete",()=>{this.targetEl.parentNode.removeChild(this.targetEl)}))}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e})},play(){this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("grab-start",this.onClick)}})},function(e,t,s){"use strict";AFRAME.registerComponent("camera-focus-button",{schema:{track:{default:!1}},init(){this.cameraSystem=this.el.sceneEl.systems["camera-tools"],NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e}),this.onClick=(()=>{const e=this.cameraSystem.getMyCamera();e&&e.components["camera-tool"].focus(this.targetEl,this.data.track)})},tick(){const e=this.el.getAttribute("visible"),t=!(!this.cameraSystem||!this.cameraSystem.getMyCamera());e!==t&&this.el.setAttribute("visible",t)},play(){this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("grab-start",this.onClick)}})},function(e,t,s){"use strict";AFRAME.registerComponent("mirror-camera-button",{schema:{labelSelector:{type:"string"}},init(){this._updateUI=this._updateUI.bind(this),this._isMirrored=this._isMirrored.bind(this),this.labelEl=this.el.parentNode.querySelector(this.data.labelSelector),this.onClick=(()=>{this._isMirrored()?this.targetEl.components["camera-tool"].unmirror():this.targetEl.components["camera-tool"].mirror()}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("mirrored",this._updateUI),this.targetEl.addEventListener("unmirrored",this._updateUI),this._updateUI()})},play(){this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("grab-start",this.onClick)},_isMirrored(){return this.targetEl===this.el.sceneEl.systems["camera-mirror"].getMirroredCameraEl()},_updateUI(){const e=this._isMirrored();this.labelEl.setAttribute("text","value",e?"unmirror":"mirror"),this.el.setAttribute("text-button","backgroundColor",e?"#fff":"#ff0520"),this.el.setAttribute("text-button","backgroundHoverColor",e?"#aaa":"#cc0515")}})},function(e,t,s){"use strict";var i=s(36);AFRAME.registerComponent("unmute-video-button",{init(){this.onClick=(()=>{const e=(0,i.findAncestorWithComponent)(this.el,"media-video"),t=e.components["media-video"];t&&t.video&&(t.video.muted=!1,this.el.parentNode.setAttribute("visible",!1))})},play(){document.addEventListener("touchstart",this.onClick)},pause(){document.removeEventListener("touchstart",this.onClick)}})},function(e,t,s){"use strict";var i=s(13);AFRAME.registerComponent("destroy-at-extreme-distances",{schema:{xMin:{default:-1e3},xMax:{default:1e3},yMin:{default:-1e3},yMax:{default:1e3},zMin:{default:-1e3},zMax:{default:1e3}},init(){this._checkForDestroy=this._checkForDestroy.bind(this),this.el.sceneEl.systems["frame-scheduler"].schedule(this._checkForDestroy,"media-components")},remove(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._checkForDestroy,"media-components")},_checkForDestroy:function(){const e=new THREE.Vector3;return function(){const{xMin:t,xMax:s,yMin:a,yMax:n,zMin:o,zMax:r}=this.data;(0,i.getLastWorldPosition)(this.el.object3D,e),(e.x<t||e.x>s||e.y<a||e.y>n||e.z<o||e.z>r)&&this.el.parentNode.removeChild(this.el)}}()})},function(e,t,s){"use strict";AFRAME.registerComponent("visible-to-owner",{init(){this.onStateChange=(e=>{this.el.setAttribute("visible",e.detail.newOwner===NAF.clientId)}),NAF.utils.getNetworkedEntity(this.el).then(e=>{e.addEventListener("ownership-changed",this.onStateChange),this.el.setAttribute("visible",NAF.utils.isMine(e))})}})},function(e,t,s){"use strict";var i,a=s(9),n=s(19),o=s(3),r=s(336),l=(i=r,i&&i.__esModule?i:{default:i});const c=new Promise(e=>(new THREE.GLTFLoader).load(l.default,e)),d={"player-right-controller":{takeSnapshot:o.paths.actions.rightHand.takeSnapshot},"player-left-controller":{takeSnapshot:o.paths.actions.leftHand.takeSnapshot},cursor:{takeSnapshot:o.paths.actions.cursor.takeSnapshot}},u=document.createElement("canvas");AFRAME.registerComponent("camera-tool",{schema:{previewFPS:{default:6},imageWidth:{default:1024},imageHeight:{default:576}},init(){this.stateAdded=this.stateAdded.bind(this),this.lastUpdate=performance.now(),this.renderTarget=new THREE.WebGLRenderTarget(this.data.imageWidth,this.data.imageHeight,{format:THREE.RGBAFormat,minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,encoding:THREE.sRGBEncoding,depth:!1,stencil:!1}),this.camera=new THREE.PerspectiveCamera(50,this.renderTarget.width/this.renderTarget.height,.1,3e4),this.camera.rotation.set(0,Math.PI,0),this.el.setObject3D("camera",this.camera);const e=new THREE.MeshBasicMaterial({map:this.renderTarget.texture});e.map.isVideoTexture=!0,e.map.update=(()=>{performance.now()-this.lastUpdate>=1e3/this.data.previewFPS&&(this.updateRenderTargetNextTick=!0)}),c.then(t=>{const s=t.scene.clone();s.scale.set(2,2,2),s.matrixNeedsUpdate=!0,this.el.setObject3D("mesh",s);const i=new THREE.PlaneGeometry(.28,.28/this.camera.aspect),a=new THREE.Mesh(i,e);a.rotation.set(0,Math.PI,0),a.position.set(0,0,-.042),a.matrixNeedsUpdate=!0,this.el.setObject3D("screen",a);const n=new THREE.Mesh(i,e);n.position.set(0,.4,0),n.scale.set(-2,2,2),n.matrixNeedsUpdate=!0,this.el.setObject3D("selfieScreen",n),this.cameraSystem=this.el.sceneEl.systems["camera-tools"],this.cameraSystem.register(this.el),this.updateRenderTargetNextTick=!0})},play(){this.el.addEventListener("stateadded",this.stateAdded)},pause(){this.el.removeEventListener("stateadded",this.stateAdded)},remove(){this.cameraSystem.deregister(this.el),this.el.sceneEl.systems["camera-mirror"].unmirrorCameraAtEl(this.el)},stateAdded(e){"activated"===e.detail&&(this.takeSnapshotNextTick=!0)},focus(e,t){this.trackTarget=t?e:null,this.lookAt(e)},lookAt:function(){const e=new THREE.Vector3;return function(t){e.setFromMatrixPosition(t.object3D.matrixWorld),this.el.object3D.lookAt(e),this.el.object3D.matrixNeedsUpdate=!0}}(),mirror(){this.el.sceneEl.systems["camera-mirror"].mirrorCameraAtEl(this.el)},unmirror(){this.el.sceneEl.systems["camera-mirror"].unmirrorCameraAtEl(this.el)},tick(){const e=this.el.components.grabbable.grabbers[0];if(e&&d[e.id]){const t=d[e.id];AFRAME.scenes[0].systems.userinput.get(t.takeSnapshot)&&(this.takeSnapshotNextTick=!0)}},tock:function(){const e=new THREE.Vector3;return function(){const t=this.el.sceneEl,s=this.renderer||t.renderer,i=performance.now();if(this.trackTarget&&(this.trackTarget.parentNode?this.lookAt(this.trackTarget):this.trackTarget=null),!this.playerHead){const e=document.getElementById("player-head");this.playerHead=e&&e.object3D}if(!this.playerHud){const e=document.getElementById("player-hud");this.playerHud=e&&e.object3D}if(this.takeSnapshotNextTick||this.updateRenderTargetNextTick){this.playerHead&&(e.copy(this.playerHead.scale),this.playerHead.scale.set(1,1,1),this.playerHead.updateMatrices(!0,!0),this.playerHead.updateMatrixWorld(!0,!0)),this.playerHud&&(this.playerHud.visible=!1);const a=s.vr.enabled,n=t.object3D.onAfterRender;delete t.object3D.onAfterRender,s.vr.enabled=!1,s.render(t.object3D,this.camera,this.renderTarget,!0),s.vr.enabled=a,t.object3D.onAfterRender=n,this.playerHead&&(this.playerHead.scale.copy(e),this.playerHead.updateMatrices(!0,!0),this.playerHead.updateMatrixWorld(!0,!0)),this.playerHud&&(this.playerHud.visible=!0),this.lastUpdate=i,this.updateRenderTargetNextTick=!1}if(this.takeSnapshotNextTick){const e=this.renderTarget.width,i=this.renderTarget.height;this.snapPixels||(this.snapPixels=new Uint8Array(e*i*4)),s.readRenderTargetPixels(this.renderTarget,0,0,e,i,this.snapPixels),async function(e,t,s){u.width=t,u.height=s;const i=u.getContext("2d"),a=i.createImageData(t,s);a.data.set(e);const n=await createImageBitmap(a);i.scale(1,-1),i.drawImage(n,0,-s);const o=await new Promise(e=>u.toBlob(e));return new File([o],"snap.png",{type:"image/png"})}(this.snapPixels,e,i).then(e=>{const{entity:s,orientation:i}=(0,a.addMedia)(e,"#interactable-media",void 0,!0);s.object3D.position.copy(this.el.object3D.position).add(new THREE.Vector3(0,-.5,0)),s.object3D.rotation.copy(this.el.object3D.rotation),s.object3D.matrixNeedsUpdate=!0,s.addEventListener("media_resolved",()=>{this.el.emit("photo_taken",s.components["media-loader"].data.src)},{once:!0}),i.then(()=>{t.emit("object_spawned",{objectType:n.ObjectTypes.CAMERA})})}),t.emit("camera_tool_took_snapshot"),this.takeSnapshotNextTick=!1}}}()})},function(e,t,s){e.exports=s.p+"assets/camera_tool-a25d0894a6b635779bd4ed41f2de0411.glb"},function(e,t,s){"use strict";AFRAME.registerComponent("emit-state-change",{multiple:!0,schema:{state:{type:"string"},transform:{type:"string",oneof:["rising","falling"]},event:{type:"string"}},init(){this.stateadded=this.stateadded.bind(this),this.stateremoved=this.stateremoved.bind(this)},stateadded(e){e.detail===this.data.state&&this.el.emit(this.data.event)},stateremoved(e){e.detail===this.data.state&&this.el.emit(this.data.event)},update(){this.el.removeEventListener("stateadded",this.stateadded),this.el.removeEventListener("stateremoved",this.stateremoved),"rising"===this.data.transform&&this.el.addEventListener("stateadded",this.stateadded),"falling"===this.data.transform&&this.el.addEventListener("stateremoved",this.stateremoved)}})},function(e,t,s){"use strict";AFRAME.registerComponent("action-to-event",{multiple:!0,schema:{path:{type:"string"},event:{type:"string"}},tick(){const e=AFRAME.scenes[0].systems.userinput;e.get(this.data.path)&&this.el.emit(this.data.event)}})},function(e,t,s){"use strict";AFRAME.registerComponent("emit-scene-event-on-remove",{schema:{event:{default:null}},remove(){this.data.event&&this.el.sceneEl.emit(this.data.event,{el:this.el})}})},function(e,t,s){"use strict";const i=e=>{e.stopPropagation()};AFRAME.registerComponent("stop-event-propagation",{multiple:!0,schema:{event:{type:"string"}},play(){this.el.addEventListener(this.data.event,i)},pause(){this.el.removeEventListener(this.data.event,i)}})},function(e,t,s){"use strict";const i=s(342),a=AFRAME.components,n=AFRAME.registerComponent,o=AFRAME.utils,r=new THREE.Color,l=new THREE.Color,c=o.entity.getComponentProperty,d=o.entity.setComponentProperty,u={},h="color",p="components",m="object3D";function f(e){e.x=THREE.Math.degToRad(e.x),e.y=THREE.Math.degToRad(e.y),e.z=THREE.Math.degToRad(e.z)}function g(e,t,s){let i;for(i=0;i<t.length;i++)e.addEventListener(t[i],s)}function v(e,t,s){let i;for(i=0;i<t.length;i++)e.removeEventListener(t[i],s)}function b(e){return e in u?u[e]:(u[e]=e.split("."),u[e])}function y(e,t){let s,i;const a=b(t);for(i=e,s=0;s<a.length;s++)i=i[a[s]];return i}function _(e,t,s,i){let a;t.startsWith("object3D.rotation")&&(s=THREE.Math.degToRad(s));const n=b(t);let o=e;for(a=0;a<n.length-1;a++)o=o[n[a]];const r=n[n.length-1];i!==h?o[r]=s:"r"in o[r]?(o[r].r=s.r,o[r].g=s.g,o[r].b=s.b):(o[r].x=s.r,o[r].y=s.g,o[r].z=s.b)}function E(e){return e.isRawProperty||e.property.startsWith(p)||e.property.startsWith(m)}e.exports.Component=n("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(e){return!0===e||"true"===e||!1!==e&&"false"!==e&&parseInt(e,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){const e=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){e.animationIsPlaying=!1,e.el.emit("animationcomplete",e.eventDetail,!1),e.id&&e.el.emit("animationcomplete__"+e.id,e.eventDetail,!1)}}},update:function(e){const t=this.config,s=this.data;this.animationIsPlaying=!1,e.enabled&&!this.data.enabled||s.property&&(t.autoplay=!1,t.direction=s.dir,t.duration=s.dur,t.easing=s.easing,t.elasticity=s.elasticity,t.loop=s.loop,t.round=s.round,this.createAndStartAnimation())},tick:function(e,t){this.animationIsPlaying&&(this.time+=t,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=!0,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){const e=this.data;this.updateConfig(),this.animationIsPlaying=!1,this.animation=i(this.config),this.removeEventListeners(),this.addEventListeners(),!e.autoplay||e.startEvents&&e.startEvents.length||(e.delay?setTimeout(this.beginAnimation,e.delay):this.beginAnimation())},beginAnimation:function(){this.updateConfig(),this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){this.data.enabled&&(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=i(this.config),this.data.delay?setTimeout(this.beginAnimation,this.data.delay):this.beginAnimation())},updateConfigForRawColor:function(){const e=this.config,t=this.data,s=this.el;let i,a,n;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){for(a in i=""===t.from?y(s,t.property):t.from,n=t.to,this.setColorConfig(i,n),i=this.fromColor,n=this.toColor,this.targetsArray.length=0,this.targetsArray.push(i),e.targets=this.targetsArray,n)e[a]=n[a];e.update=function(){const e={};return function(i){const a=i.animatables[0].target;a.r===e.r&&a.g===e.g&&a.b===e.b||_(s,t.property,a,t.type)}}()}},updateConfigForDefault:function(){const e=this.config,t=this.data,s=this.el;let i,a;if(this.waitComponentInitRawProperty(this.updateConfigForDefault))return;i=""===t.from?E(t)?y(s,t.property):c(s,t.property):t.from,a=t.to;const n=!isNaN(i||a);n?(i=parseFloat(i),a=parseFloat(a)):(i=i?i.toString():i,a=a?a.toString():a);const o="true"===t.to||"false"===t.to||!0===t.to||!1===t.to;o&&(i="true"===t.from||!0===t.from?1:0,a="true"===t.to||!0===t.to?1:0),this.targets.aframeProperty=i,e.targets=this.targets,e.aframeProperty=a,e.update=function(){let e;return function(i){let a;a=i.animatables[0].target.aframeProperty,a!==e&&(e=a,o&&(a=a>=1),E(t)?_(s,t.property,a,t.type):d(s,t.property,a))}}()},updateConfigForVector:function(){const e=this.config,t=this.data,s=this.el;let i;const a=""!==t.from?o.coordinates.parse(t.from):c(s,t.property),n=o.coordinates.parse(t.to);for(i in"rotation"===t.property&&(f(a),f(n)),this.targetsArray.length=0,this.targetsArray.push(a),e.targets=this.targetsArray,n)e[i]=n[i];"position"!==t.property&&"rotation"!==t.property&&"scale"!==t.property?e.update=function(){const e={};return function(i){const a=i.animations[0].target;a.x===e.x&&a.y===e.y&&a.z===e.z||(e.x=a.x,e.y=a.y,e.z=a.z,d(s,t.property,a))}}():e.update=function(){const e={};return function(i){const a=i.animatables[0].target;"scale"===t.property&&(a.x=Math.max(1e-4,a.x),a.y=Math.max(1e-4,a.y),a.z=Math.max(1e-4,a.z)),a.x===e.x&&a.y===e.y&&a.z===e.z||(e.x=a.x,e.y=a.y,e.z=a.z,s.object3D[t.property].set(a.x,a.y,a.z),s.object3D.matrixNeedsUpdate=!0)}}()},updateConfig:function(){const e=function(e,t){const s=t.split("."),i=s[0],n=s[1],o=e.components[i]||a[i];return o?n&&!o.schema[n]?null:n?o.schema[n].type:o.schema.type:null}(this.el,this.data.property);E(this.data)&&this.data.type===h?this.updateConfigForRawColor():"vec2"===e||"vec3"===e||"vec4"===e?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(e){const t=this.data,s=this.el,a=this;if(""!==t.from)return!1;if(!t.property.startsWith(p))return!1;const n=b(t.property)[1];return!s.components[n]&&(s.addEventListener("componentinitialized",function t(o){o.detail.name===n&&(e(),a.animation=i(a.config),s.removeEventListener("componentinitialized",t))}),!0)},stopRelatedAnimations:function(){let e,t;for(t in this.el.components)e=this.el.components[t],t!==this.attrName&&"animation"===e.name&&e.animationIsPlaying&&e.data.property===this.data.property&&(e.animationIsPlaying=!1)},addEventListeners:function(){const e=this.data,t=this.el;g(t,e.startEvents,this.onStartEvent),g(t,e.pauseEvents,this.pauseAnimation),g(t,e.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){const e=this.data,t=this.el;v(t,e.startEvents,this.onStartEvent),v(t,e.pauseEvents,this.pauseAnimation),v(t,e.resumeEvents,this.resumeAnimation)},setColorConfig:function(e,t){r.set(e),l.set(t),e=this.fromColor,t=this.toColor,e.r=r.r,e.g=r.g,e.b=r.b,t.r=l.r,t.g=l.g,t.b=l.b}})},,function(e,t,s){"use strict";AFRAME.registerComponent("follow-in-lower-fov",{schema:{target:{type:"selector"},offset:{type:"vec3"},speed:{type:"number",default:.003}},init(){this.targetPos=new THREE.Vector3,this.offset=new THREE.Vector3,this.offset.copy(this.data.offset),this.snappedRot=new THREE.Euler,this.snappedQ=new THREE.Quaternion,this.snappedXForm=new THREE.Matrix4,this.snappedXFormWorld=new THREE.Matrix4,this.tempVector=new THREE.Vector3},tick(e,t){const s=this.el.object3D,i=this.data.target.object3D;if(this._applyMaskedTargetRotation(-Math.PI/4,i.rotation.y,0,this.snappedXFormWorld),this.targetPos.copy(this.offset),this.targetPos.applyMatrix4(this.snappedXFormWorld),s.parent&&s.parent.worldToLocal(this.targetPos),this.started){const e=this.data.speed*t;s.position.set(s.position.x+(this.targetPos.x-s.position.x)*e,s.position.y+(this.targetPos.y-s.position.y)*e,s.position.z+(this.targetPos.z-s.position.z)*e)}else s.position.copy(this.targetPos),this.started=!0;this.snappedXFormWorld.decompose(this.tempVector,s.quaternion,this.tempVector),s.matrixNeedsUpdate=!0},_applyMaskedTargetRotation(e,t,s,i){const a=this.data.target.object3D;this.snappedRot.set(e,t,s,a.rotation.order),this.snappedQ.setFromEuler(this.snappedRot),this.snappedXForm.compose(a.position,this.snappedQ,a.scale),i.multiplyMatrices(a.parent.matrixWorld,this.snappedXForm)}})},function(e,t,s){"use strict";AFRAME.registerComponent("matrix-auto-update",{schema:{target:{type:"string"}},init:function(){this._updateMatrixAutoUpdate=this._updateMatrixAutoUpdate.bind(this),this._updateMatrixAutoUpdate()},play:function(){this.el.sceneEl.addEventListener("object3dset",this._updateMatrixAutoUpdate)},pause:function(){this.el.sceneEl.removeEventListener("object3dset",this._updateMatrixAutoUpdate)},_updateMatrixAutoUpdate:function(){this.data.target?this.el.getObject3D(this.data.target).matrixAutoUpdate=!0:this.el.object3D.matrixAutoUpdate=!0}})},function(e,t,s){"use strict";var i=s(9),a=s(19);AFRAME.registerComponent("clone-media-button",{init(){NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e}),this.onClick=(()=>{const{src:e,resize:t}=this.targetEl.components["media-loader"].data,{entity:s}=(0,i.addMedia)(e,"#interactable-media",a.ObjectContentOrigins.URL,!0,t);s.object3D.matrixNeedsUpdate=!0,s.setAttribute("offset-relative-to",{target:"#player-camera",offset:{x:0,y:0,z:-1.5}})})},play(){this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("grab-start",this.onClick)}})},function(e,t,s){"use strict";const i=/https?:\/\/(hubs.local(:\d+)?|(smoke-)?hubs.mozilla.com)\/(\w+)\/?\S*/,a=i.test.bind(i);AFRAME.registerComponent("open-media-button",{init(){this.label=this.el.querySelector("[text]"),this.updateSrc=(()=>{this.src=this.targetEl.components["media-loader"].data.src,this.label.setAttribute("text","value",a(this.src)?"visit":"open link")}),this.onClick=(()=>{const e=a(this.src);e?location.href=this.src:window.open(this.src)}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()})},play(){this.el.addEventListener("grab-start",this.onClick)},pause(){this.el.removeEventListener("grab-start",this.onClick)}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(348),n=lt(a),o=s(33),r=lt(o),l=s(349),c=lt(l),d=s(350),u=lt(d),h=s(351),p=lt(h),m=s(352),f=lt(m),g=s(353),v=lt(g),b=s(354),y=lt(b),_=s(355),E=lt(_),x=s(356),w=lt(x),S=s(357),k=lt(S),A=s(358),C=lt(A),M=s(359),R=lt(M),T=s(360),D=lt(T),H=s(361),P=lt(H),L=s(362),O=lt(L),I=s(363),N=lt(I),F=s(364),j=lt(F),B=s(365),V=lt(B),U=s(366),W=lt(U),z=s(367),G=lt(z),$=s(1),q=rt($),Y=s(0),X=rt(Y),J=s(11),Q=rt(J),K=s(129),Z=rt(K),ee=s(71),te=s(6),se=s(43),ie=rt(se),ae=s(369),ne=rt(ae),oe=s(161),re=rt(oe),le=s(629),ce=rt(le),de=s(631),ue=rt(de),he=s(5),pe=s(16),me=s(370),fe=rt(me),ge=s(371),ve=s(377),be=rt(ve),ye=s(385),_e=rt(ye),Ee=s(389),xe=rt(Ee),we=s(390),Se=rt(we),ke=s(391),Ae=rt(ke),Ce=s(392),Me=rt(Ce),Re=s(394),Te=rt(Re),De=s(395),He=rt(De),Pe=s(396),Le=rt(Pe),Oe=s(397),Ie=rt(Oe),Ne=s(398),Fe=rt(Ne),je=s(399),Be=rt(je),Ve=s(413),Ue=rt(Ve),We=s(418),ze=rt(We),Ge=s(419),$e=rt(Ge),qe=s(84),Ye=s(420),Xe=s(56),Je=s(421),Qe=s(422),Ke=s(423),Ze=s(424),et=rt(Ze),tt=s(425),st=rt(tt),it=s(426),at=rt(it),nt=s(427),ot=rt(nt);function rt(e){return e&&e.__esModule?e:{default:e}}function lt(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}(0,te.addLocaleData)([...ie.default]);const ct={start:"start",device:"device",mic_grant:"mic_grant",mic_granted:"mic_granted",audio_setup:"audio_setup",finished:"finished"},dt=[/\Wvive\W/i,/\Wrift\W/i];const ut=document.createElement("audio");ut.canPlayType("audio/webm")?ut.src=et.default:ut.canPlayType("audio/mpeg")?ut.src=st.default:ut.canPlayType("audio/ogg")?ut.src=at.default:ut.src=ot.default;class ht extends $.Component{constructor(e){super(e),pt.call(this),e.showSafariMicDialog&&(this.state.dialog=q.default.createElement(He.default,{closable:!1}))}componentDidUpdate(e){const{hubChannel:t,showSignInDialog:s}=this.props;if(t){const{signedIn:e}=t;e!==this.state.signedIn&&this.setState({signedIn:e})}e.showSignInDialog!==s&&s&&this.showContextualSignInDialog()}componentDidMount(){this.props.concurrentLoadDetector.addEventListener("concurrentload",this.onConcurrentLoad),this.micLevelMovingAverage=(0,ne.default)(100),this.props.scene.addEventListener("loaded",this.onSceneLoaded),this.props.scene.addEventListener("stateadded",this.onAframeStateChanged),this.props.scene.addEventListener("stateremoved",this.onAframeStateChanged),this.props.scene.addEventListener("share_video_enabled",this.onShareVideoEnabled),this.props.scene.addEventListener("share_video_disabled",this.onShareVideoDisabled),this.props.scene.addEventListener("exit",this.exit);const e=this.props.scene;this.setState({audioContext:{playSound:t=>{e.emit(t)},onMouseLeave:()=>{}}})}componentWillUnmount(){this.props.scene.removeEventListener("loaded",this.onSceneLoaded),this.props.scene.removeEventListener("exit",this.exit),this.props.scene.removeEventListener("share_video_enabled",this.onShareVideoEnabled),this.props.scene.removeEventListener("share_video_disabled",this.onShareVideoDisabled)}render(){const e=this.state.exited||this.props.roomUnavailableReason||this.props.platformUnsupportedReason,t=!(this.props.showSafariMicDialog||this.props.environmentSceneLoaded&&this.props.availableVREntryTypes&&this.props.hubId);if(e)return this.renderExitedPane();if(t)return this.renderLoader();if(this.props.isBotMode)return this.renderBotMode();const s=this.state.entryStep===ct.start&&this.renderEntryStartPanel(),i=this.state.entryStep===ct.device&&this.renderDevicePanel(),a=(this.state.entryStep===ct.mic_grant||this.state.entryStep===ct.mic_granted)&&this.renderMicPanel(),n=this.state.entryStep===ct.audio_setup&&this.renderAudioSetupPanel();let o=null;o=this.state.entryPanelCollapsed&&!this.isWaitingForAutoExit()?q.default.createElement("div",{className:ue.default.entryDialog},q.default.createElement("div",null,"Â "),q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{onClick:()=>this.setState({entryPanelCollapsed:!1}),className:ue.default.expand},q.default.createElement("i",null,q.default.createElement(Xe.FontAwesomeIcon,{icon:Ke.faChevronUp}))))):this.isWaitingForAutoExit()?q.default.createElement(fe.default,{secondsRemaining:this.state.secondsRemainingBeforeAutoExit,onCancel:this.endAutoExitTimer}):q.default.createElement("div",{className:ue.default.entryDialog},!this.state.entryPanelCollapsed&&q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{onClick:()=>this.setState({entryPanelCollapsed:!0}),className:ue.default.collapse},q.default.createElement("i",null,q.default.createElement(Xe.FontAwesomeIcon,{icon:Qe.faChevronDown})))),s,i,a,n);const r=(0,Q.default)({[ce.default.uiInteractive]:!this.state.dialog,[ce.default.uiDialogBoxContents]:!0,[ce.default.backgrounded]:this.state.showProfileEntry}),l=this.state.entryStep===ct.finished,c=l&&this.props.availableVREntryTypes.isInHMD,d=this.state.pendingMessage.split("\n").length,u=28*d+"px",h=28*d+20+"px";return q.default.createElement(he.ReactAudioContext.Provider,{value:this.state.audioContext},q.default.createElement(te.IntlProvider,{locale:pe.lang,messages:pe.messages},q.default.createElement("div",{className:ce.default.ui},this.state.dialog,this.state.showProfileEntry&&q.default.createElement(be.default,{finished:this.onProfileFinished,store:this.props.store}),(!l||this.isWaitingForAutoExit())&&q.default.createElement("div",{className:ce.default.uiDialog},q.default.createElement(Be.default,{entries:this.props.presenceLogEntries||[],hubId:this.props.hubId}),q.default.createElement("div",{className:r},o)),l&&q.default.createElement(Be.default,{inRoom:!0,entries:this.props.presenceLogEntries||[],hubId:this.props.hubId}),l&&q.default.createElement("form",{onSubmit:this.sendMessage},q.default.createElement("div",{className:ce.default.messageEntryInRoom,style:{height:h}},this.state.pendingMessage.startsWith("/")&&q.default.createElement($e.default,{matchingPrefix:this.state.pendingMessage.substring(1)}),q.default.createElement("textarea",{style:{height:u},className:(0,Q.default)([ce.default.messageEntryInput,ce.default.messageEntryInputInRoom,"chat-focus-target"]),value:this.state.pendingMessage,rows:d,onFocus:e=>e.target.select(),onChange:e=>{e.stopPropagation(),this.setState({pendingMessage:e.target.value})},onKeyDown:e=>{13!==e.keyCode||e.shiftKey?13===e.keyCode&&e.shiftKey&&e.ctrlKey?((0,qe.spawnChatMessage)(e.target.value),this.setState({pendingMessage:""})):27===e.keyCode&&e.target.blur():this.sendMessage(e)},placeholder:"Send a message..."}),q.default.createElement("input",{className:(0,Q.default)([ce.default.messageEntrySubmit,ce.default.messageEntrySubmitInRoom]),type:"submit",value:"send"}),q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{className:(0,Q.default)([ce.default.messageEntrySpawn]),onClick:()=>{this.state.pendingMessage.length>0?((0,qe.spawnChatMessage)(this.state.pendingMessage),this.setState({pendingMessage:""})):this.showCreateObjectDialog()}})))),q.default.createElement("div",{className:(0,Q.default)({[ce.default.inviteContainer]:!0,[ce.default.inviteContainerBelowHud]:l,[ce.default.inviteContainerInverted]:this.state.showInviteDialog})},!c&&!this.state.videoShareMediaSource&&q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{className:(0,Q.default)({[ce.default.hideSmallScreens]:this.occupantCount()>1&&l}),onClick:()=>this.toggleInviteDialog()},q.default.createElement(te.FormattedMessage,{id:"entry.invite-others-nag"}))),!c&&this.occupantCount()>1&&!this.state.videoShareMediaSource&&l&&q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{onClick:this.onMiniInviteClicked,className:ce.default.inviteMiniButton},q.default.createElement("span",null,this.state.miniInviteActivated?navigator.share?"sharing...":"copied!":"hub.link/"+this.props.hubId))),c&&q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{onClick:()=>this.props.scene.enterVR()},q.default.createElement(te.FormattedMessage,{id:"entry.enter-in-vr"}))),this.state.showInviteDialog&&q.default.createElement(Se.default,{allowShare:!this.props.availableVREntryTypes.isInHMD,entryCode:this.props.hubEntryCode,hubId:this.props.hubId,onClose:()=>this.setState({showInviteDialog:!1})})),this.state.showLinkDialog&&q.default.createElement(Me.default,{linkCode:this.state.linkCode,onClose:()=>{this.state.linkCodeCancel(),this.setState({showLinkDialog:!1,linkCode:null,linkCodeCancel:null})}}),q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{onClick:()=>this.showHelpDialog(),className:(0,Q.default)([ce.default.helpIcon,"help-button"])},q.default.createElement("i",null,q.default.createElement(Xe.FontAwesomeIcon,{icon:Je.faQuestion})))),q.default.createElement("div",{onClick:()=>this.setState({showPresenceList:!this.state.showPresenceList}),className:(0,Q.default)({[ce.default.presenceInfo]:!0,[ce.default.presenceInfoSelected]:this.state.showPresenceList})},q.default.createElement(Xe.FontAwesomeIcon,{icon:Ye.faUsers}),q.default.createElement("span",{className:ce.default.occupantCount},this.occupantCount())),this.state.showPresenceList&&q.default.createElement(Ue.default,{presences:this.props.presences,sessionId:this.props.sessionId,signedIn:this.state.signedIn,email:this.props.store.state.credentials.email,onSignIn:this.showSignInDialog,onSignOut:this.signOut}),this.state.entryStep===ct.finished?q.default.createElement("div",null,q.default.createElement(ze.default.TopHUD,{muted:this.state.muted,frozen:this.state.frozen,spacebubble:this.state.spacebubble,videoShareMediaSource:this.state.videoShareMediaSource,onToggleMute:this.toggleMute,onToggleFreeze:this.toggleFreeze,onToggleSpaceBubble:this.toggleSpaceBubble,onSpawnPen:this.spawnPen,onSpawnCamera:()=>this.props.scene.emit("action_spawn_camera"),onShareVideo:this.shareVideo,onEndShareVideo:this.endShareVideo,onShareVideoNotCapable:()=>this.showWebRTCScreenshareUnsupportedDialog()}),this.props.isSupportAvailable&&q.default.createElement("div",{className:ce.default.nagCornerButton},q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{onClick:()=>this.showInviteTeamDialog()},q.default.createElement(te.FormattedMessage,{id:"entry.invite-team-nag"})))),!this.isWaitingForAutoExit()&&q.default.createElement(ze.default.BottomHUD,{onCreateObject:()=>this.showCreateObjectDialog(),showPhotoPicker:AFRAME.utils.device.isMobile(),onMediaPicked:this.createObject})):null)))}}ht.propTypes={enterScene:X.default.func,exitScene:X.default.func,onSendMessage:X.default.func,concurrentLoadDetector:X.default.object,disableAutoExitOnConcurrentLoad:X.default.bool,forcedVREntryType:X.default.string,isBotMode:X.default.bool,store:X.default.object,scene:X.default.object,authChannel:X.default.object,hubChannel:X.default.object,linkChannel:X.default.object,hubEntryCode:X.default.number,availableVREntryTypes:X.default.object,environmentSceneLoaded:X.default.bool,roomUnavailableReason:X.default.string,platformUnsupportedReason:X.default.string,hubId:X.default.string,hubName:X.default.string,isSupportAvailable:X.default.bool,presenceLogEntries:X.default.array,presences:X.default.object,sessionId:X.default.string,subscriptions:X.default.object,initialIsSubscribed:X.default.bool,showSignInDialog:X.default.bool,signInMessageId:X.default.string,signInCompleteMessageId:X.default.string,signInContinueTextId:X.default.string,onContinueAfterSignIn:X.default.func,showSafariMicDialog:X.default.bool};var pt=function(){this.state={entryStep:ct.start,enterInVR:!1,dialog:null,showInviteDialog:!1,showLinkDialog:!1,showPresenceList:!1,linkCode:null,linkCodeCancel:null,miniInviteActivated:!1,shareScreen:!1,requestedScreen:!1,mediaStream:null,audioTrack:null,entryPanelCollapsed:!1,toneInterval:null,tonePlaying:!1,micLevel:0,micDevices:[],micUpdateInterval:null,profileNamePending:"Hello",autoExitTimerStartedAt:null,autoExitTimerInterval:null,secondsRemainingBeforeAutoExit:1/0,muted:!1,frozen:!1,spacebubble:!0,exited:!1,showProfileEntry:!1,pendingMessage:"",signedIn:!1,videoShareMediaSource:null},this.showContextualSignInDialog=(()=>{const{signInMessageId:e,authChannel:t,signInCompleteMessageId:s,signInContinueTextId:i,onContinueAfterSignIn:a}=this.props,n=()=>{this.closeDialog(),a()};this.showDialog(Le.default,{message:pe.messages[e],onSignIn:async e=>{const{authComplete:a}=await t.startAuthentication(e,this.props.hubChannel);this.showDialog(Le.default,{authStarted:!0,onClose:n}),await a,this.setState({signedIn:!0}),this.showDialog(Le.default,{authComplete:!0,message:pe.messages[s],continueText:pe.messages[i],onClose:n,onContinue:n})},onClose:n})}),this.updateSubscribedState=(()=>{const e=this.props.subscriptions&&this.props.subscriptions.isSubscribed();this.setState({isSubscribed:e})}),this.onSceneLoaded=(()=>{this.setState({sceneLoaded:!0})}),this.onAframeStateChanged=(e=>{"muted"!==e.detail&&"frozen"!==e.detail&&"spacebubble"!==e.detail||this.setState({[e.detail]:this.props.scene.is(e.detail)})}),this.onShareVideoEnabled=(e=>{this.setState({videoShareMediaSource:e.detail.source})}),this.onShareVideoDisabled=(()=>{this.setState({videoShareMediaSource:null})}),this.toggleMute=(()=>{this.props.scene.emit("action_mute")}),this.toggleFreeze=(()=>{this.props.scene.emit("action_freeze")}),this.toggleSpaceBubble=(()=>{this.props.scene.emit("action_space_bubble")}),this.shareVideo=(e=>{this.props.scene.emit(`action_share_${e}`)}),this.endShareVideo=(()=>{this.props.scene.emit("action_end_video_sharing")}),this.spawnPen=(()=>{this.props.scene.emit("penButtonPressed")}),this.onSubscribeChanged=(async()=>{this.props.subscriptions&&(await this.props.subscriptions.toggle(),this.updateSubscribedState())}),this.handleStartEntry=(()=>{const e=!this.props.store.state.activity.hasChangedName;e&&this.setState({showProfileEntry:!0}),this.props.forcedVREntryType?this.props.forcedVREntryType.startsWith("daydream")?this.enterDaydream():this.props.forcedVREntryType.startsWith("vr")?this.enterVR():this.props.forcedVREntryType.startsWith("2d")&&this.enter2D():this.goToEntryStep(ct.device)}),this.goToEntryStep=(e=>{this.setState({entryStep:e,showInviteDialog:!1})}),this.playTestTone=(()=>{ut.currentTime=0,ut.play(),clearTimeout(this.testToneTimeout),this.setState({tonePlaying:!0});this.testToneTimeout=setTimeout(()=>{this.setState({tonePlaying:!1})},1393)}),this.stopTestTone=(()=>{ut.pause(),ut.currentTime=0,this.setState({tonePlaying:!1})}),this.onConcurrentLoad=(()=>{if(this.props.disableAutoExitOnConcurrentLoad)return;const e=setInterval(()=>{let e=1/0;if(this.state.autoExitTimerStartedAt){const t=(new Date-this.state.autoExitTimerStartedAt)/1e3;e=Math.max(0,Math.floor(10-t))}this.setState({secondsRemainingBeforeAutoExit:e}),this.checkForAutoExit()},500);this.setState({autoExitTimerStartedAt:new Date,autoExitTimerInterval:e})}),this.checkForAutoExit=(()=>{0===this.state.secondsRemainingBeforeAutoExit&&(this.endAutoExitTimer(),this.exit())}),this.exit=(()=>{this.props.exitScene(),this.setState({exited:!0})}),this.isWaitingForAutoExit=(()=>this.state.secondsRemainingBeforeAutoExit<=10),this.endAutoExitTimer=(()=>{clearInterval(this.state.autoExitTimerInterval),this.setState({autoExitTimerStartedAt:null,autoExitTimerInterval:null,secondsRemainingBeforeAutoExit:1/0})}),this.hasGrantedMicPermissions=(async()=>!this.state.requestedScreen&&(await async function(){const e=await navigator.mediaDevices.enumerateDevices();return e.filter(e=>e.label&&"audioinput"===e.kind).map(e=>e.label)}()).length>0),this.performDirectEntryFlow=(async e=>{this.setState({enterInVR:e});const t=await this.hasGrantedMicPermissions();t?(await this.setMediaStreamToDefault(),this.beginOrSkipAudioSetup()):this.goToEntryStep(ct.mic_grant)}),this.enter2D=(async()=>{await this.performDirectEntryFlow(!1)}),this.enterVR=(async()=>{this.props.availableVREntryTypes.generic!==ee.VR_DEVICE_AVAILABILITY.maybe?await this.performDirectEntryFlow(!0):this.showWebVRRecommendDialog()}),this.enterDaydream=(async()=>{await this.performDirectEntryFlow(!0)}),this.micDeviceChanged=(async e=>{const t={audio:{deviceId:{exact:[e.target.value]}}};await this.fetchAudioTrack(t),await this.setupNewMediaStream()}),this.setMediaStreamToDefault=(async()=>{let e=!1;const{lastUsedMicDeviceId:t}=this.props.store.state.settings;return e=t?await this.fetchAudioTrack({audio:{deviceId:{ideal:t}}}):await this.fetchAudioTrack({audio:!0}),await this.setupNewMediaStream(),{hasAudio:e}}),this.fetchAudioTrack=(async e=>{this.state.audioTrack&&this.state.audioTrack.stop();try{const t=await navigator.mediaDevices.getUserMedia(e);return this.setState({audioTrack:t.getAudioTracks()[0]}),!0}catch(e){return this.setState({audioTrack:null}),!1}}),this.setupNewMediaStream=(async()=>{const e=new MediaStream;if(await this.fetchMicDevices(),this.state.audioTrack){e.addTrack(this.state.audioTrack);const t=window.AudioContext||window.webkitAudioContext,s=new t,i=s.createMediaStreamSource(e),a=s.createAnalyser();a.fftSize=32;const n=new Uint8Array(a.frequencyBinCount);i.connect(a);const o=setInterval(()=>{a.getByteTimeDomainData(n);let e=0;for(let t=0;t<n.length;t++)e=Math.max(n[t]-128,e);const t=e/128;this.micLevelMovingAverage.push(Date.now(),6*t);const s=this.micLevelMovingAverage.movingAverage();this.setState(e=>{if(Math.abs(s-e.micLevel)>1e-4)return{micLevel:s}})},50),r=this.micDeviceIdForMicLabel(this.micLabelForMediaStream(e));r&&this.props.store.update({settings:{lastUsedMicDeviceId:r}}),this.setState({micLevelAudioContext:s,micUpdateInterval:o})}this.setState({mediaStream:e})}),this.onMicGrantButton=(async()=>{if(this.state.entryStep==ct.mic_grant){const{hasAudio:e}=await this.setMediaStreamToDefault();e?this.goToEntryStep(ct.mic_granted):this.beginOrSkipAudioSetup()}else this.beginOrSkipAudioSetup()}),this.onProfileFinished=(()=>{this.setState({showProfileEntry:!1}),this.props.hubChannel.sendProfileUpdate()}),this.beginOrSkipAudioSetup=(()=>{this.props.forcedVREntryType&&this.props.forcedVREntryType.endsWith("_now")?this.onAudioReadyButton():this.goToEntryStep(ct.audio_setup)}),this.fetchMicDevices=(()=>new Promise(e=>{navigator.mediaDevices.enumerateDevices().then(t=>{this.setState({micDevices:t.filter(e=>"audioinput"===e.kind).map(e=>({deviceId:e.deviceId,label:e.label}))},e)})})),this.shouldShowHmdMicWarning=(()=>!AFRAME.utils.device.isMobile()&&(!!this.state.enterInVR&&(!!this.hasHmdMicrophone()&&!dt.find(e=>this.selectedMicLabel().match(e))))),this.hasHmdMicrophone=(()=>!!this.state.micDevices.find(e=>dt.find(t=>e.label.match(t)))),this.micLabelForMediaStream=(e=>e&&e.getAudioTracks().length>0&&e.getAudioTracks()[0].label||""),this.selectedMicLabel=(()=>this.micLabelForMediaStream(this.state.mediaStream)),this.micDeviceIdForMicLabel=(e=>this.state.micDevices.filter(t=>t.label===e).map(e=>e.deviceId)[0]),this.selectedMicDeviceId=(()=>this.micDeviceIdForMicLabel(this.selectedMicLabel())),this.onAudioReadyButton=(()=>{AFRAME.utils.device.isMobile()&&!AFRAME.utils.device.isIOS()&&!this.state.enterInVR&&re.default.enabled&&re.default.request(),this.props.enterScene(this.state.mediaStream,this.state.enterInVR,this.props.hubId);const e=this.state.mediaStream;e&&(e.getAudioTracks().length>0&&console.log(`Using microphone: ${e.getAudioTracks()[0].label}`),e.getVideoTracks().length>0&&console.log("Screen sharing enabled.")),this.stopTestTone(),clearTimeout(this.testToneTimeout),this.state.micLevelAudioContext&&(this.state.micLevelAudioContext.close(),clearInterval(this.state.micUpdateInterval)),this.goToEntryStep(ct.finished)}),this.attemptLink=(async()=>{this.setState({showLinkDialog:!0});const{code:e,cancel:t,onFinished:s}=await this.props.linkChannel.generateCode();this.setState({linkCode:e,linkCodeCancel:t}),s.then(()=>this.setState({showLinkDialog:!1,linkCode:null,linkCodeCancel:null}))}),this.showInviteDialog=(()=>{this.setState({showInviteDialog:!0})}),this.toggleInviteDialog=(async()=>{this.setState({showInviteDialog:!this.state.showInviteDialog})}),this.createObject=(e=>{this.props.scene.emit("add_media",e)}),this.closeDialog=(()=>{this.setState({dialog:null})}),this.showDialog=((e,t={})=>{this.setState({dialog:q.default.createElement(e,i({onClose:this.closeDialog},t))})}),this.showHelpDialog=(()=>this.showDialog(xe.default)),this.showSafariDialog=(()=>this.showDialog(Te.default)),this.showInviteTeamDialog=(()=>this.showDialog(Ae.default,{hubChannel:this.props.hubChannel})),this.showCreateObjectDialog=(()=>this.showDialog(_e.default,{onCreate:this.createObject})),this.showWebVRRecommendDialog=(()=>this.showDialog(Fe.default)),this.showSignInDialog=(()=>{this.showDialog(Le.default,{message:pe.messages["sign-in.prompt"],onSignIn:async e=>{const{authComplete:t}=await this.props.authChannel.startAuthentication(e,this.props.hubChannel);this.showDialog(Le.default,{authStarted:!0}),await t,this.setState({signedIn:!0}),this.closeDialog()}})}),this.signOut=(async()=>{await this.props.authChannel.signOut(this.props.hubChannel),this.setState({signedIn:!1})}),this.showWebRTCScreenshareUnsupportedDialog=(()=>{this.setState({dialog:q.default.createElement(Ie.default,{onClose:this.closeDialog})})}),this.onMiniInviteClicked=(()=>{const e="https://hub.link/"+this.props.hubId;this.setState({miniInviteActivated:!0}),setTimeout(()=>{this.setState({miniInviteActivated:!1})},5e3),navigator.share?navigator.share({title:document.title,url:e}):(0,Z.default)(e)}),this.sendMessage=(e=>{e.preventDefault(),this.props.onSendMessage(this.state.pendingMessage),this.setState({pendingMessage:""})}),this.occupantCount=(()=>this.props.presences?Object.entries(this.props.presences).length:0),this.renderExitedPane=(()=>{let e=null;if("closed"===this.props.roomUnavailableReason)e=q.default.createElement("div",null,"Sorry, this room is no longer available.",q.default.createElement("p",null),"A room may be closed if we receive reports that it violates our"," ",q.default.createElement(he.WithHoverSound,null,q.default.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://github.com/mozilla/hubs/blob/master/TERMS.md"},"Terms of Use")),".",q.default.createElement("br",null),"If you have questions, contact us at"," ",q.default.createElement(he.WithHoverSound,null,q.default.createElement("a",{href:"mailto:hubs@mozilla.com"},"hubs@mozilla.com")),".",q.default.createElement("p",null),"If you'd like to run your own server, hubs's source code is available on"," ",q.default.createElement(he.WithHoverSound,null,q.default.createElement("a",{href:"https://github.com/mozilla/hubs"},"GitHub")),".");else if("no_data_channels"===this.props.platformUnsupportedReason)e=q.default.createElement("div",null,"Your browser does not support"," ",q.default.createElement(he.WithHoverSound,null,q.default.createElement("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility",rel:"noreferrer noopener"},"WebRTC Data Channels")),", which is required to use Hubs.",q.default.createElement("br",null),'If you"d like to use Hubs with Oculus or SteamVR, you can'," ",q.default.createElement(he.WithHoverSound,null,q.default.createElement("a",{href:"https://www.mozilla.org/firefox",rel:"noreferrer noopener"},"Download Firefox")),".");else{const t=this.props.roomUnavailableReason||this.props.platformUnsupportedReason,s=`exit.subtitle.${this.state.exited?"exited":t}`;e=q.default.createElement("div",null,q.default.createElement(te.FormattedMessage,{id:s}),q.default.createElement("p",null),"left"!==this.props.roomUnavailableReason&&q.default.createElement("div",null,"You can also"," ",q.default.createElement(he.WithHoverSound,null,q.default.createElement("a",{href:"/"},"create a new room")),"."))}return q.default.createElement(te.IntlProvider,{locale:pe.lang,messages:pe.messages},q.default.createElement("div",{className:"exited-panel"},q.default.createElement("img",{className:"exited-panel__logo",src:n.default}),q.default.createElement("div",{className:"exited-panel__subtitle"},e)))}),this.renderBotMode=(()=>q.default.createElement("div",{className:"loading-panel"},q.default.createElement("img",{className:"loading-panel__logo",src:n.default}),q.default.createElement("input",{type:"file",id:"bot-audio-input",accept:"audio/*"}),q.default.createElement("input",{type:"file",id:"bot-data-input",accept:"application/json"}))),this.renderLoader=(()=>q.default.createElement(te.IntlProvider,{locale:pe.lang,messages:pe.messages},q.default.createElement("div",{className:"loading-panel"},q.default.createElement("div",{className:"loader-wrap"},q.default.createElement("div",{className:"loader"},q.default.createElement("div",{className:"loader-center"}))),q.default.createElement("img",{className:"loading-panel__logo",src:r.default})))),this.renderEntryStartPanel=(()=>{const e=this.state.pendingMessage.split("\n").length,t=28*e+"px",s=28*e+20+"px",i=navigator.serviceWorker&&"PushManager"in window;return q.default.createElement("div",{className:ue.default.entryPanel},q.default.createElement("div",{className:ue.default.name},this.props.hubName),q.default.createElement("div",{className:ue.default.center},q.default.createElement(he.WithHoverSound,null,q.default.createElement("div",{onClick:()=>this.setState({showProfileEntry:!0}),className:ue.default.profileName},q.default.createElement("img",{src:c.default,className:ue.default.profileIcon}),q.default.createElement("div",{title:this.props.store.state.profile.displayName},this.props.store.state.profile.displayName))),q.default.createElement("form",{onSubmit:this.sendMessage},q.default.createElement("div",{className:ce.default.messageEntry,style:{height:s}},q.default.createElement("textarea",{className:(0,Q.default)([ce.default.messageEntryInput,"chat-focus-target"]),value:this.state.pendingMessage,rows:e,style:{height:t},onFocus:e=>e.target.select(),onChange:e=>this.setState({pendingMessage:e.target.value}),onKeyDown:e=>{13!==e.keyCode||e.shiftKey?27===e.keyCode&&e.target.blur():this.sendMessage(e)},placeholder:"Send a message..."}),q.default.createElement(he.WithHoverSound,null,q.default.createElement("input",{className:ce.default.messageEntrySubmit,type:"submit",value:"send"}))))),i&&q.default.createElement("div",{className:ue.default.subscribe},q.default.createElement("input",{id:"subscribe",type:"checkbox",onChange:this.onSubscribeChanged,checked:void 0===this.state.isSubscribed?this.props.initialIsSubscribed:this.state.isSubscribed}),q.default.createElement("label",{htmlFor:"subscribe"},q.default.createElement(te.FormattedMessage,{id:"entry.notify_me"}))),q.default.createElement("div",{className:ue.default.buttonContainer},q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{className:(0,Q.default)([ue.default.actionButton,ue.default.wideButton]),onClick:()=>this.handleStartEntry()},q.default.createElement(te.FormattedMessage,{id:"entry.enter-room"})))))}),this.renderDevicePanel=(()=>q.default.createElement("div",{className:ue.default.entryPanel},q.default.createElement("div",{className:ue.default.title},q.default.createElement(te.FormattedMessage,{id:"entry.choose-device"})),q.default.createElement("div",{className:ue.default.buttonContainer},this.props.availableVREntryTypes.screen===ee.VR_DEVICE_AVAILABILITY.yes&&q.default.createElement(ge.TwoDEntryButton,{onClick:this.enter2D}),this.props.availableVREntryTypes.safari===ee.VR_DEVICE_AVAILABILITY.maybe&&q.default.createElement(ge.SafariEntryButton,{onClick:this.showSafariDialog}),this.props.availableVREntryTypes.generic!==ee.VR_DEVICE_AVAILABILITY.no&&q.default.createElement(ge.GenericEntryButton,{onClick:this.enterVR}),this.props.availableVREntryTypes.daydream===ee.VR_DEVICE_AVAILABILITY.yes&&q.default.createElement(ge.DaydreamEntryButton,{onClick:this.enterDaydream,subtitle:null}),q.default.createElement(ge.DeviceEntryButton,{onClick:()=>this.attemptLink(),isInHMD:this.props.availableVREntryTypes.isInHMD}),this.props.availableVREntryTypes.cardboard!==ee.VR_DEVICE_AVAILABILITY.no&&q.default.createElement("div",{className:ue.default.secondary,onClick:this.enterVR},q.default.createElement(te.FormattedMessage,{id:"entry.cardboard"}))))),this.renderScreensharing=(()=>q.default.createElement("label",{className:ue.default.screenSharing},q.default.createElement("input",{className:ue.default.checkbox,type:"checkbox",value:this.state.shareScreen,onChange:this.setStateAndRequestScreen}),q.default.createElement(te.FormattedMessage,{id:"entry.enable-screen-sharing"}))),this.renderMicPanel=(()=>q.default.createElement("div",{className:"mic-grant-panel"},q.default.createElement("div",{className:"mic-grant-panel__grant-container"},q.default.createElement("div",{className:"mic-grant-panel__title"},q.default.createElement(te.FormattedMessage,{id:this.state.entryStep==ct.mic_grant?"audio.grant-title":"audio.granted-title"})),q.default.createElement("div",{className:"mic-grant-panel__subtitle"},q.default.createElement(te.FormattedMessage,{id:this.state.entryStep==ct.mic_grant?"audio.grant-subtitle":"audio.granted-subtitle"})),q.default.createElement("div",{className:"mic-grant-panel__button-container"},this.state.entryStep==ct.mic_grant?q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{className:"mic-grant-panel__button",onClick:this.onMicGrantButton},q.default.createElement("img",{src:u.default,srcSet:p.default+" 2x"}))):q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{className:"mic-grant-panel__button",onClick:this.onMicGrantButton},q.default.createElement("img",{src:f.default,srcSet:v.default+" 2x"})))),q.default.createElement("div",{className:"mic-grant-panel__next-container"},q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{className:(0,Q.default)("mic-grant-panel__next"),onClick:this.onMicGrantButton},q.default.createElement(te.FormattedMessage,{id:"audio.granted-next"}))))))),this.renderAudioSetupPanel=(()=>{const e={clip:`rect(${111-Math.floor(111*this.state.micLevel)}px, 111px, 111px, 0px)`},t={clip:`rect(${this.state.tonePlaying?0:111}px, 111px, 111px, 0px)`},s=AFRAME.utils.device.isMobile()?"audio.subtitle-mobile":"audio.subtitle-desktop";return q.default.createElement("div",{className:"audio-setup-panel"},q.default.createElement("div",null,q.default.createElement("div",{className:"audio-setup-panel__title"},q.default.createElement(te.FormattedMessage,{id:"audio.title"})),q.default.createElement("div",{className:"audio-setup-panel__subtitle"},(AFRAME.utils.device.isMobile()||this.state.enterInVR)&&q.default.createElement(te.FormattedMessage,{id:s})),q.default.createElement("div",{className:"audio-setup-panel__levels"},q.default.createElement("div",{className:"audio-setup-panel__levels__icon"},q.default.createElement("img",{src:y.default,srcSet:E.default+" 2x",className:"audio-setup-panel__levels__icon-part"}),q.default.createElement("img",{src:w.default,srcSet:k.default+" 2x",className:"audio-setup-panel__levels__icon-part",style:e}),this.state.audioTrack?q.default.createElement("img",{src:C.default,srcSet:R.default+" 2x",className:"audio-setup-panel__levels__icon-part"}):q.default.createElement("img",{src:u.default,srcSet:p.default+" 2x",className:"audio-setup-panel__levels__icon-part"})),q.default.createElement(he.WithHoverSound,null,q.default.createElement("div",{className:"audio-setup-panel__levels__icon",onClick:this.playTestTone},q.default.createElement("img",{src:y.default,srcSet:E.default+" 2x",className:"audio-setup-panel__levels__icon-part"}),q.default.createElement("img",{src:w.default,srcSet:k.default+" 2x",className:"audio-setup-panel__levels__icon-part",style:t}),q.default.createElement("img",{src:D.default,srcSet:P.default+" 2x",className:"audio-setup-panel__levels__icon-part"})))),this.state.audioTrack&&q.default.createElement("div",{className:"audio-setup-panel__device-chooser"},q.default.createElement(he.WithHoverSound,null,q.default.createElement("select",{className:"audio-setup-panel__device-chooser__dropdown",value:this.selectedMicDeviceId(),onChange:this.micDeviceChanged},this.state.micDevices.map(e=>q.default.createElement("option",{key:e.deviceId,value:e.deviceId},"Â Â Â Â Â ",e.label)))),q.default.createElement("img",{className:"audio-setup-panel__device-chooser__mic-icon",src:O.default,srcSet:N.default+" 2x"}),q.default.createElement("img",{className:"audio-setup-panel__device-chooser__dropdown-arrow",src:j.default,srcSet:V.default+" 2x"})),this.shouldShowHmdMicWarning()&&q.default.createElement("div",{className:"audio-setup-panel__hmd-mic-warning"},q.default.createElement("img",{src:W.default,srcSet:G.default+" 2x",className:"audio-setup-panel__hmd-mic-warning__icon"}),q.default.createElement("span",{className:"audio-setup-panel__hmd-mic-warning__label"},q.default.createElement(te.FormattedMessage,{id:"audio.hmd-mic-warning"})))),q.default.createElement("div",{className:"audio-setup-panel__enter-button-container"},q.default.createElement(he.WithHoverSound,null,q.default.createElement("button",{className:"audio-setup-panel__enter-button",onClick:this.onAudioReadyButton},q.default.createElement(te.FormattedMessage,{id:"audio.enter-now"})))))})};t.default=ht},function(e,t,s){e.exports=s.p+"assets/images/logo-8f1dfd234d060073524bc29912a24f75.svg"},function(e,t,s){e.exports=s.p+"assets/images/account-dd4ca16297925e870896b59b760746ad.svg"},function(e,t,s){e.exports=s.p+"assets/images/mic_denied-5ce12e4dc9b5eb42ce69b753c46c2174.png"},function(e,t,s){e.exports=s.p+"assets/images/mic_denied@2x-127a94ff73b93a0b4ac89682ce836b91.png"},function(e,t,s){e.exports=s.p+"assets/images/mic_granted-5d41c8098b2c1a084f07dd3a2473983f.png"},function(e,t,s){e.exports=s.p+"assets/images/mic_granted@2x-f84d9eb002832eeeb768529e6cb1e93e.png"},function(e,t,s){e.exports=s.p+"assets/images/level_background-9744d0690bba7838e4a75949d9645c09.png"},function(e,t,s){e.exports=s.p+"assets/images/level_background@2x-bf55b6a808963d89ff7ce04c516c232c.png"},function(e,t,s){e.exports=s.p+"assets/images/level_fill-35626a008836cbdc34ec624e16f5b723.png"},function(e,t,s){e.exports=s.p+"assets/images/level_fill@2x-b3e3675f8281c84660fb5b47eb66126e.png"},function(e,t,s){e.exports=s.p+"assets/images/mic_level-d197b930a4350dc80adb2446babb05e1.png"},function(e,t,s){e.exports=s.p+"assets/images/mic_level@2x-9d49309c2f0e55e5c54193237658768b.png"},function(e,t,s){e.exports=s.p+"assets/images/speaker_level-9567a1a6f33d4d0e59e57903b08369c9.png"},function(e,t,s){e.exports=s.p+"assets/images/speaker_level@2x-b5e6a12f613576cf5c1a1b96e8c9d8d0.png"},function(e,t,s){e.exports=s.p+"assets/images/mic_small-b81b3397cc985eb8d3d67a4f007158cc.png"},function(e,t,s){e.exports=s.p+"assets/images/mic_small@2x-d04ff548fa26495f69249f0c34f44b72.png"},function(e,t,s){e.exports=s.p+"assets/images/dropdown_arrow-601450f494125f8caccec2271aebd4cb.png"},function(e,t,s){e.exports=s.p+"assets/images/dropdown_arrow@2x-1023ab0bd743b3525d99986de89f0c3b.png"},function(e,t,s){e.exports=s.p+"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png"},function(e,t,s){e.exports=s.p+"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png"},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=c(i),n=s(6),o=s(0),r=c(o),l=s(5);function c(e){return e&&e.__esModule?e:{default:e}}const d=e=>a.default.createElement("div",{className:"autoexit-panel"},a.default.createElement("div",{className:"autoexit-panel__title"},a.default.createElement(n.FormattedMessage,{id:"autoexit.title"}),a.default.createElement("span",null,e.secondsRemaining),a.default.createElement(n.FormattedMessage,{id:"autoexit.title_units"})),a.default.createElement("div",{className:"autoexit-panel__subtitle"},a.default.createElement(n.FormattedMessage,{id:"autoexit.subtitle"})),a.default.createElement(l.WithHoverSound,null,a.default.createElement("div",{className:"autoexit-panel__cancel-button",onClick:e.onCancel},a.default.createElement(n.FormattedMessage,{id:"autoexit.cancel"}))));d.propTypes={secondsRemaining:r.default.number,onCancel:r.default.func},t.default=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceEntryButton=t.SafariEntryButton=t.DaydreamEntryButton=t.GearVREntryButton=t.GenericEntryButton=t.TwoDEntryButton=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=S(a),o=s(6),r=s(0),l=S(r),c=s(372),d=S(c),u=s(373),h=S(u),p=s(130),m=S(p),f=s(374),g=S(f),v=s(375),b=S(v),y=s(376),_=S(y),E=s(631),x=S(E),w=s(5);function S(e){return e&&e.__esModule?e:{default:e}}const k=e=>n.default.createElement(w.WithHoverSound,null,n.default.createElement("button",{className:x.default.entryButton,onClick:e.onClick},n.default.createElement("img",{src:e.iconSrc,className:x.default.icon}),n.default.createElement("div",{className:x.default.label},n.default.createElement("div",{className:x.default.contents},n.default.createElement("span",null,n.default.createElement(o.FormattedMessage,{id:e.prefixMessageId})),n.default.createElement("span",{className:x.default.bolded},n.default.createElement(o.FormattedMessage,{id:e.mediumMessageId})),e.subtitle&&n.default.createElement("div",{className:x.default.subtitle},n.default.createElement(o.FormattedMessage,{id:e.subtitle}))))));k.propTypes={onClick:l.default.func,iconSrc:l.default.string,prefixMessageId:l.default.string,mediumMessageId:l.default.string,subtitle:l.default.string,isInHMD:l.default.bool};t.TwoDEntryButton=(e=>{const t=i({},e,{iconSrc:AFRAME.utils.device.isMobile()?d.default:h.default,prefixMessageId:"entry.screen-prefix",mediumMessageId:AFRAME.utils.device.isMobile()?"entry.mobile-screen":"entry.desktop-screen"});return n.default.createElement(k,t)}),t.GenericEntryButton=(e=>{const t=i({},e,{iconSrc:m.default,prefixMessageId:"entry.generic-prefix",mediumMessageId:"entry.generic-medium",subtitle:AFRAME.utils.device.isMobile()?null:"entry.generic-subtitle-desktop"});return n.default.createElement(k,t)}),t.GearVREntryButton=(e=>{const t=i({},e,{iconSrc:g.default,prefixMessageId:"entry.gearvr-prefix",mediumMessageId:"entry.gearvr-medium"});return n.default.createElement(k,t)}),t.DaydreamEntryButton=(e=>{const t=i({},e,{iconSrc:b.default,prefixMessageId:"entry.daydream-prefix",mediumMessageId:"entry.daydream-medium"});return n.default.createElement(k,t)}),t.SafariEntryButton=(e=>{const t=i({},e,{iconSrc:d.default,prefixMessageId:"entry.screen-prefix",mediumMessageId:"entry.mobile-safari"});return n.default.createElement(k,t)}),t.DeviceEntryButton=(e=>{const t=i({},e,{iconSrc:_.default,prefixMessageId:AFRAME.utils.device.isMobile()?"entry.device-prefix-mobile":"entry.device-prefix-desktop",mediumMessageId:"entry.device-medium"});return t.subtitle=t.isInHMD?"entry.device-subtitle-vr":AFRAME.utils.device.isMobile()?"entry.device-subtitle-mobile":"entry.device-subtitle-desktop",n.default.createElement(k,t)})},function(e,t,s){e.exports=s.p+"assets/images/mobile_screen_entry-b29fcd32c8f70bb828c1abceb62f93e2.svg"},function(e,t,s){e.exports=s.p+"assets/images/desktop_screen_entry-e5ff9b5e64caa694e9b4183e532fcb17.svg"},function(e,t,s){e.exports=s.p+"assets/images/gearvr_entry-dcea59d35d7fae4c8b9c4985c1743851.svg"},function(e,t,s){e.exports=s.p+"assets/images/daydream_entry-657fea71af8b6f165f913acdab828caa.svg"},function(e,t,s){e.exports=s.p+"assets/images/device_entry-6e90766a17f5ad4a130095c3dce61c82.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=v(i),n=s(0),o=v(n),r=s(6),l=s(28),c=s(633),d=v(c),u=s(11),h=v(u),p=s(133),m=v(p),f=s(5),g=s(21);function v(e){return e&&e.__esModule?e:{default:e}}class b extends i.Component{constructor(e){super(e),y.call(this);const{displayName:t,avatarId:s}=this.props.store.state.profile;this.state={displayName:t,avatarId:s,customMode:s&&s.startsWith("http")},this.props.store.addEventListener("statechanged",this.storeUpdated)}componentDidMount(){this.nameInput.addEventListener("keydown",this.stopPropagation),this.nameInput.addEventListener("keypress",this.stopPropagation),this.nameInput.addEventListener("keyup",this.stopPropagation),window.addEventListener("message",this.setAvatarStateFromIframeMessage)}componentWillUnmount(){this.props.store.removeEventListener("statechanged",this.storeUpdated),this.nameInput.removeEventListener("keydown",this.stopPropagation),this.nameInput.removeEventListener("keypress",this.stopPropagation),this.nameInput.removeEventListener("keyup",this.stopPropagation),window.removeEventListener("message",this.setAvatarStateFromIframeMessage)}render(){const{formatMessage:e}=this.props.intl;return a.default.createElement("div",{className:d.default.profileEntry},a.default.createElement("form",{onSubmit:this.saveStateAndFinish,className:d.default.form},a.default.createElement("div",{className:(0,h.default)([d.default.box,d.default.darkened])},a.default.createElement("label",{htmlFor:"#profile-entry-display-name",className:d.default.title},a.default.createElement(r.FormattedMessage,{id:"profile.header"})),a.default.createElement("input",{id:"profile-entry-display-name",className:d.default.formFieldText,value:this.state.displayName,onFocus:e=>e.target.select(),onChange:e=>this.setState({displayName:e.target.value}),required:!0,spellCheck:"false",pattern:l.SCHEMA.definitions.profile.properties.displayName.pattern,title:e({id:"profile.display_name.validation_warning"}),ref:e=>this.nameInput=e}),this.state.customMode?a.default.createElement("div",{className:d.default.avatarSelectorContainer},a.default.createElement("label",{htmlFor:"#custom-avatar-url"},"Avatar GLTF/GLB "),a.default.createElement("input",{id:"custom-avatar-url",type:"url",className:d.default.formFieldText,value:this.state.avatarId,onChange:e=>this.setState({avatarId:e.target.value})}),a.default.createElement("div",{className:d.default.links},a.default.createElement("a",{onClick:()=>this.setState({customMode:!1,avatarId:"botdefault"})},"cancel"))):a.default.createElement("div",{className:d.default.avatarSelectorContainer},a.default.createElement("div",{className:"loading-panel"},a.default.createElement("div",{className:"loader-wrap"},a.default.createElement("div",{className:"loader"},a.default.createElement("div",{className:"loader-center"})))),a.default.createElement("iframe",{className:d.default.avatarSelector,src:`/avatar-selector.html#avatar_id=${this.state.avatarId}`,ref:e=>this.avatarSelector=e}),a.default.createElement("a",{className:"custom-url-link",onClick:()=>this.setState({customMode:!0,avatarId:g.avatars.find(e=>e.id===this.state.avatarId).model})},"custom url")),a.default.createElement(f.WithHoverSound,null,a.default.createElement("input",{className:d.default.formSubmit,type:"submit",value:e({id:"profile.save"})})),a.default.createElement("div",{className:d.default.links},a.default.createElement(f.WithHoverSound,null,a.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/TERMS.md"},a.default.createElement(r.FormattedMessage,{id:"profile.terms_of_use"}))),a.default.createElement(f.WithHoverSound,null,a.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/PRIVACY.md"},a.default.createElement(r.FormattedMessage,{id:"profile.privacy_notice"})))))),a.default.createElement("img",{className:d.default.logo,src:m.default}))}}b.propTypes={store:o.default.object,messages:o.default.object,finished:o.default.func,intl:o.default.object};var y=function(){this.storeUpdated=(()=>{const{avatarId:e,displayName:t}=this.props.store.state.profile;this.setState({avatarId:e,displayName:t})}),this.saveStateAndFinish=(e=>{e.preventDefault();const{displayName:t}=this.props.store.state.profile,{hasChangedName:s}=this.props.store.state.activity,i=s||this.state.displayName!==t;this.props.store.update({activity:{hasChangedName:i},profile:{displayName:this.state.displayName,avatarId:this.state.avatarId}}),this.props.finished()}),this.stopPropagation=(e=>{e.stopPropagation()}),this.setAvatarStateFromIframeMessage=(e=>{e.source===this.avatarSelector.contentWindow&&this.setState({avatarId:e.data.avatarId})})};t.default=(0,r.injectIntl)(b)},,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=_(a),o=s(0),r=_(o),l=s(386),c=_(l),d=s(56),u=s(387),h=s(388),p=s(635),m=_(p),f=s(11),g=_(f),v=s(8),b=_(v),y=s(5);function _(e){return e&&e.__esModule?e:{default:e}}const E={"giphy.com":c.default,"media.giphy.com":c.default},x="https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf",w=AFRAME.utils.device.isMobile(),S="Paste a URL to an image, video, model, or upload a file.",k=n.default.createElement("span",null,"For models, try"," ",n.default.createElement("a",{href:"https://sketchfab.com/search?features=downloadable&type=models",target:"_blank",rel:"noopener noreferrer"},"Sketchfab"),","," ",n.default.createElement("a",{href:"http://poly.google.com/",target:"_blank",rel:"noopener noreferrer"},"Google Poly"),", or our"," ",n.default.createElement("a",{href:"https://sketchfab.com/mozillareality",target:"_blank",rel:"noopener noreferrer"},"collection"),"."),A=n.default.createElement("div",null,n.default.createElement("p",null,S),n.default.createElement("p",null,k)),C=n.default.createElement("div",null,n.default.createElement("p",null,S),n.default.createElement("p",null,k),n.default.createElement("p",null,"Tip: You can paste media directly into Hubs with Ctrl+V"));let M="";const R="file-input";class T extends a.Component{constructor(...e){var t;return t=super(...e),this.state={url:"",file:null,fileName:""},this.onUrlChange=(e=>{let t=this.state.attributionImage;if(e.target&&e.target.value&&e.target.validity.valid){const s=new URL(e.target.value);t=E[s.hostname]}this.setState({url:e.target&&e.target.value,attributionImage:t})}),this.onFileChange=(e=>{this.setState({file:e.target.files[0],fileName:e.target.files[0].name})}),this.reset=(e=>{e.preventDefault(),this.setState({url:"",file:null,fileName:""}),this.fileInput.value=null}),this.onCreateClicked=(e=>{e.preventDefault(),this.props.onCreate(this.state.file||this.state.url||x),this.props.onClose()}),t}componentDidMount(){this.setState({url:M})}componentWillUnmount(){M=this.state.url}render(){const e=this.props,{onCreate:t,onClose:s}=e,a=function(e,t){var s={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=e[i]);return s}(e,["onCreate","onClose"]),o=n.default.createElement(y.WithHoverSound,null,n.default.createElement("label",{className:(0,g.default)(m.default.smallButton,m.default.cancelIcon),onClick:this.reset},n.default.createElement(d.FontAwesomeIcon,{icon:h.faTimes}))),r=n.default.createElement(y.WithHoverSound,null,n.default.createElement("label",{htmlFor:R,className:(0,g.default)(m.default.smallButton,m.default.uploadIcon)},n.default.createElement(d.FontAwesomeIcon,{icon:u.faPaperclip}))),l=n.default.createElement("label",{className:(0,g.default)(m.default.leftSideOfInput)},this.state.fileName),c=n.default.createElement("input",{className:(0,g.default)(m.default.leftSideOfInput),placeholder:"Image/Video/glTF URL",onChange:this.onUrlChange,type:"url",value:this.state.url});return n.default.createElement(b.default,i({title:"Create Object",onClose:this.props.onClose},a),n.default.createElement("div",null,w?A:C,n.default.createElement("form",{onSubmit:this.onCreateClicked},n.default.createElement("div",{className:m.default.addMediaForm},n.default.createElement("input",{id:R,ref:e=>this.fileInput=e,className:m.default.hideFileInput,type:"file",onChange:this.onFileChange}),n.default.createElement("div",{className:m.default.inputBorder},this.state.file?l:c,this.state.url||this.state.fileName?o:r),n.default.createElement("div",{className:m.default.buttons},n.default.createElement(y.WithHoverSound,null,n.default.createElement("button",{className:m.default.actionButton},n.default.createElement("span",null,"Create")))),this.state.attributionImage?n.default.createElement("div",null,n.default.createElement("img",{src:this.state.attributionImage})):null))))}}t.default=T,T.propTypes={onCreate:r.default.func,onClose:r.default.func}},function(e,t,s){e.exports=s.p+"assets/images/giphy_logo-1dcbee43e18919c0bd0c999be8602628.png"},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=d(a),o=s(6),r=s(8),l=d(r),c=s(5);function d(e){return e&&e.__esModule?e:{default:e}}t.default=class extends a.Component{render(){return n.default.createElement(l.default,i({title:"Getting Started"},this.props),n.default.createElement("div",{className:"info-dialog__help"},n.default.createElement("p",{style:{textAlign:"center"}},"Join the Hubs community on"," ",n.default.createElement(c.WithHoverSound,null,n.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://discord.gg/XzrGUY8"},"Discord")),"!"),n.default.createElement("p",null,"When in a room, other avatars can see and hear you."),n.default.createElement("p",null,"Use your controller's action button to teleport from place to place. If it has a grip, use it to pick up objects."),n.default.createElement("p",null,"In VR, ",n.default.createElement("b",null,"look up")," to find your menu."),n.default.createElement("p",null,"The ",n.default.createElement("b",null,"Mic Toggle")," mutes your mic."),n.default.createElement("p",null,"The ",n.default.createElement("b",null,"Pause Toggle")," pauses all other avatars and lets you block others or pin or remove objects."),n.default.createElement("p",null,"See detailed"," ",n.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/wiki/Hubs-Features"},"feature")," ","and"," ",n.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/wiki/Hubs-Controls"},"controls")," ","documentation."),n.default.createElement("p",{className:"dialog__box__contents__links"},n.default.createElement(c.WithHoverSound,null,n.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/TERMS.md"},n.default.createElement(o.FormattedMessage,{id:"profile.terms_of_use"}))),n.default.createElement(c.WithHoverSound,null,n.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/PRIVACY.md"},n.default.createElement(o.FormattedMessage,{id:"profile.privacy_notice"}))),n.default.createElement(c.WithHoverSound,null,n.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"/?report"},n.default.createElement(o.FormattedMessage,{id:"help.report_issue"}))))))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=g(i),n=s(0),o=g(n),r=s(129),l=g(r),c=s(11),d=g(c),u=s(6),h=s(163),p=s(5),m=s(637),f=g(m);function g(e){return e&&e.__esModule?e:{default:e}}class v extends i.Component{constructor(...e){var t;return t=super(...e),this.state={copyButtonActive:!1,shareButtonActive:!1},this.shareClicked=(e=>{this.setState({shareButtonActive:!0}),(0,h.share)({url:e,title:"Join me now in #hubs!"}).then(()=>{this.setState({shareButtonActive:!1})})}),this.copyClicked=(e=>{this.setState({copyButtonActive:!0}),setTimeout(()=>this.setState({copyButtonActive:!1}),5e3),(0,l.default)(e)}),t}render(){const{entryCode:e}=this.props,t=function(e,t){let s=`${e}`;for(;s.length<t;)s=`0${s}`;return s}(e,6),s=`hub.link/${this.props.hubId}`,i="https://"+s;return a.default.createElement("div",{className:f.default.dialog},a.default.createElement("div",{className:f.default.attachPoint}),a.default.createElement(p.WithHoverSound,null,a.default.createElement("div",{className:f.default.close,onClick:()=>this.props.onClose()},a.default.createElement("span",null,"Ã—"))),a.default.createElement("div",null,a.default.createElement(u.FormattedMessage,{id:"invite.enter_via"}),a.default.createElement(p.WithHoverSound,null,a.default.createElement("a",{href:"https://hub.link",target:"_blank",className:f.default.hubLinkLink,rel:"noopener noreferrer"},"hub.link")),a.default.createElement(u.FormattedMessage,{id:"invite.and_enter_code"})),a.default.createElement("div",{className:f.default.code},t.split("").map((e,t)=>a.default.createElement("div",{className:(0,d.default)({[f.default.digit]:!0,[f.default[`digit_${t}`]]:!0}),key:`link_code_${t}`},e))),a.default.createElement("div",null,a.default.createElement(u.FormattedMessage,{id:"invite.or_visit"})),a.default.createElement("div",{className:f.default.domain},a.default.createElement("input",{type:"text",readOnly:!0,onFocus:e=>e.target.select(),value:s})),a.default.createElement("div",{className:f.default.buttons},a.default.createElement(p.WithHoverSound,null,a.default.createElement("button",{className:f.default.linkButton,onClick:this.copyClicked.bind(this,i)},a.default.createElement("span",null,this.state.copyButtonActive?"copied!":"copy"))),this.props.allowShare&&navigator.share&&a.default.createElement(p.WithHoverSound,null,a.default.createElement("button",{className:f.default.linkButton,onClick:this.shareClicked.bind(this,i)},a.default.createElement("span",null,this.state.shareButtonActive?"sharing...":"share"))),this.props.allowShare&&!navigator.share&&a.default.createElement(p.WithHoverSound,null,a.default.createElement("button",{className:f.default.linkButton,onClick:this.shareClicked.bind(this,i)},a.default.createElement(u.FormattedMessage,{id:"invite.tweet"})))))}}t.default=v,v.propTypes={entryCode:o.default.number,hubId:o.default.string,allowShare:o.default.bool,onClose:o.default.func}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=u(a),o=s(8),r=u(o),l=s(0),c=u(l),d=s(5);function u(e){return e&&e.__esModule?e:{default:e}}class h extends a.Component{constructor(e){super(e),this.state={inviteButtonText:"invite a hubs team member"},this.inviteClicked=(()=>{this.setState({inviteButtonText:"OK! We'll be there shortly."}),this.props.hubChannel.requestSupport()})}render(){return n.default.createElement(r.default,i({title:"Let's Chat!"},this.props),n.default.createElement("div",null,n.default.createElement("div",null,n.default.createElement("p",null,"Have an idea for Hubs? Having trouble?"),n.default.createElement("p",null,"We'd love to chat. Someone from our team will join you in just a few minutes.")),n.default.createElement("div",{className:"invite-team-form"},n.default.createElement("div",{className:"invite-team-form__buttons"},n.default.createElement(d.WithHoverSound,null,n.default.createElement("button",{className:"invite-team-form__action-button",onClick:this.inviteClicked},n.default.createElement("span",null,this.state.inviteButtonText)))))))}}t.default=h,h.propTypes={hubChannel:c.default.object}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=f(i),n=s(0),o=f(n),r=s(11),l=f(r),c=s(6),d=s(393),u=f(d),h=s(5),p=s(639),m=f(p);function f(e){return e&&e.__esModule?e:{default:e}}class g extends i.Component{render(){const{linkCode:e}=this.props;return a.default.createElement("div",{className:m.default.dialog},a.default.createElement(h.WithHoverSound,null,a.default.createElement("div",{className:m.default.close,onClick:()=>this.props.onClose()},a.default.createElement("span",null,"Ã—"))),a.default.createElement("div",null,!e&&a.default.createElement("div",null,a.default.createElement("div",{className:(0,l.default)("loading-panel",m.default.codeLoadingPanel)},a.default.createElement("div",{className:"loader-wrap"},a.default.createElement("div",{className:"loader"},a.default.createElement("div",{className:"loader-center"}))))),e&&a.default.createElement("div",{className:m.default.contents},a.default.createElement("img",{className:m.default.imageHeader,src:u.default}),a.default.createElement("div",{className:m.default.header},a.default.createElement(c.FormattedMessage,{id:"link.connect_headset"})),a.default.createElement("div",null,a.default.createElement(c.FormattedMessage,{id:"link.in_your_browser"})),a.default.createElement(h.WithHoverSound,null,a.default.createElement("a",{href:"https://hub.link",className:m.default.domain,target:"_blank",rel:"noopener noreferrer"},"hub.link")),a.default.createElement("div",null,a.default.createElement(c.FormattedMessage,{id:"link.enter_code"})),e&&a.default.createElement("div",{className:m.default.code},e.split("").map((e,t)=>a.default.createElement("span",{className:m.default.digit,key:`link_code_${t}`},e))),a.default.createElement("div",{className:m.default.keepOpen},a.default.createElement(c.FormattedMessage,{id:"link.do_not_close"})),a.default.createElement(h.WithHoverSound,null,a.default.createElement("button",{className:m.default.closeButton,onClick:()=>this.props.onClose()},a.default.createElement(c.FormattedMessage,{id:"link.cancel"}))))))}}t.default=g,g.propTypes={linkCode:o.default.string,onClose:o.default.func}},function(e,t,s){e.exports=s.p+"assets/images/link_dialog_header-b15568ca2056d8be7a58c359e6a9ca51.svg"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=u(a),o=s(129),r=u(o),l=s(8),c=u(l),d=s(5);function u(e){return e&&e.__esModule?e:{default:e}}t.default=class extends a.Component{constructor(...e){var t;return t=super(...e),this.state={copyLinkButtonText:"copy"},this.copyLinkClicked=(e=>{(0,r.default)(e),this.setState({copyLinkButtonText:"copied!"})}),t}render(){const e=this.copyLinkClicked.bind(this,document.location);return n.default.createElement(c.default,i({title:"Open in Safari"},this.props),n.default.createElement("div",null,n.default.createElement("div",null,"Hubs does not support your current browser on iOS. Copy and paste this link directly in Safari."),n.default.createElement("div",{className:"invite-form"},n.default.createElement("input",{type:"text",readOnly:!0,onFocus:e=>e.target.select(),value:document.location,className:"invite-form__link_field"}),n.default.createElement("div",{className:"invite-form__buttons"},n.default.createElement(d.WithHoverSound,null,n.default.createElement("button",{className:"invite-form__action-button",onClick:e},n.default.createElement("span",null,this.state.copyLinkButtonText)))))))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=l(a),o=s(8),r=l(o);function l(e){return e&&e.__esModule?e:{default:e}}t.default=class extends a.Component{render(){return n.default.createElement(r.default,i({title:"Microphone Access Required"},this.props),n.default.createElement("div",null,n.default.createElement("div",null,"Hubs requires microphone permissions in Safari. ",n.default.createElement("br",null),"Please reload and allow microphone access to continue."),n.default.createElement("div",{className:"invite-form"},n.default.createElement("div",{className:"invite-form__buttons"},n.default.createElement("button",{className:"invite-form__action-button",onClick:()=>location.reload()},"Reload")))))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=p(a),o=s(0),r=p(o),l=s(6),c=s(641),d=p(c),u=s(8),h=p(u);function p(e){return e&&e.__esModule?e:{default:e}}class m extends a.Component{constructor(...e){var t;return t=super(...e),this.state={email:""},this.onSubmit=(e=>{e.preventDefault(),e.stopPropagation(),this.props.onSignIn(this.state.email)}),t}render(){let e;return e=this.props.authStarted?n.default.createElement("p",null,n.default.createElement(l.FormattedMessage,{className:"preformatted",id:"sign-in.auth-started"})):this.props.authComplete?n.default.createElement("div",{className:d.default.signInComplete},n.default.createElement("p",null,this.props.message),n.default.createElement("button",{onClick:this.props.onContinue,className:d.default.continueButton},this.props.continueText)):n.default.createElement("form",{onSubmit:this.onSubmit,className:d.default.signInForm},n.default.createElement("span",null,this.props.message),n.default.createElement("input",{name:"email",type:"email",required:!0,placeholder:"Your email address",value:this.state.email,onChange:e=>this.setState({email:e.target.value}),className:d.default.emailField}),n.default.createElement("p",{className:d.default.terms},"By proceeding, you agree to the"," ",n.default.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://github.com/mozilla/hubs/blob/master/TERMS.md"},"terms of use")," ","and"," ",n.default.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://github.com/mozilla/hubs/blob/master/PRIVACY.md"},"privacy notice"),"."),n.default.createElement("button",{type:"submit",className:d.default.nextButton},"next")),n.default.createElement(h.default,i({title:"Sign In"},this.props),e)}}t.default=m,m.propTypes={authStarted:r.default.bool,authComplete:r.default.bool,onSignIn:r.default.func,onContinue:r.default.func,message:r.default.string,continueText:r.default.string}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=l(a),o=s(8),r=l(o);function l(e){return e&&e.__esModule?e:{default:e}}t.default=class extends a.Component{render(){return n.default.createElement(r.default,i({title:"Share Screen"},this.props),n.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},n.default.createElement("p",null,"Your browser doesn't seem to support WebRTC screen sharing.",n.default.createElement("br",null),"To share your screen in Hubs, you can use Firefox."),n.default.createElement("a",{className:"info-dialog--action-button",target:"_blank",rel:"noreferrer noopener",href:"https://www.mozilla.org/firefox"},"Download Firefox"),n.default.createElement("p",{style:{fontSize:"0.8em"}},"To test WebRTC screen sharing in your browser, see thisÂ ",n.default.createElement("a",{href:"https://www.webrtc-experiment.com/screen-sharing/#5591174797993739",target:"_blank",rel:"noopener noreferrer"},"WebRTC experiment"),".")))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},a=s(1),n=c(a),o=s(8),r=c(o),l=s(5);function c(e){return e&&e.__esModule?e:{default:e}}t.default=class extends a.Component{render(){return n.default.createElement(r.default,i({title:"Enter in VR"},this.props),n.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},n.default.createElement("p",null,"To enter Hubs with Oculus or SteamVR, you can use Firefox."),n.default.createElement(l.WithHoverSound,null,n.default.createElement("a",{className:"info-dialog--action-button",href:"https://www.mozilla.org/firefox",target:"_blank",rel:"noreferrer noopener"},"Download Firefox")),n.default.createElement("p",{style:{fontSize:"0.8em"}},"For a full list of browsers with experimental VR support, visit"," ",n.default.createElement(l.WithHoverSound,null,n.default.createElement("a",{href:"https://webvr.rocks",target:"_blank",rel:"noopener noreferrer"},"WebVR Rocks")))))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=g(i),n=s(0),o=g(n),r=s(643),l=g(r),c=s(11),d=g(c),u=s(6),h=s(84),p=g(h),m=s(412),f=g(m);function g(e){return e&&e.__esModule?e:{default:e}}class v extends i.Component{constructor(e){super(e),this.domForEntry=(e=>{const t={[l.default.presenceLogEntry]:!0,[l.default.presenceLogEntryWithButton]:"chat"===e.type&&e.maySpawn,[l.default.presenceLogChat]:"chat"===e.type,[l.default.expired]:!!e.expired};switch(e.type){case"join":case"entered":return a.default.createElement("div",{key:e.key,className:(0,d.default)(t)},a.default.createElement("b",null,e.name),"Â ",a.default.createElement(u.FormattedMessage,{id:`presence.${e.type}_${e.presence}`}));case"leave":return a.default.createElement("div",{key:e.key,className:(0,d.default)(t)},a.default.createElement("b",null,e.name),"Â ",a.default.createElement(u.FormattedMessage,{id:`presence.${e.type}`}));case"display_name_changed":return a.default.createElement("div",{key:e.key,className:(0,d.default)(t)},a.default.createElement("b",null,e.oldName),"Â ",a.default.createElement(u.FormattedMessage,{id:"presence.name_change"}),"Â ",a.default.createElement("b",null,e.newName),".");case"chat":return a.default.createElement(p.default,{key:e.key,name:e.name,className:(0,d.default)(t),body:e.body,maySpawn:e.maySpawn});case"spawn":return a.default.createElement(f.default,{key:e.key,name:e.name,className:(0,d.default)(t,l.default.media),body:e.body,maySpawn:e.maySpawn,hubId:this.props.hubId});case"log":return a.default.createElement("div",{key:e.key,className:(0,d.default)(t)},e.body)}})}render(){const e={[l.default.presenceLog]:!0,[l.default.presenceLogInRoom]:this.props.inRoom};return a.default.createElement("div",{className:(0,d.default)(e)},this.props.entries.map(this.domForEntry))}}t.default=v,v.propTypes={entries:o.default.array,inRoom:o.default.bool,hubId:o.default.string}},,,,,,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=m;var i=s(1),a=p(i),n=s(0),o=p(n),r=s(643),l=p(r),c=s(11),d=p(c),u=s(163),h=s(12);function p(e){return e&&e.__esModule?e:{default:e}}function m({name:e,body:{src:t},className:s,maySpawn:i,hubId:n}){const o=(0,h.getLandingPageForPhoto)(t),r=u.share.bind(null,{url:o,title:`Taken in #hubs, join me at https://hub.link/${n}`});return a.default.createElement("div",{className:s},i&&a.default.createElement("button",{className:(0,d.default)(l.default.iconButton,l.default.share),onClick:r}),a.default.createElement("div",{className:l.default.mediaBody},a.default.createElement("span",null,a.default.createElement("b",null,e)),a.default.createElement("span",null,"took a ",a.default.createElement("b",null,a.default.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},"photo")),".")),a.default.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},a.default.createElement("img",{src:t})))}m.propTypes={name:o.default.string,maySpawn:o.default.bool,body:o.default.object,className:o.default.string,hubId:o.default.string}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=E(i),n=s(0),o=E(n),r=s(6),l=s(11),c=E(l),d=s(646),u=E(d),h=s(414),p=E(h),m=s(415),f=E(m),g=s(416),v=E(g),b=s(417),y=E(b),_=s(5);function E(e){return e&&e.__esModule?e:{default:e}}class x extends i.Component{constructor(...e){var t;return t=super(...e),this.domForPresence=(([e,t])=>{const s=t.metas[0],i=s.context,n=s.profile,o=i&&i.mobile?p.default:i&&i.hmd?v.default:f.default;return a.default.createElement(_.WithHoverSound,{key:e},a.default.createElement("div",{className:u.default.row},a.default.createElement("div",{className:u.default.device},a.default.createElement("img",{src:o})),a.default.createElement("div",{className:(0,c.default)({[u.default.displayName]:!0,[u.default.selfDisplayName]:e===this.props.sessionId})},n&&n.displayName),a.default.createElement("div",{className:u.default.presence},a.default.createElement(r.FormattedMessage,{id:`presence.in_${s.presence}`}))))}),t}render(){return a.default.createElement("div",{className:u.default.presenceList},a.default.createElement("div",{className:u.default.attachPoint}),a.default.createElement("div",{className:u.default.contents},a.default.createElement("div",{className:u.default.rows},Object.entries(this.props.presences||{}).filter(([e])=>e===this.props.sessionId).map(this.domForPresence),Object.entries(this.props.presences||{}).filter(([e])=>e!==this.props.sessionId).map(this.domForPresence)),a.default.createElement("div",{className:u.default.signIn},this.props.signedIn?a.default.createElement("div",null,a.default.createElement("span",null,a.default.createElement(r.FormattedMessage,{id:"sign-in.as"})," ",(0,y.default)(this.props.email))," ",a.default.createElement("a",{onClick:this.props.onSignOut},a.default.createElement(r.FormattedMessage,{id:"sign-in.out"}))):a.default.createElement("a",{onClick:this.props.onSignIn},a.default.createElement(r.FormattedMessage,{id:"sign-in.in"})))))}}t.default=x,x.propTypes={presences:o.default.object,sessionId:o.default.string,signedIn:o.default.bool,email:o.default.string,onSignIn:o.default.func,onSignOut:o.default.func}},function(e,t,s){e.exports=s.p+"assets/images/presence_phone-cfbb42259baa966fa6b028a757cd3a5e.png"},function(e,t,s){e.exports=s.p+"assets/images/presence_desktop-931af339141e788db31b09e4a52115e6.png"},function(e,t,s){e.exports=s.p+"assets/images/presence_vr-ff28660171adf429d91211d9d1bd2ec2.png"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return"";const t=e.split("@"),s=t[0],i=t[1],a=s.substring(0,Math.min(s.length,3));return`${a}...@${i}`}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=f(i),n=s(0),o=f(n),r=s(11),l=f(r),c=s(648),d=f(c),u=s(629),h=f(u),p=s(5),m=s(6);function f(e){return e&&e.__esModule?e:{default:e}}const{detect:g}=s(34),v=g();class b extends i.Component{constructor(...e){var t;return t=super(...e),this.state={showVideoShareOptions:!1,lastActiveMediaSource:null},this.handleVideoShareClicked=(e=>{"screen"!==e&&"window"!==e||"firefox"===v.name?this.props.videoShareMediaSource?this.props.onEndShareVideo():(this.props.onShareVideo(e),this.setState({lastActiveMediaSource:e})):this.props.onShareVideoNotCapable()}),this.buildVideoSharingButtons=(()=>{const e=AFRAME.utils.device.isMobile(),t=[],s=this.props.videoShareMediaSource||this.state.lastActiveMediaSource||(e?"camera":"screen");this.state.showVideoShareOptions&&(t.push(s),["screen","window","camera"].forEach(e=>{-1===t.indexOf(e)&&t.push(e)}));const i=()=>{e||(clearTimeout(this.hideVideoSharingButtonTimeout),this.props.videoShareMediaSource||this.setState({showVideoShareOptions:!0}))};return a.default.createElement(p.WithHoverSound,null,a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default[`share_${s}`],{[d.default.active]:this.props.videoShareMediaSource===s,[d.default.videoShare]:!0}),title:null!==this.props.videoShareMediaSource?"Stop sharing":`Share ${s}`,onClick:()=>{this.state.showVideoShareOptions||this.handleVideoShareClicked(s)},onMouseOver:i},null!==this.props.videoShareMediaSource&&a.default.createElement("div",{className:(0,l.default)(d.default.videoShareNotify)},a.default.createElement("div",{className:(0,l.default)(d.default.attachPoint)}),a.default.createElement(m.FormattedMessage,{id:"video_share.notify"})),t.length>0&&a.default.createElement("div",{className:(0,l.default)(d.default.videoShareExtraOptions),onMouseOut:()=>{this.hideVideoSharingButtonTimeout=setTimeout(()=>{this.setState({showVideoShareOptions:!1})},250)}},t.map(e=>a.default.createElement(p.WithHoverSound,{key:e},a.default.createElement("div",{key:e,className:(0,l.default)(d.default.iconButton,d.default[`share_${e}`],{[d.default.active]:this.props.videoShareMediaSource===e}),title:this.props.videoShareMediaSource===e?"Stop sharing":`Share ${e}`,onClick:()=>this.handleVideoShareClicked(e),onMouseOver:i}))))))}),t}render(){const e=this.buildVideoSharingButtons();return a.default.createElement("div",{className:(0,l.default)(d.default.container,d.default.top,d.default.unselectable,h.default.uiInteractive)},a.default.createElement("div",{className:(0,l.default)(h.default.uiInteractive,d.default.panel)},e,a.default.createElement(p.WithHoverSound,null,a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.mute,{[d.default.active]:this.props.muted}),title:this.props.muted?"Unmute Mic":"Mute Mic",onClick:this.props.onToggleMute})),a.default.createElement(p.WithHoverSound,null,a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.freeze,{[d.default.active]:this.props.frozen}),title:this.props.frozen?"Resume":"Pause",onClick:this.props.onToggleFreeze})),a.default.createElement(p.WithHoverSound,null,a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.spawn_pen),title:"Drawing Pen",onClick:this.props.onSpawnPen})),a.default.createElement(p.WithHoverSound,null,a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.spawn_camera),title:"Camera",onClick:this.props.onSpawnCamera}))))}}b.propTypes={muted:o.default.bool,frozen:o.default.bool,videoShareMediaSource:o.default.string,onToggleMute:o.default.func,onToggleFreeze:o.default.func,onSpawnPen:o.default.func,onSpawnCamera:o.default.func,onShareVideo:o.default.func,onEndShareVideo:o.default.func,onShareVideoNotCapable:o.default.func};const y=({onCreateObject:e,showPhotoPicker:t,onMediaPicked:s})=>a.default.createElement("div",{className:(0,l.default)(d.default.container,d.default.column,d.default.bottom,d.default.unselectable)},t?a.default.createElement("div",{className:(0,l.default)(h.default.uiInteractive,d.default.panel,d.default.up)},a.default.createElement("input",{id:"media-picker-input",className:(0,l.default)(d.default.hide),type:"file",accept:"image/*",multiple:!0,onChange:e=>{for(const t of e.target.files)s(t)}}),a.default.createElement("label",{htmlFor:"media-picker-input"},a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.mobileMediaPicker),title:"Pick Media"}))):a.default.createElement("div",null),a.default.createElement("div",null,a.default.createElement(p.WithHoverSound,null,a.default.createElement("div",{className:(0,l.default)(h.default.uiInteractive,d.default.iconButton,d.default.large,d.default.createObject),title:"Create Object",onClick:e}))));y.propTypes={onCreateObject:o.default.func,showPhotoPicker:o.default.bool,onMediaPicked:o.default.func},t.default={TopHUD:b,BottomHUD:y}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),a=d(i),n=s(0),o=d(n),r=s(678),l=d(r),c=s(6);function d(e){return e&&e.__esModule?e:{default:e}}class u extends i.Component{render(){return a.default.createElement("div",{className:l.default.commandHelp},["help","leave","fly","grow","shrink","duck"].map(e=>(""===this.props.matchingPrefix||e.startsWith(this.props.matchingPrefix))&&a.default.createElement("div",{className:l.default.entry,key:e},a.default.createElement("div",{className:l.default.command},"/",e),a.default.createElement("div",null,a.default.createElement(c.FormattedMessage,{id:`commands.${e}`})))))}}t.default=u,u.propTypes={matchingPrefix:o.default.string}},,,,,function(e,t,s){e.exports=s.p+"assets/sfx/tone-624e72d19fe0cea1b85ca174cb6be256.webm"},function(e,t,s){e.exports=s.p+"assets/sfx/tone-3fa0defb5172b2533fedcc1929605799.mp3"},function(e,t,s){e.exports=s.p+"assets/sfx/tone-78ae5a60f0e336f384919eee9f5a2e18.ogg"},function(e,t,s){e.exports=s.p+"assets/sfx/tone-4604a4c98f36f3e0c6980295bc5c7ffe.wav"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=s(44),n=(i=a,i&&i.__esModule?i:{default:i});t.default=class{constructor(e){this.setSocket=(e=>{this.socket=e}),this.signOut=(async e=>{await e.signOut(),this.store.update({credentials:{token:null,email:null}})}),this.store=e,this.socket=null}async startAuthentication(e,t){const s=this.socket.channel(`auth:${(0,n.default)()}`);await new Promise((e,t)=>s.join().receive("ok",e).receive("error",t));const i=new Promise(i=>s.on("auth_credentials",async({credentials:s})=>{this.store.update({credentials:{email:e,token:s}}),await t.signIn(s),i()}));return s.push("auth_request",{email:e,origin:"hubs"}),{authComplete:i}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e};const a=864e5,n=2592e6;function o(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()}t.default=class{constructor(e){var t,s;this.setPhoenixChannel=(e=>{this.channel=e}),this.sendEntryEvent=(async()=>{if(!this.channel)return void console.warn("No phoenix channel initialized before room entry.");let e="Screen";if(navigator.getVRDisplays){const t=(await navigator.getVRDisplays()).find(e=>e.isPresenting);t&&(e=t.displayName)}let t=0;NAF.connection.adapter&&NAF.connection.adapter.publisher&&(t=NAF.connection.adapter.publisher.initialOccupants.length);const s=this.getEntryTimingFlags(),a=i({},s,{initialOccupantCount:t,entryDisplayType:e,userAgent:navigator.userAgent});this.channel.push("events:entered",a)}),this.getEntryTimingFlags=(()=>{const e={isNewDaily:!0,isNewMonthly:!0,isNewDayWindow:!0,isNewMonthWindow:!0},i=this.store.state.activity.lastEnteredAt;if(!i)return e;const r=new Date,l=new Date(i),c=r-l;return e.isNewDaily=(t=r,s=l,!(o(t,s)&&t.getDate()==s.getDate())),e.isNewMonthly=!o(r,l),e.isNewDayWindow=c>a,e.isNewMonthWindow=c>n,e}),this.sendObjectSpawnedEvent=(e=>{if(!this.channel)return void console.warn("No phoenix channel initialized before object spawn.");const t={object_type:e};this.channel.push("events:object_spawned",t)}),this.sendProfileUpdate=(()=>{this.channel.push("events:profile_updated",{profile:this.store.state.profile})}),this.subscribe=(e=>{this.channel.push("subscribe",{subscription:e})}),this.unsubscribe=(e=>new Promise(t=>this.channel.push("unsubscribe",{subscription:e}).receive("ok",t))),this.sendMessage=((e,t="chat")=>{e&&this.channel.push("message",{body:e,type:t})}),this.signIn=(e=>new Promise((t,s)=>{this.channel.push("sign_in",{token:e}).receive("ok",()=>{this._signedIn=!0,t()}).receive("error",e=>{console.error("sign in failed",e),s()})})),this.signOut=(()=>new Promise((e,t)=>{this.channel.push("sign_out").receive("ok",()=>{this._signedIn=!1,e()}).receive("error",t)})),this.getHost=(()=>new Promise((e,t)=>{this.channel.push("get_host").receive("ok",t=>{e(t.host)}).receive("error",t)})),this.pin=((e,t,s,i,a)=>{const n={id:e,gltf_node:t};s&&a&&(n.file_id=s,n.file_access_token=i,n.promotion_token=a),this.channel.push("pin",n)}),this.unpin=((e,t)=>{const s={id:e};t&&(s.file_id=t),this.channel.push("unpin",s)}),this.requestSupport=(()=>{this.channel.push("events:request_support",{})}),this.disconnect=(()=>{this.channel&&this.channel.socket.disconnect()}),this.store=e,this._signedIn=!1}get signedIn(){return this._signedIn}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(84);const a="https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf";t.default=class{constructor(e,t,s,n,o){this.dispatch=(e=>{e.startsWith("/")?(this.dispatchCommand(e.substring(1)),document.activeElement.blur()):this.hubChannel.sendMessage(e)}),this.dispatchCommand=(e=>{const t=this.scene.is("entered");switch(e){case"help":return void document.querySelector(".help-button").click()}if(!t)return void this.addToPresenceLog({type:"log",body:"You must enter the room to use this command."});const s=document.querySelector("#player-rig"),n=[.0625,.125,.25,.5,1,1.5,3,5,7.5,12.5],o=s.object3D.scale;switch(e){case"fly":!0!==s.getAttribute("character-controller").fly?(s.setAttribute("character-controller","fly",!0),this.addToPresenceLog({type:"log",body:"Fly mode enabled."})):(s.setAttribute("character-controller","fly",!1),this.addToPresenceLog({type:"log",body:"Fly mode disabled."}));break;case"grow":for(let e=0;e<n.length;e++)if(n[e]>o.x){s.object3D.scale.set(n[e],n[e],n[e]),s.object3D.matrixNeedsUpdate=!0;break}break;case"shrink":for(let e=n.length-1;e>=0;e--)if(o.x>n[e]){s.object3D.scale.set(n[e],n[e],n[e]);break}break;case"leave":this.entryManager.exitScene(),this.remountUI({roomUnavailableReason:"left"});break;case"duck":(0,i.spawnChatMessage)(a),this.scene.emit("quack")}}),this.scene=e,this.entryManager=t,this.hubChannel=s,this.addToPresenceLog=n,this.remountUI=o}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(46),a=p(i),n=s(161),o=p(n),r=s(27),l=p(r),c=s(432),d=p(c),u=s(9),h=s(19);function p(e){return e&&e.__esModule?e:{default:e}}const m=1.6,f=(0,a.default)("bot"),g=AFRAME.utils.device.isMobile(),v=(0,a.default)("debug"),b=new URLSearchParams(location.search),y=s(433);function _(){o.default.enabled&&!o.default.isFullscreen&&o.default.request()}t.default=class{constructor(e){this.init=(()=>{this.whenSceneLoaded(()=>{this.cursorController.components["cursor-controller"].enabled=!1})}),this.hasEntered=(()=>this._entered),this.enterScene=(async(e,t)=>{const s=document.querySelector("#player-camera");s.removeAttribute("scene-preview-camera"),s.object3D.position.set(0,m,0),this.scene.setAttribute("inspector",{url:y}),v&&(NAF.connection.adapter.session.options.verbose=!0);let i=!1;t?(navigator.getVRDisplays(),i=AFRAME.utils.device.getVRDisplay().displayName.toLowerCase().indexOf("cardboard")>=0,this.scene.enterVR()):AFRAME.utils.device.isMobile()&&!AFRAME.utils.device.isIOS()&&document.body.addEventListener("touchend",_),i||this.playerRig.removeAttribute("cardboard-controls"),(g||(0,a.default)("mobile"))&&this.playerRig.setAttribute("virtual-gamepad-controls",{}),this._setupPlayerRig(),this._setupBlocking(),this._setupMedia(e),this._setupCamera(),(0,a.default)("offline")||(this._spawnAvatar(),f?this._runBot(e):(this.scene.setAttribute("motion-capture-replayer","enabled",!1),this.scene.systems["motion-capture-replayer"].remove(),e&&NAF.connection.adapter.setLocalMediaStream(e),this.scene.classList.remove("hand-cursor"),this.scene.classList.add("no-cursor"),this.cursorController.components["cursor-controller"].enabled=!0,this._entered=!0,(async()=>{for(;t&&!(await navigator.getVRDisplays()).find(e=>e.isPresenting);)await(0,l.default)();this.hubChannel.sendEntryEvent().then(()=>{this.store.update({activity:{lastEnteredAt:(new Date).toISOString()}})})})(),this.scene.addState("entered")))}),this.whenSceneLoaded=(e=>{this.scene.hasLoaded?e():this.scene.addEventListener("loaded",e)}),this.enterSceneWhenLoaded=((e,t)=>{this.whenSceneLoaded(()=>this.enterScene(e,t))}),this.exitScene=(()=>{NAF.connection.adapter&&NAF.connection.adapter.localMediaStream&&NAF.connection.adapter.localMediaStream.getTracks().forEach(e=>e.stop()),this.hubChannel&&this.hubChannel.disconnect(),this.scene.renderer&&this.scene.renderer.setAnimationLoop(null),document.body.removeChild(this.scene),document.body.removeEventListener("touchend",_)}),this._setupPlayerRig=(()=>{this._updatePlayerRigWithProfile(),this.store.addEventListener("statechanged",this._updatePlayerRigWithProfile);const e=parseInt(b.get("avatar_scale"),10);e&&this.playerRig.setAttribute("scale",{x:e,y:e,z:e})}),this._updatePlayerRigWithProfile=(()=>{const{avatarId:e,displayName:t}=this.store.state.profile;this.playerRig.setAttribute("player-info",{displayName:t,avatarSrc:e&&e.startsWith("http")?(0,u.proxiedUrlFor)(e):`#${e||"botdefault"}`});const s=this.playerRig.querySelector("[hud-controller]");s.setAttribute("hud-controller",{showTip:!this.store.state.activity.hasFoundFreeze}),this.scene.emit("username-changed",{username:t})}),this._setupBlocking=(()=>{document.body.addEventListener("blocked",e=>{NAF.connection.entities.removeEntitiesOfClient(e.detail.clientId)}),document.body.addEventListener("unblocked",e=>{NAF.connection.entities.completeSync(e.detail.clientId)})}),this._pinElement=(e=>{const{networkId:t}=e.components.networked.data,{fileId:s,src:i}=e.components["media-loader"].data;let a,n;if(s){a=new URL(i).searchParams.get("token");const e=(0,u.getPromotionTokenForFile)(s);e&&(n=e.promotionToken)}const o=(0,d.default)(e);o&&(e.setAttribute("networked",{persistent:!0}),e.setAttribute("media-loader",{fileIsOwned:!0}),this.hubChannel.pin(t,o,s,a,n))}),this._setupMedia=(e=>{const t={x:0,y:0,z:-1.5},s=(e,s)=>{const{entity:i,orientation:a}=(0,u.addMedia)(e,"#interactable-media",s,!(e instanceof MediaStream),!0);return a.then(e=>{i.setAttribute("offset-relative-to",{target:"#player-camera",offset:t,orientation:e})}),i};let i;this.scene.addEventListener("add_media",e=>{const t=e.detail instanceof File?h.ObjectContentOrigins.FILE:h.ObjectContentOrigins.URL;s(e.detail,t)}),this.scene.addEventListener("pinned",e=>{if(this.hubChannel.signedIn)this._pinElement(e.detail.el);else{const t=this.scene.is("vr-mode");t&&this.scene.exitVR();const s=t?"entry.return-to-vr":"dialog.close";this.onRequestAuthentication("sign-in.pin","sign-in.pin-complete",s,()=>{this.hubChannel.signedIn?this._pinElement(e.detail.el):e.detail.el.setAttribute("pinnable","pinned",!1),t&&this.scene.enterVR()})}}),this.scene.addEventListener("unpinned",e=>{const t=e.detail.el,s=t.components,i=s.networked;if(!i||!i.data||!NAF.utils.isMine(t))return;const a=s.networked.data.networkId;t.setAttribute("networked",{persistent:!1});const n=s["media-loader"],o=n.data&&n.data.fileId;this.hubChannel.unpin(a,o)}),this.scene.addEventListener("object_spawned",e=>{this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType)}),document.addEventListener("paste",e=>{if(e.target.matches("input, textarea")&&document.activeElement===e.target)return;const t=e.clipboardData.getData("text"),i=e.clipboardData.files&&e.clipboardData.files;if(t)s(t,h.ObjectContentOrigins.URL);else for(const e of i)s(e,h.ObjectContentOrigins.CLIPBOARD)}),document.addEventListener("dragover",e=>e.preventDefault()),document.addEventListener("drop",e=>{e.preventDefault();const t=e.dataTransfer.getData("url"),i=e.dataTransfer.files;if(t)s(t,h.ObjectContentOrigins.URL);else for(const e of i)s(e,h.ObjectContentOrigins.FILE)});let a=!1;const n=async t=>{if(a)return;a=!0;const n=await navigator.mediaDevices.getUserMedia(t),o=n?n.getVideoTracks():[];o.length>0&&(n.getVideoTracks().forEach(t=>e.addTrack(t)),NAF.connection.adapter.setLocalMediaStream(e),i=s(e,void 0),i.setAttribute("emit-scene-event-on-remove","event:action_end_video_sharing")),this.scene.emit("share_video_enabled",{source:t.video.mediaSource}),a=!1};this.scene.addEventListener("action_share_camera",()=>{n({video:{mediaSource:"camera",width:720,frameRate:30}})}),this.scene.addEventListener("action_share_window",()=>{n({video:{mediaSource:"window",width:screen.width/screen.height*720,height:720,frameRate:30}})}),this.scene.addEventListener("action_share_screen",()=>{n({video:{mediaSource:"screen",width:screen.width/screen.height*720,height:720,frameRate:30}})}),this.scene.addEventListener("action_end_video_sharing",()=>{if(!a){a=!0,i&&i.parentNode&&i.parentNode.removeChild(i);for(const t of e.getVideoTracks())e.removeTrack(t);NAF.connection.adapter.setLocalMediaStream(e),i=null,this.scene.emit("share_video_disabled"),a=!1}})}),this._setupCamera=(()=>{this.scene.addEventListener("action_spawn_camera",()=>{const e=document.createElement("a-entity");e.setAttribute("networked",{template:"#interactable-camera"}),e.setAttribute("offset-relative-to",{target:"#player-camera",offset:{x:0,y:0,z:-1.5}}),this.scene.appendChild(e)}),this.scene.addEventListener("photo_taken",e=>{this.hubChannel.sendMessage({src:e.detail},"spawn")})}),this._spawnAvatar=(()=>{this.playerRig.setAttribute("networked","template: #remote-avatar-template; attachTemplateToLocal: false;"),this.playerRig.setAttribute("networked-avatar",""),this.playerRig.emit("entered")}),this._runBot=(async e=>{console.log("Running bot"),this.playerRig.setAttribute("avatar-replay",{camera:"#player-camera",leftController:"#player-left-controller",rightController:"#player-right-controller"});const t=document.createElement("audio"),s=document.querySelector("#bot-audio-input");s.onchange=(()=>{t.loop=!0,t.muted=!0,t.crossorigin="anonymous",t.src=URL.createObjectURL(s.files[0]),document.body.appendChild(t)});const i=document.querySelector("#bot-data-input");i.onchange=(()=>{const e=URL.createObjectURL(i.files[0]);this.playerRig.setAttribute("avatar-replay",{recordingUrl:e})}),await new Promise(e=>t.addEventListener("canplay",e)),e.addTrack(t.captureStream().getAudioTracks()[0]),NAF.connection.adapter.setLocalMediaStream(e),t.play()}),this.hubChannel=e,this.store=window.APP.store,this.scene=document.querySelector("a-scene"),this.cursorController=document.querySelector("#cursor-controller"),this.playerRig=document.querySelector("#player-rig"),this._entered=!1,this.onRequestAuthentication=(()=>{})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!NAF.utils.isMine(e))return;const t=e.object3D,s=e.components,i=s.networked.data.networkId,a={},n={name:i,extensions:{HUBS_components:a}},o=(e,t)=>e.length===t.length&&e.every((e,s)=>e===t[s]),r=t.quaternion.toArray(),l=t.position.toArray(),c=t.scale.toArray();o(r,[0,0,0,1])||(n.rotation=r);o(l,[0,0,0])||(n.translation=l);o(c,[1,1,1])||(n.scale=c);if(s["media-loader"]){const e=s["media-loader"].data.src;if(e.startsWith("hubs://")&&e.endsWith("/video"))return null;a.media={src:e,id:i},s["media-pager"]&&(a.media.pageIndex=s["media-pager"].data.index),s["media-video"]&&s["media-video"].data.videoPaused&&(a.media.paused=!0,a.media.time=s["media-video"].data.time)}return a.pinnable={pinned:!0},n}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=s(27),n=(i=a,i&&i.__esModule?i:{default:i});function o(e){const t="=".repeat((4-e.length%4)%4),s=(e+t).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(s),a=new Uint8Array(i.length);for(let e=0;e<i.length;++e)a[e]=i.charCodeAt(e);return a}t.default=class{constructor(e){this.setHubChannel=(e=>{this.hubChannel=e}),this.setRegistration=(e=>{this.registration=e}),this.setRegistrationFailed=(()=>{this.registration=null}),this.setVapidPublicKey=(e=>{this.vapidPublicKey=e}),this.setSubscribed=(e=>{this._isSubscribed=e}),this.isSubscribed=(()=>this._isSubscribed),this.getCurrentEndpoint=(async()=>{if(!navigator.serviceWorker)return null;for(;void 0===this.registration;)await(0,n.default)();if(!this.registration||!this.registration.pushManager)return null;for(;void 0===this.vapidPublicKey;)await(0,n.default)();if(null===this.vapidPublicKey)return null;try{const e=o(this.vapidPublicKey);if("granted"!==await this.registration.pushManager.permissionState({userVisibleOnly:!0,applicationServerKey:e}))return null}catch(e){return null}const e=await this.registration.pushManager.getSubscription();return e?e.endpoint:null}),this.toggle=(async()=>{if(this.registration){if(this._isSubscribed){const e=await this.registration.pushManager.getSubscription(),t=await this.hubChannel.unsubscribe(e);t&&!1===t.has_remaining_subscriptions&&e.unsubscribe()}else{let e=await this.registration.pushManager.getSubscription();if(!e){const t=o(this.vapidPublicKey);e=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})}this.hubChannel.subscribe(e)}this._isSubscribed=!this._isSubscribed}}),this.hubId=e}}},function(e,t,s){"use strict";const i=new AFRAME.THREE.Vector3,a=new AFRAME.THREE.Vector3;function n(e){const t=new THREE.SphereBufferGeometry(e,10,10),s=new THREE.WireframeGeometry(t),i=new THREE.LineSegments(s);return i.material.opacity=.5,i.material.transparent=!0,i}AFRAME.registerSystem("personal-space-bubble",{schema:{debug:{default:!1},enabled:{default:!0}},init(){this.invaders=[],this.bubbles=[],this.el.addEventListener("action_space_bubble",()=>{this.el.setAttribute("personal-space-bubble",{enabled:!this.data.enabled})})},registerBubble(e){this.bubbles.push(e)},unregisterBubble(e){const t=this.bubbles.indexOf(e);-1!==t&&this.bubbles.splice(t,1)},registerInvader(e){NAF.utils.getNetworkedEntity(e.el).then(t=>{const s=NAF.utils.getNetworkOwner(t);s!==NAF.clientId&&this.invaders.push(e)})},unregisterInvader(e){const t=this.invaders.indexOf(e);-1!==t&&this.invaders.splice(t,1)},update(){for(let e=0;e<this.bubbles.length;e++)this.bubbles[e].updateDebug();for(let e=0;e<this.invaders.length;e++)this.invaders[e].updateDebug(),this.data.enabled||this.invaders[e].setInvading(!1);this.data.enabled?this.el.addState("spacebubble"):this.el.removeState("spacebubble")},tick(){if(this.data.enabled){for(let e=0;e<this.invaders.length;e++)this.invaders[e].setInvading(!1);for(let e=0;e<this.bubbles.length;e++){const t=this.bubbles[e];a.setFromMatrixPosition(t.el.object3D.matrixWorld);for(let e=0;e<this.invaders.length;e++){const s=this.invaders[e];i.setFromMatrixPosition(s.el.object3D.matrixWorld);const n=a.distanceToSquared(i),o=t.data.radius+s.data.radius;n<o*o&&s.setInvading(!0)}}}}}),AFRAME.registerComponent("space-invader-mesh",{schema:{meshName:{type:"string"}},update(){this.targetMesh=this.el.object3D.getObjectByName(this.data.meshName)}});AFRAME.registerComponent("personal-space-invader",{schema:{radius:{type:"number",default:.1},useMaterial:{default:!1},debug:{default:!1},invadingOpacity:{default:.3}},init(){const e=this.el.sceneEl.systems["personal-space-bubble"];if(e.registerInvader(this),this.data.useMaterial){const e=function(e){for(;e&&(!e.components||!e.components["space-invader-mesh"]);)e=e.parentNode;return e&&e.components["space-invader-mesh"].targetMesh}(this.el);e&&(this.targetMesh=e)}this.invading=!1},update(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},updateDebug(){const e=this.el.sceneEl.systems["personal-space-bubble"];e.data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",n(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug")},remove(){this.el.sceneEl.systems["personal-space-bubble"].unregisterInvader(this)},setInvading(e){this.targetMesh&&this.targetMesh.material?(this.targetMesh.material.opacity=e?this.data.invadingOpacity:1,this.targetMesh.material.transparent=e):this.el.object3D.visible=!e,this.invading=e}}),AFRAME.registerComponent("personal-space-bubble",{schema:{radius:{type:"number",default:.8},debug:{default:!1}},init(){this.system.registerBubble(this)},update(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},updateDebug(){this.system.data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",n(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug")},remove(){this.system.unregisterBubble(this)}})},function(e,t,s){"use strict";AFRAME.registerSystem("exit-on-blur",{init(){this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onTimeout=this.onTimeout.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.isOculusBrowser=navigator.userAgent.match(/Oculus/),this.enteredVR=!1,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),this.el.addEventListener("enter-vr",this.onEnterVR),this.lastTimeoutCheck=0,this.exitTimeout=null},tick(e){this.isOculusBrowser&&this.enteredVR&&(0===this.lastTimeoutCheck||e-this.lastTimeoutCheck>=1e3)&&(this.lastTimeoutCheck=e,clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,15e3))},onEnterVR(){this.enteredVR=!0},onBlur(){this.el.isMobile&&(clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,3e4))},onFocus(){this.el.isMobile&&clearTimeout(this.exitTimeout)},onTimeout(){this.el.dispatchEvent(new CustomEvent("exit"))},remove(){clearTimeout(this.exitTimeout),window.removeEventListener("blur",this.onBlur)}})},function(e,t,s){"use strict";AFRAME.registerSystem("camera-tools",{init(){this.cameraEls=[]},register(e){this.cameraEls.push(e),e.addEventListener("ownership-changed",this._onOwnershipChange),this.myCamera=null},deregister(e){this.cameraEls=this.cameraEls.filter(t=>t!==e),e.removeEventListener("ownership-changed",this._onOwnershipChange),this.myCamera=null},getMyCamera(){return this.myCamera?this.myCamera:(this.myCamera=this.cameraEls.find(NAF.utils.isMine),this.myCamera)},_onOwnershipChange(){this.myCamera=null}})},function(e,t,s){"use strict";var i,a=s(14),n=s(3),o=s(439),r=s(440),l=s(441),c=s(442),d=s(443),u=s(444),h=s(445),p=s(446),m=s(447),f=s(448),g=s(449),v=s(450),b=s(451),y=s(453),_=s(455),E=s(456),x=s(457),w=s(458),S=s(459),k=s(460),A=s(461),C=s(462),M=(i=C,i&&i.__esModule?i:{default:i}),R=s(463),T=s(464),D=s(465),H=s(71);const P=(0,M.default)(n.paths.device.oculusgo),L=(0,M.default)(n.paths.device.gearVRController);const O=(e,t)=>{for(const s in e.dest)if(-1!==e.dest[s].indexOf(t))return!0;return!1},I=(e,t)=>{for(const s of e)if(O(s,t))return!0;return!1},N=(e,t)=>{for(const s of Object.values(e.src))if(!s.startsWith("/device/")&&!I(t,s))return!1;return!0};function F(e,t){if(void 0===e.priority&&(e.priority=0),void 0===t.priority&&(t.priority=0),t.priority>=e.priority)return!1;for(const s in e.src){const i=e.src[s];for(const e in t.src){const s=t.src[e];if(-1!==s.indexOf(i))return!0}}return!1}function j(e,t){for(let s=0;s<e.sets.length;s++)if(t.has(e.sets[s]))return!0;return!1}AFRAME.registerSystem("userinput",{get(e){return this.frame&&this.frame[e]},toggleSet(e,t){this.pendingSetChanges.push({set:e,value:t})},init(){this.frame={},this.prevActiveSets=new Set,this.activeSets=new Set([a.sets.global]),this.pendingSetChanges=[],this.xformStates=new Map,this.activeDevices=new Set([new l.HudDevice]),AFRAME.utils.device.isMobile()?(0,H.detectInHMD)()||(this.activeDevices.add(new b.AppAwareTouchscreenDevice),this.activeDevices.add(new r.KeyboardDevice),this.activeDevices.add(new g.GyroDevice)):(this.activeDevices.add(new o.MouseDevice),this.activeDevices.add(new v.AppAwareMouseDevice),this.activeDevices.add(new r.KeyboardDevice)),this.registeredMappings=new Set([E.keyboardDebuggingBindings]),this.registeredMappingsChanged=!0;const e=new Map;e.set(f.WindowsMixedRealityControllerDevice,S.wmrUserBindings),e.set(m.ViveControllerDevice,w.viveUserBindings),e.set(h.OculusTouchControllerDevice,x.oculusTouchUserBindings),e.set(d.OculusGoControllerDevice,P),e.set(u.GearVRControllerDevice,L),e.set(p.DaydreamControllerDevice,A.daydreamUserBindings);const t=new Map;t.set(c.XboxControllerDevice,k.xboxControllerUserBindings),t.set(T.GamepadDevice,D.gamepadBindings);const s=()=>{const s=this.el.sceneEl.is("vr-mode"),i=AFRAME.utils.device.isMobile();if(s){console.log("Using VR bindings."),this.registeredMappings.delete(i?_.touchscreenUserBindings:y.keyboardMouseUserBindings);for(const t of this.activeDevices){const s=e.get(t.constructor);s&&this.registeredMappings.add(s)}}else{console.log("Using Non-VR bindings.");for(const t of this.activeDevices)this.registeredMappings.delete(e.get(t.constructor));this.registeredMappings.add(i?_.touchscreenUserBindings:y.keyboardMouseUserBindings)}for(const e of this.activeDevices){const s=t.get(e.constructor);s&&this.registeredMappings.add(s)}this.registeredMappingsChanged=!0},i=e=>{let t;for(const t of this.activeDevices)if(t.gamepad&&t.gamepad.index===e.gamepad.index)return void console.warn("connected already fired for gamepad",e.gamepad);t="OpenVR Gamepad"===e.gamepad.id?new m.ViveControllerDevice(e.gamepad):e.gamepad.id.startsWith("Oculus Touch")?new h.OculusTouchControllerDevice(e.gamepad):e.gamepad.id.startsWith("Spatial Controller")?new f.WindowsMixedRealityControllerDevice(e.gamepad):"Oculus Go Controller"===e.gamepad.id?new d.OculusGoControllerDevice(e.gamepad):"Gear VR Controller"===e.gamepad.id?new u.GearVRControllerDevice(e.gamepad):"Daydream Controller"===e.gamepad.id?new p.DaydreamControllerDevice(e.gamepad):e.gamepad.id.includes("Xbox")?new c.XboxControllerDevice(e.gamepad):new T.GamepadDevice(e.gamepad),this.activeDevices.add(t),s()};window.addEventListener("gamepadconnected",i,!1),window.addEventListener("gamepaddisconnected",i=>{for(const s of this.activeDevices)if(s.gamepad&&s.gamepad.index===i.gamepad.index)return this.registeredMappings.delete(e.get(s.constructor)||t.get(s.constructor)),void this.activeDevices.delete(s);s()},!1);for(const e of navigator.getGamepads())e&&i({gamepad:e});this.el.sceneEl.addEventListener("enter-vr",s),this.el.sceneEl.addEventListener("exit-vr",s),s()},tick(){const e=this.registeredMappingsChanged;e&&(this.registeredMappingsChanged=!1,this.prevSortedBindings=this.sortedBindings,this.sortedBindings=function(e){const t=[];for(const s of e)for(const e in s)for(const i of s[e])t.push(i);const s=[];for(;t.length>0;){const e=t.shift();N(e,s)?s.push(e):t.push(e)}return s}(this.registeredMappings),this.prevSortedBindings||(this.prevSortedBindings=this.sortedBindings),this.masks=function(e){const t=[];for(let s=0;s<e.length;s++)for(let i=0;i<e.length;i++)t[s]=t[s]||[],F(e[i],e[s])&&t[s].push(i);return t}(this.sortedBindings)),this.prevActiveSets.clear();for(const e of this.activeSets)this.prevActiveSets.add(e);(0,R.resolveActionSets)();for(const e of this.pendingSetChanges){const{set:t,value:s}=e;this.activeSets[s?"add":"delete"](t)}const t=this.prevActiveSets.size!==this.activeSets.size||function(e,t){const s=new Set;for(const i of t)e.has(i)&&s.add(i);return s}(this.prevActiveSets,this.activeSets).size!==this.activeSets.size;if(this.pendingSetChanges.length=0,e||t||!this.actives&&!this.masked){this.prevActives=this.actives,this.prevMasked=this.masked;const{actives:e,masked:t}=function(e,t,s){const i=[];for(let t=0;t<e.length;t++)i[t]=j(e[t],s);const a=[];for(let i=0;i<e.length;i++)for(let n=0;n<e.length;n++)a[i]=a[i]||[],-1!==t[i].indexOf(n)&&j(e[n],s)&&a[i].push(n);return{actives:i,masked:a}}(this.sortedBindings,this.masks,this.activeSets);this.actives=e,this.masked=t}this.frame={};for(const e of this.activeDevices)e.write(this.frame);for(let s=0;s<this.sortedBindings.length;s++){if(!this.actives[s]||this.masked[s].length>0)continue;const i=this.sortedBindings[s];let a=!0;if(!e&&t&&this.prevSortedBindings){const e=this.prevSortedBindings.indexOf(i);a=e>-1&&this.prevActives[e]&&0===this.prevMasked[e].length}a||this.xformStates.delete(i);const{src:n,dest:o,xform:r}=i,l=r(this.frame,n,o,this.xformStates.get(i));void 0!==l&&this.xformStates.set(i,l)}this.prevSortedBindings=this.sortedBindings,this.prevFrame=this.frame}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MouseDevice=void 0;var i=s(3);const a={[WheelEvent.DOM_DELTA_PIXEL]:500,[WheelEvent.DOM_DELTA_LINE]:10,[WheelEvent.DOM_DELTA_PAGE]:2};t.MouseDevice=class{constructor(){this.events=[],this.coords=[0,0],this.movementXY=[0,0],this.buttonLeft=!1,this.buttonRight=!1,this.wheel=0;const e=this.events.push.bind(this.events),t=document.querySelector("canvas");["mousedown","wheel"].map(s=>t.addEventListener(s,e)),["mousemove","mouseup"].map(t=>window.addEventListener(t,e)),document.addEventListener("wheel",e=>{e.preventDefault()})}process(e){if("wheel"===e.type)return void(this.wheel+=(e.deltaX+e.deltaY)/a[e.deltaMode]);const t=0===e.button,s=2===e.button;this.coords[0]=e.clientX/window.innerWidth*2-1,this.coords[1]=-e.clientY/window.innerHeight*2+1,this.movementXY[0]+=e.movementX,this.movementXY[1]+=e.movementY,"mousedown"===e.type&&t?this.buttonLeft=!0:"mousedown"===e.type&&s?this.buttonRight=!0:"mouseup"===e.type&&t?this.buttonLeft=!1:"mouseup"===e.type&&s&&(this.buttonRight=!1)}write(e){for(this.movementXY=[0,0],this.wheel=0,this.events.forEach(t=>{this.process(t,e)});this.events.length;)this.events.pop();e[i.paths.device.mouse.coords]=this.coords,e[i.paths.device.mouse.movementXY]=this.movementXY,e[i.paths.device.mouse.buttonLeft]=this.buttonLeft,e[i.paths.device.mouse.buttonRight]=this.buttonRight,e[i.paths.device.mouse.wheel]=this.wheel}},window.oncontextmenu=(e=>{e.preventDefault()})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardDevice=void 0;var i=s(3);t.KeyboardDevice=class{constructor(){this.keys={},this.events=[],["keydown","keyup"].map(e=>document.addEventListener(e,this.events.push.bind(this.events))),["blur"].map(e=>window.addEventListener(e,this.events.push.bind(this.events)))}write(e){for(this.events.forEach(e=>{"blur"!==e.type?this.keys[i.paths.device.keyboard.key(e.key)]="keydown"===e.type:this.keys={}});this.events.length;)this.events.pop();Object.assign(e,this.keys)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HudDevice=void 0;var i=s(3);t.HudDevice=class{constructor(){this.events=[],document.querySelector("a-scene").addEventListener("penButtonPressed",this.events.push.bind(this.events))}write(e){for(e[i.paths.device.hud.penButton]=0!==this.events.length;this.events.length;)this.events.pop()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XboxControllerDevice=void 0;var i=s(3);t.XboxControllerDevice=class{constructor(e){this.gamepad=e,this.buttonMap=[{name:"a",buttonId:0},{name:"b",buttonId:1},{name:"x",buttonId:2},{name:"y",buttonId:3},{name:"leftBumper",buttonId:4},{name:"rightBumper",buttonId:5},{name:"leftTrigger",buttonId:6},{name:"rightTrigger",buttonId:7},{name:"back",buttonId:8},{name:"start",buttonId:9},{name:"leftJoystick",buttonId:10},{name:"rightJoystick",buttonId:11},{name:"dpadUp",buttonId:12},{name:"dpadDown",buttonId:13},{name:"dpadLeft",buttonId:14},{name:"dpadRight",buttonId:15}],this.axisMap=[{name:"leftJoystickHorizontal",axisId:0},{name:"leftJoystickVertical",axisId:1},{name:"rightJoystickHorizontal",axisId:2},{name:"rightJoystickVertical",axisId:3}]}write(e){this.gamepad.connected&&(this.gamepad.buttons.forEach((t,s)=>{const a=i.paths.device.gamepad(this.gamepad.index).button(s);e[a.pressed]=!!t.pressed,e[a.touched]=!!t.touched,e[a.value]=t.value}),this.gamepad.axes.forEach((t,s)=>{e[i.paths.device.gamepad(this.gamepad.index).axis(s)]=t}),this.buttonMap.forEach(t=>{const s=i.paths.device.xbox.button(t.name);e[s.pressed]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).pressed],e[s.touched]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).touched],e[s.value]=e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).value]}),this.axisMap.forEach(t=>{e[i.paths.device.xbox.axis(t.name)]=e[i.paths.device.gamepad(this.gamepad.index).axis(t.axisId)]}))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OculusGoControllerDevice=void 0;var i=s(3),a=s(22);t.OculusGoControllerDevice=class{constructor(e){this.gamepad=e,this.rayObjectRotation=new THREE.Quaternion,this.pose=new a.Pose}write(e){if(this.gamepad.connected){e[i.paths.device.oculusgo.touchpad.axisX]=this.gamepad.axes[0],e[i.paths.device.oculusgo.touchpad.axisY]=this.gamepad.axes[1],e[i.paths.device.oculusgo.touchpad.pressed]=this.gamepad.buttons[0].pressed,e[i.paths.device.oculusgo.touchpad.touched]=this.gamepad.buttons[0].touched,e[i.paths.device.oculusgo.touchpad.value]=this.gamepad.buttons[0].value,e[i.paths.device.oculusgo.trigger.pressed]=this.gamepad.buttons[1].pressed,e[i.paths.device.oculusgo.trigger.touched]=this.gamepad.buttons[1].touched,e[i.paths.device.oculusgo.trigger.value]=this.gamepad.buttons[1].value,this.rayObject||(this.rayObject=document.querySelector(`#player-${this.gamepad.hand}-controller`).object3D),this.rayObject.updateMatricies?this.rayObject.updateMatricies():this.rayObject.updateMatrixWorld();const t=this.rayObject.matrixWorld;this.rayObjectRotation.setFromRotationMatrix(t),this.pose.position.setFromMatrixPosition(t),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e[i.paths.device.oculusgo.pose]=this.pose}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GearVRControllerDevice=void 0;var i=s(3),a=s(22);t.GearVRControllerDevice=class{constructor(e){this.gamepad=e,this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1}],this.axisMap=[{name:"touchpadX",axisId:0},{name:"touchpadY",axisId:1}],this.rayObjectRotation=new THREE.Quaternion,this.selector=`#player-${e.hand}-controller`,this.pose=new a.Pose}write(e){this.gamepad.connected&&(this.gamepad.buttons.forEach((t,s)=>{const a=i.paths.device.gamepad(this.gamepad.index).button(s);e[a.pressed]=!!t.pressed,e[a.touched]=!!t.touched,e[a.value]=t.value}),this.gamepad.axes.forEach((t,s)=>{e[i.paths.device.gamepad(this.gamepad.index).axis(s)]=t}),this.buttonMap.forEach(t=>{const s=i.paths.device.gearVRController.button(t.name);e[s.pressed]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).pressed],e[s.touched]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).touched],e[s.value]=e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).value]}),this.axisMap.forEach(t=>{e[i.paths.device.gearVRController.axis(t.name)]=e[i.paths.device.gamepad(this.gamepad.index).axis(t.axisId)]}),this.rayObject||(this.rayObject=document.querySelector(this.selector).object3D),this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e[i.paths.device.gearVRController.pose]=this.pose)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OculusTouchControllerDevice=t.rightOculusTouchButtonMap=t.leftOculusTouchButtonMap=void 0;var i=s(3),a=s(22);const n=t.leftOculusTouchButtonMap=[{name:"thumbStick",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"x",buttonId:3},{name:"y",buttonId:4}],o=t.rightOculusTouchButtonMap=[{name:"thumbStick",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"a",buttonId:3},{name:"b",buttonId:4}];t.OculusTouchControllerDevice=class{constructor(e){this.rayObjectRotation=new THREE.Quaternion,navigator.getVRDisplays();const t={left:n,right:o},s={left:i.paths.device.leftOculusTouch,right:i.paths.device.rightOculusTouch};this.gamepad=e,this.pose=new a.Pose,this.buttonMap=t[e.hand],this.axisMap=[{name:"joyX",axisId:0},{name:"joyY",axisId:1}],this.path=s[e.hand],this.selector=`#player-${e.hand}-controller`}write(e){if(this.gamepad.connected){for(let t=0;t<this.gamepad.buttons.length;t++){const s=i.paths.device.gamepad(this.gamepad.index).button(t),a=this.gamepad.buttons[t];e[s.pressed]=!!a.pressed,e[s.touched]=!!a.touched,e[s.value]=a.value}for(let t=0;t<this.gamepad.axes.length;t++){const s=this.gamepad.axes[t];e[i.paths.device.gamepad(this.gamepad.index).axis(t)]=s}this.buttonMap.forEach(t=>{const s=this.path.button(t.name);e[s.pressed]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).pressed],e[s.touched]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).touched],e[s.value]=e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).value]}),this.axisMap.forEach(t=>{e[this.path.axis(t.name)]=e[i.paths.device.gamepad(this.gamepad.index).axis(t.axisId)]}),this.rayObject=this.rayObject||document.querySelector(this.selector).object3D,this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e[this.path.pose]=this.pose}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DaydreamControllerDevice=void 0;var i=s(3),a=s(22);t.DaydreamControllerDevice=class{constructor(e){this.gamepad=e,this.buttonMap=[{name:"touchpad",buttonId:0}],this.axisMap=[{name:"touchpadX",axisId:0},{name:"touchpadY",axisId:1}],this.rayObjectRotation=new THREE.Quaternion,this.selector=`#player-${e.hand}-controller`,this.pose=new a.Pose}write(e){this.gamepad.connected&&(this.gamepad.buttons.forEach((t,s)=>{const a=i.paths.device.gamepad(this.gamepad.index).button(s);e[a.pressed]=!!t.pressed,e[a.touched]=!!t.touched,e[a.value]=t.value}),this.gamepad.axes.forEach((t,s)=>{e[i.paths.device.gamepad(this.gamepad.index).axis(s)]=t}),this.buttonMap.forEach(t=>{const s=i.paths.device.daydream.button(t.name);e[s.pressed]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).pressed],e[s.touched]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).touched],e[s.value]=e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).value]}),this.axisMap.forEach(t=>{e[i.paths.device.daydream.axis(t.name)]=e[i.paths.device.gamepad(this.gamepad.index).axis(t.axisId)]}),this.rayObject||(this.rayObject=document.querySelector(this.selector).object3D),this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e[i.paths.device.daydream.pose]=this.pose)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViveControllerDevice=void 0;var i=s(3),a=s(22);t.ViveControllerDevice=class{constructor(e){this.rayObjectRotation=new THREE.Quaternion,navigator.getVRDisplays(),this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"top",buttonId:3}],this.gamepad=e,this.pose=new a.Pose,this.axisMap=[{name:"joyX",axisId:0},{name:"joyY",axisId:1}],this.path=i.paths.device.vive[e.hand||"right"],e.hand?this.selector=`[super-hands]#player-${e.hand}-controller`:console.warn("gamepad detected without hand specified")}write(e){if(!this.gamepad.connected)return;if(this.gamepad.buttons.forEach((t,s)=>{const a=i.paths.device.gamepad(this.gamepad.index).button(s);e[a.pressed]=!!t.pressed,e[a.touched]=!!t.touched,e[a.value]=t.value}),this.gamepad.axes.forEach((t,s)=>{e[i.paths.device.gamepad(this.gamepad.index).axis(s)]=t}),this.buttonMap.forEach(t=>{const s=this.path.button(t.name);e[s.pressed]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).pressed],e[s.touched]=!!e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).touched],e[s.value]=e[i.paths.device.gamepad(this.gamepad.index).button(t.buttonId).value]}),this.axisMap.forEach(t=>{e[this.path.axis(t.name)]=e[i.paths.device.gamepad(this.gamepad.index).axis(t.axisId)]}),!this.selector){if(!this.gamepad.hand)return;this.path=i.paths.device.vive[this.gamepad.hand],this.selector=`[super-hands]#player-${this.gamepad.hand}-controller`,console.warn("gamepad hand eventually specified")}const t=document.querySelector(this.selector);t.components["tracked-controls"].controller!==this.gamepad&&(t.components["tracked-controls"].controller=this.gamepad,t.setAttribute("tracked-controls","controller",this.gamepad.index));const s=t.object3D;s.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(s.matrixWorld),this.pose.position.setFromMatrixPosition(s.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e[this.path.pose]=this.pose}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WindowsMixedRealityControllerDevice=void 0;var i=s(3),a=s(22);t.WindowsMixedRealityControllerDevice=class{constructor(e){this.rayObject=null,this.rayObjectRotation=new THREE.Quaternion,navigator.getVRDisplays(),this.gamepad=e,this.pose=new a.Pose,e.hand&&(this.selector=`#player-${e.hand}-controller`)}write(e){if(!this.gamepad.connected)return;const t=i.paths.device.wmr[this.gamepad.hand||"right"];if(e[t.touchpad.pressed]=this.gamepad.buttons[0].pressed,e[t.touchpad.touched]=this.gamepad.buttons[0].touched,e[t.touchpad.value]=this.gamepad.buttons[0].value,e[t.trigger.pressed]=this.gamepad.buttons[1].pressed,e[t.trigger.touched]=this.gamepad.buttons[1].touched,e[t.trigger.value]=this.gamepad.buttons[1].value,e[t.grip.pressed]=this.gamepad.buttons[2].pressed,e[t.grip.touched]=this.gamepad.buttons[2].touched,e[t.grip.value]=this.gamepad.buttons[2].value,e[t.menu.pressed]=this.gamepad.buttons[3].pressed,e[t.menu.touched]=this.gamepad.buttons[3].touched,e[t.menu.value]=this.gamepad.buttons[3].value,e[t.touchpad.axisX]=this.gamepad.axes[0],e[t.touchpad.axisY]=this.gamepad.axes[1],e[t.joystick.axisX]=this.gamepad.axes[2],e[t.joystick.axisY]=this.gamepad.axes[3],!this.selector){if(!this.gamepad.hand)return;this.selector=`#player-${this.gamepad.hand}-controller`}this.rayObject=this.rayObject||document.querySelector(this.selector).object3D,this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e[t.pose]=this.pose}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GyroDevice=void 0;var i=s(3);const a=2*Math.PI;class n{constructor(e){this.items=new Array(e).fill(0),this.writePtr=0}push(e){this.items[this.writePtr]=e,this.writePtr=(this.writePtr+1)%this.items.length}}const o=Math.abs,r=(e,t)=>{const s=e-t,i=e+a-t,n=e-(t+a);return o(s)<o(i)&&o(s)<o(n)?s:o(i)<o(n)?i:n},l=e=>{let t=0;for(let s=0;s<e.length;s++){const i=e[s];t+=i}return t/e.length};t.GyroDevice=class{constructor(){this.hmdEuler=new THREE.Euler,this.hmdQuaternion=new THREE.Quaternion,this.prevX=this.hmdEuler.x,this.prevY=this.hmdEuler.y,this.dXBuffer=new n(6),this.dYBuffer=new n(6),this.vrDisplay=window.webvrpolyfill.getPolyfillDisplays()[0],this.frameData=new window.webvrpolyfill.constructor.VRFrameData}write(e){const t=this.hmdEuler;this.vrDisplay.getFrameData(this.frameData),null!==this.frameData.pose.orientation&&(this.hmdQuaternion.fromArray(this.frameData.pose.orientation),t.setFromQuaternion(this.hmdQuaternion,"YXZ"));const s=THREE.Math.RAD2DEG*r(t.x,this.prevX),a=THREE.Math.RAD2DEG*r(t.y,this.prevY);this.dXBuffer.push(Math.abs(s)<.001?0:s),this.dYBuffer.push(Math.abs(a)<.001?0:a),this.averageDeltaX=l(this.dXBuffer.items),this.averageDeltaY=l(this.dYBuffer.items),this.prevX=t.x,this.prevY=t.y,e[i.paths.device.gyro.averageDeltaX]=this.averageDeltaX,e[i.paths.device.gyro.averageDeltaY]=this.averageDeltaY}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppAwareMouseDevice=void 0;var i=s(14),a=s(3),n=s(22);const o=function(e,t,s,i,a){return s.setFromMatrixPosition(e.matrixWorld),i.set(t[0],t[1],.5).unproject(e).sub(s).normalize(),a.fromOriginAndDirection(s,i),a};t.AppAwareMouseDevice=class{constructor(){this.prevButtonLeft=!1,this.clickedOnAnything=!1,this.cursorPose=new n.Pose,this.prevCursorPose=new n.Pose,this.origin=new THREE.Vector3,this.prevOrigin=new THREE.Vector3,this.direction=new THREE.Vector3,this.prevDirection=new THREE.Vector3}write(e){this.prevCursorPose.copy(this.cursorPose),this.prevOrigin.copy(this.origin),this.prevDirection.copy(this.prevDirection),this.cursorController||(this.cursorController=document.querySelector("[cursor-controller]").components["cursor-controller"]),this.camera||(this.camera=document.querySelector("#player-camera").components.camera.camera);const t=e[a.paths.device.mouse.buttonLeft],s=e[a.paths.device.mouse.buttonRight];if(t&&!this.prevButtonLeft){const e=[];this.cursorController.raycaster.intersectObjects(this.cursorController.targets,!0,e);const t=e.find(e=>e.object.el),s=AFRAME.scenes[0].systems.userinput;this.clickedOnAnything=t&&t.object.el.matches(".pen, .pen *, .video, .video *, .interactable, .interactable *")||s.activeSets.has(i.sets.cursorHoldingPen)||s.activeSets.has(i.sets.cursorHoldingInteractable)||s.activeSets.has(i.sets.cursorHoldingCamera)}this.prevButtonLeft=t,t||(this.clickedOnAnything=!1),(!this.clickedOnAnything&&t||s)&&(e[a.paths.device.smartMouse.cameraDelta]=e[a.paths.device.mouse.movementXY]);const n=e[a.paths.device.mouse.coords];e[a.paths.device.smartMouse.cursorPose]=o(this.camera,n,this.origin,this.direction,this.cursorPose)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppAwareTouchscreenDevice=void 0;var i=s(3),a=s(22),n=s(452);const o="MOVE CURSOR",r="MOVE CAMERA",l="FIRST PINCHER",c="SECOND PINCHER";function d(e,t,s,i){const a=e-s,n=t-i;return Math.sqrt(a*a+n*n)}t.AppAwareTouchscreenDevice=class{constructor(){this.raycaster=new THREE.Raycaster(new THREE.Vector3,new THREE.Vector3,0,3),this.assignments=[],this.pinch={initialDistance:0,currentDistance:0,delta:0},this.events=[],["touchstart","touchend","touchmove","touchcancel"].map(e=>document.querySelector("canvas").addEventListener(e,this.events.push.bind(this.events)))}end(e){if(!(0,n.touchIsAssigned)(e,this.assignments))return void console.warn("touch does not have a job",e);const t=(0,n.findByTouch)(e,this.assignments);switch(t.job){case o:case r:(0,n.unassign)(t.touch,t.job,this.assignments);break;case l:if((0,n.unassign)(t.touch,t.job,this.assignments),this.pinch={initialDistance:0,currentDistance:0,delta:0},(0,n.jobIsAssigned)(c,this.assignments)){const e=(0,n.findByJob)(c,this.assignments);if((0,n.unassign)(e.touch,e.job,this.assignments),(0,n.jobIsAssigned)(r,this.assignments)){const t=(0,n.assign)(e.touch,l,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY}else{const t=(0,n.assign)(e.touch,r,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY,t.delta=[0,0]}}break;case c:if((0,n.unassign)(t.touch,t.job,this.assignments),this.pinch={initialDistance:0,currentDistance:0,delta:0},(0,n.jobIsAssigned)(l,this.assignments)&&!(0,n.jobIsAssigned)(r,this.assignments)){const e=(0,n.findByJob)(l,this.assignments);(0,n.unassign)(e.touch,e.job,this.assignments);const t=(0,n.assign)(e.touch,r,this.assignments);t.clientX=e.clientX,t.clientY=e.clientY,t.delta=[0,0]}}}move(e){if(!(0,n.touchIsAssigned)(e,this.assignments))return void(e.target.classList[0]&&e.target.classList[0].startsWith("virtual-gamepad-controls")||console.warn("touch does not have job",e));const t=(0,n.findByTouch)(e,this.assignments);switch(t.job){case o:t.cursorPose.fromCameraProjection(document.querySelector("#player-camera").components.camera.camera,e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1);break;case r:t.delta[0]+=e.clientX-t.clientX,t.delta[1]+=e.clientY-t.clientY,t.clientX=e.clientX,t.clientY=e.clientY;break;case l:case c:if(t.clientX=e.clientX,t.clientY=e.clientY,(0,n.jobIsAssigned)(l,this.assignments)&&(0,n.jobIsAssigned)(c,this.assignments)){const e=(0,n.findByJob)(l,this.assignments),t=(0,n.findByJob)(c,this.assignments),s=d(e.clientX,e.clientY,t.clientX,t.clientY);this.pinch.delta+=s-this.pinch.currentDistance,this.pinch.currentDistance=s}}}start(e){if((0,n.touchIsAssigned)(e,this.assignments))console.error("touch already has a job");else{if(!(0,n.jobIsAssigned)(o,this.assignments)&&function(e,t){const s=document.querySelector("[cursor-controller]").components["cursor-controller"],i=s.data.cursor.components["super-hands"].state.has("grab-start");if(i)return!0;const a=[];t.setFromCamera({x:e.clientX/window.innerWidth*2-1,y:-e.clientY/window.innerHeight*2+1},document.querySelector("#player-camera").components.camera.camera),t.intersectObjects(s.targets,!0,a);const n=a.find(e=>e.object.el);return n&&n.object.el.matches(".interactable, .interactable *")}(e,this.raycaster)){const t=(0,n.assign)(e,o,this.assignments);return t.cursorPose=(new a.Pose).fromCameraProjection(document.querySelector("#player-camera").components.camera.camera,e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1),void(t.isFirstFrame=!0)}if(!(0,n.jobIsAssigned)(r,this.assignments)){const t=(0,n.assign)(e,r,this.assignments);return t.clientX=e.clientX,t.clientY=e.clientY,void(t.delta=[0,0])}if((0,n.jobIsAssigned)(c,this.assignments))console.warn("no job suitable for touch",e);else{let t;if((0,n.jobIsAssigned)(l,this.assignments))t=(0,n.findByJob)(l,this.assignments);else{const e=(0,n.findByJob)(r,this.assignments);(0,n.unassign)(e.touch,e.job,this.assignments),t=(0,n.assign)(e.touch,l,this.assignments),t.clientX=e.clientX,t.clientY=e.clientY}const s=(0,n.assign)(e,c,this.assignments);s.clientX=e.clientX,s.clientY=e.clientY;const i=d(t.clientX,t.clientY,s.clientX,s.clientY);this.pinch={initialDistance:i,currentDistance:i,delta:0}}}}process(e){switch(e.type){case"touchstart":for(const t of e.changedTouches)this.start(t);break;case"touchmove":for(const t of e.touches)this.move(t);break;case"touchend":case"touchcancel":for(const t of e.changedTouches)this.end(t)}}write(e){this.pinch&&(this.pinch.delta=0);const t=(0,n.jobIsAssigned)(r,this.assignments)&&(0,n.findByJob)(r,this.assignments);for(t&&(t.delta[0]=0,t.delta[1]=0),this.events.forEach(t=>{this.process(t,e)});this.events.length;)this.events.pop();const s=i.paths.device.touchscreen;if((0,n.jobIsAssigned)(o,this.assignments)){const t=(0,n.findByJob)(o,this.assignments);e[s.cursorPose]=t.cursorPose,e[s.isTouchingGrabbable]=!t.isFirstFrame,t.isFirstFrame=!1}(0,n.jobIsAssigned)(r,this.assignments)&&(e[s.touchCameraDelta]=(0,n.findByJob)(r,this.assignments).delta),e[s.pinch.delta]=this.pinch.delta,e[s.pinch.initialDistance]=this.pinch.initialDistance,e[s.pinch.currentDistance]=this.pinch.currentDistance}}},function(e,t,s){"use strict";function i(e,t){return void 0!==t.find(t=>t.touch.identifier===e.identifier)}function a(e,t){return void 0!==t.find(t=>t.job===e)}Object.defineProperty(t,"__esModule",{value:!0}),t.touchIsAssigned=i,t.jobIsAssigned=a,t.assign=function(e,t,s){if(i(e,s)||a(t,s))return void console.error("cannot reassign touches or jobs. unassign first");const n={job:t,touch:e};return s.push(n),n},t.unassign=function(e,t,s){s.splice(s.findIndex(function(s){return s.touch.identifier===e.identifier&&s.job===t}),1)},t.findByJob=function(e,t){return t.find(t=>t.job===e)},t.findByTouch=function(e,t){return t.find(t=>t.touch.identifier===e.identifier)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardMouseUserBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);const r="/var/mouse-and-keyboard/wasd_vec2",l="/var/mouse-and-keyboard/arrows_vec2",c="/vars/mouse-and-keyboard/drop_with_RMB",d="/vars/mouse-and-keyboard/drop_with_esc",u=e=>`/keyboard-mouse-user/keyboard-var/${e}`;t.keyboardMouseUserBindings=(0,o.addSetsToBindings)({[a.sets.global]:[{src:{w:i.paths.device.keyboard.key("arrowup"),a:i.paths.device.keyboard.key("arrowleft"),s:i.paths.device.keyboard.key("arrowdown"),d:i.paths.device.keyboard.key("arrowright")},dest:{vec2:l},xform:n.xforms.wasd_to_vec2},{src:{w:i.paths.device.keyboard.key("w"),a:i.paths.device.keyboard.key("a"),s:i.paths.device.keyboard.key("s"),d:i.paths.device.keyboard.key("d")},dest:{vec2:r},xform:n.xforms.wasd_to_vec2},{src:{first:r,second:l},dest:{value:"/var/mouse-and-keyboard/keyboardCharacterAcceleration"},xform:n.xforms.max_vec2},{src:{value:"/var/mouse-and-keyboard/keyboardCharacterAcceleration"},dest:{value:i.paths.actions.characterAcceleration},xform:n.xforms.normalize_vec2},{src:{value:i.paths.device.keyboard.key("shift")},dest:{value:i.paths.actions.boost},xform:n.xforms.copy},{src:{value:i.paths.device.keyboard.key("Escape")},dest:{value:i.paths.actions.camera.exitMirror},xform:n.xforms.falling},{src:{value:i.paths.device.keyboard.key("q")},dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("e")},dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key(" ")},dest:{value:i.paths.actions.ensureFrozen},xform:n.xforms.copy},{src:{value:i.paths.device.keyboard.key(" ")},dest:{value:i.paths.actions.thaw},xform:n.xforms.falling},{src:{value:i.paths.device.hud.penButton},dest:{value:i.paths.actions.spawnPen},xform:n.xforms.rising},{src:{value:i.paths.device.smartMouse.cursorPose},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.copy},{src:{value:i.paths.device.smartMouse.cameraDelta},dest:{x:"/var/smartMouseCamDeltaX",y:"/var/smartMouseCamDeltaY"},xform:n.xforms.split_vec2},{src:{value:"/var/smartMouseCamDeltaX"},dest:{value:"/var/smartMouseCamDeltaXScaled"},xform:n.xforms.scale(-.2)},{src:{value:"/var/smartMouseCamDeltaY"},dest:{value:"/var/smartMouseCamDeltaYScaled"},xform:n.xforms.scale(-.1)},{src:{x:"/var/smartMouseCamDeltaXScaled",y:"/var/smartMouseCamDeltaYScaled"},dest:{value:i.paths.actions.cameraDelta},xform:n.xforms.compose_vec2},{src:{value:i.paths.device.keyboard.key("m")},dest:{value:i.paths.actions.muteMic},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("t")},dest:{value:i.paths.actions.focusChat},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("l")},dest:{value:i.paths.actions.logDebugFrame},xform:n.xforms.rising},{src:{value:i.paths.device.mouse.buttonRight},dest:{value:i.paths.actions.startGazeTeleport},xform:n.xforms.rising,priority:100},{src:{value:i.paths.device.mouse.buttonRight},dest:{value:i.paths.actions.stopGazeTeleport},xform:n.xforms.falling,priority:100}],[a.sets.cursorHoldingPen]:[{src:{bool:i.paths.device.keyboard.key("shift"),value:i.paths.device.keyboard.key("q")},dest:{value:"/var/shift+q"},xform:n.xforms.copyIfTrue},{src:{value:"/var/shift+q"},dest:{value:i.paths.actions.cursor.penPrevColor},xform:n.xforms.rising},{src:{bool:i.paths.device.keyboard.key("shift"),value:i.paths.device.keyboard.key("e")},dest:{value:"/var/shift+e"},xform:n.xforms.copyIfTrue},{src:{value:"/var/shift+e"},dest:{value:i.paths.actions.cursor.penNextColor},xform:n.xforms.rising},{src:{bool:i.paths.device.keyboard.key("shift"),value:i.paths.device.keyboard.key("q")},dest:{value:"/var/notshift+q"},xform:n.xforms.copyIfFalse},{src:{value:"/var/notshift+q"},dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.rising,priority:200},{src:{bool:i.paths.device.keyboard.key("shift"),value:i.paths.device.keyboard.key("e")},dest:{value:"/var/notshift+e"},xform:n.xforms.copyIfFalse},{src:{value:"/var/notshift+e"},dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.rising,priority:200},{src:{value:i.paths.device.mouse.buttonLeft},dest:{value:i.paths.actions.cursor.startDrawing},xform:n.xforms.rising,priority:3},{src:{value:i.paths.device.mouse.buttonLeft},dest:{value:i.paths.actions.cursor.stopDrawing},xform:n.xforms.falling,priority:3},{src:{value:u("wheelWithShift")},dest:{value:"/var/cursorScalePenTipWheel"},xform:n.xforms.copy,priority:200},{src:{value:"/var/cursorScalePenTipWheel"},dest:{value:i.paths.actions.cursor.scalePenTip},xform:n.xforms.scale(.03)},{src:{value:i.paths.device.mouse.buttonRight},dest:{value:c},xform:n.xforms.falling,priority:200},{src:{value:i.paths.device.keyboard.key("Escape")},dest:{value:d},xform:n.xforms.falling},{src:[c,d],dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.any},{src:{bool:i.paths.device.keyboard.key("control"),value:i.paths.device.keyboard.key("z")},dest:{value:i.paths.actions.cursor.undoDrawing},xform:n.xforms.rising}],[a.sets.cursorHoldingCamera]:[{src:{value:i.paths.device.mouse.buttonLeft},dest:{value:i.paths.actions.cursor.takeSnapshot},xform:n.xforms.rising,priority:3},{src:{value:i.paths.device.mouse.buttonRight},dest:{value:c},xform:n.xforms.falling,priority:200},{src:{value:i.paths.device.keyboard.key("Escape")},dest:{value:d},xform:n.xforms.falling},{src:[c,d],dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.any}],[a.sets.cursorHoldingInteractable]:[{src:{bool:i.paths.device.keyboard.key("shift"),value:i.paths.device.mouse.wheel},dest:{value:u("wheelWithShift")},xform:n.xforms.copyIfTrue},{src:{bool:i.paths.device.keyboard.key("shift"),value:i.paths.device.mouse.wheel},dest:{value:u("wheelWithoutShift")},xform:n.xforms.copyIfFalse},{src:{value:u("wheelWithoutShift")},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.copy},{src:{value:u("wheelWithShift")},dest:{value:i.paths.actions.cursor.scaleGrabbedGrabbable},xform:n.xforms.copy},{src:{value:i.paths.device.mouse.buttonLeft},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.falling,priority:2}],[a.sets.cursorHoveringOnInteractable]:[{src:{value:i.paths.device.mouse.buttonLeft},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.rising,priority:1}],[a.sets.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:i.paths.noop},xform:n.xforms.noop,priority:1e3}],[a.sets.cursorHoveringOnUI]:[{src:{value:i.paths.device.mouse.buttonLeft},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.rising}]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.angleTo4Direction=function(e){return e=(e*THREE.Math.RAD2DEG+180+45)%360,e>0&&e<90?"north":e>=90&&e<180?"west":e>=180&&e<270?"south":"east"},t.angleTo8Direction=function(e){e=(e*THREE.Math.RAD2DEG+180+45)%360;let t="";(e>=0&&e<120||e>=330)&&(t+="north");e>=150&&e<300&&(t+="south");e>=60&&e<210&&(t+="west");(e>=240&&e<360||e<30)&&(t+="east");return t}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.touchscreenUserBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);const r="/vars/touchscreen/zero",l="/vars/touchscreen/pinchDeltaForward";t.touchscreenUserBindings=(0,o.addSetsToBindings)({[a.sets.global]:[{src:{value:i.paths.device.touchscreen.pinch.delta},dest:{value:l},xform:n.xforms.scale(.25)},{src:{},dest:{value:r},xform:n.xforms.always(0)},{src:{x:r,y:l},dest:{value:i.paths.actions.characterAcceleration},xform:n.xforms.compose_vec2},{src:{value:i.paths.device.touchscreen.cursorPose},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.copy},{src:{value:i.paths.device.touchscreen.touchCameraDelta},dest:{x:"vars/touchscreen/touchCameraDelta/x",y:"vars/touchscreen/touchCameraDelta/y"},xform:n.xforms.split_vec2},{src:{value:"vars/touchscreen/touchCameraDelta/x"},dest:{value:"vars/touchscreen/touchCameraDelta/x/scaled"},xform:n.xforms.scale(.18)},{src:{value:"vars/touchscreen/touchCameraDelta/y"},dest:{value:"vars/touchscreen/touchCameraDelta/y/scaled"},xform:n.xforms.scale(.35)},{src:{x:"vars/touchscreen/touchCameraDelta/x/scaled",y:"vars/touchscreen/touchCameraDelta/y/scaled"},dest:{value:"vars/touchscreen/touchCameraDelta"},xform:n.xforms.compose_vec2},{src:{value:i.paths.device.gyro.averageDeltaX},dest:{value:"vars/gyro/gyroCameraDelta/x/scaled"},xform:n.xforms.scale(1)},{src:{value:i.paths.device.gyro.averageDeltaY},dest:{value:"vars/gyro/gyroCameraDelta/y/scaled"},xform:n.xforms.scale(1)},{src:{x:"vars/gyro/gyroCameraDelta/y/scaled",y:"vars/gyro/gyroCameraDelta/x/scaled"},dest:{value:"vars/gyro/gyroCameraDelta"},xform:n.xforms.compose_vec2},{src:{first:"vars/touchscreen/touchCameraDelta",second:"vars/gyro/gyroCameraDelta"},dest:{value:i.paths.actions.cameraDelta},xform:n.xforms.add_vec2},{src:{value:i.paths.device.touchscreen.isTouchingGrabbable},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.copy},{src:{value:i.paths.device.hud.penButton},dest:{value:i.paths.actions.spawnPen},xform:n.xforms.rising}],[a.sets.cursorHoldingInteractable]:[{src:{value:i.paths.device.touchscreen.isTouchingGrabbable},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.falling,priority:1}],[a.sets.cursorHoveringOnPen]:[],[a.sets.cursorHoldingPen]:[{src:{value:i.paths.device.touchscreen.isTouchingGrabbable},dest:{value:i.paths.actions.cursor.startDrawing},xform:n.xforms.risingWithFrameDelay(5),priority:2},{src:{value:i.paths.device.touchscreen.isTouchingGrabbable},dest:{value:i.paths.actions.cursor.stopDrawing},xform:n.xforms.falling,priority:2},{src:{value:i.paths.device.hud.penButton},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.rising,priority:1}]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardDebuggingBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);t.keyboardDebuggingBindings=(0,o.addSetsToBindings)({[a.sets.global]:[{src:{value:i.paths.device.keyboard.key("l")},dest:{value:i.paths.actions.logDebugFrame},xform:n.xforms.rising}]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.oculusTouchUserBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);const r="/touch/var/",l=i.paths.device.leftOculusTouch.button,c=i.paths.device.leftOculusTouch.axis,d=i.paths.device.leftOculusTouch.pose,u=i.paths.device.rightOculusTouch.button,h=i.paths.device.rightOculusTouch.axis,p=i.paths.device.rightOculusTouch.pose,m=`${r}left/scaledJoyX`,f=`${r}left/scaledJoyY`,g=`${r}right/cursorDrop2`,v=`${r}right/cursorDrop1`,b=`${r}right/rightHandDrop2`,y=`${r}right/grip/RisingGrab`,_=`${r}right/trigger/RisingGrab`,E=`${r}left/grip/RisingGrab`,x=`${r}left/trigger/RisingGrab`,w=`${r}rightDpad/north`,S=`${r}rightDpad/south`,k=`${r}rightDpad/east`,A=`${r}rightDpad/west`,C=`${r}rightDpad/center`,M=`${r}right/joy`,R=`${r}right/joyY1`,T=`${r}right/joyY2`,D=`${r}leftDpad/north`,H=`${r}leftDpad/south`,P=`${r}leftDpad/east`,L=`${r}leftDpad/west`,O=`${r}leftDpad/center`,I=`${r}left/joy`,N=`${r}left/joyY`,F=`${r}characterAcceleration`,j=`${r}/right/snap-right`,B=`${r}/right/snap-left`,V=`${r}/keyboard/snap-right`,U=`${r}/keyboard/snap-left`,W=`${r}buttons/lower`,z=`${r}buttons/ensureFrozen`,G=`${r}keyboard/ensureFrozen`,$=`${r}buttons/thaw`,q=`${r}keyboard/thaw`,Y=e=>"/oculus-touch-user-vars/"+e,X=Y("leftGripPressed1"),J=Y("leftGripPressed2"),Q=Y("rightGripPressed1"),K=Y("rightGripPressed2"),Z=Y("leftTriggerPressed1"),ee=Y("leftTriggerPressed2"),te=Y("rightTriggerPressed1"),se=Y("rightTriggerPressed2");t.oculusTouchUserBindings=(0,o.addSetsToBindings)({[a.sets.global]:[{src:[z,G],dest:{value:i.paths.actions.ensureFrozen},xform:n.xforms.any},{src:[$,q],dest:{value:i.paths.actions.thaw},xform:n.xforms.any},{src:{value:l("grip").pressed},dest:{value:X},xform:n.xforms.copy},{src:{value:l("grip").pressed},dest:{value:J},xform:n.xforms.copy},{src:{value:X},dest:{value:i.paths.actions.leftHand.middleRingPinky},xform:n.xforms.copy},{src:[l("x").touched,l("y").touched,l("thumbStick").touched],dest:{value:i.paths.actions.leftHand.thumb},xform:n.xforms.any},{src:{value:l("trigger").pressed},dest:{value:Z},xform:n.xforms.copy},{src:{value:l("trigger").pressed},dest:{value:ee},xform:n.xforms.copy},{src:{value:Z},dest:{value:i.paths.actions.leftHand.index},xform:n.xforms.copy},{src:{value:u("grip").pressed},dest:{value:Q},xform:n.xforms.copy},{src:{value:u("grip").pressed},dest:{value:K},xform:n.xforms.copy},{src:{value:Q},dest:{value:i.paths.actions.rightHand.middleRingPinky},xform:n.xforms.copy},{src:[u("a").touched,u("b").touched,u("thumbStick").touched],dest:{value:i.paths.actions.rightHand.thumb},xform:n.xforms.any},{src:{value:u("trigger").pressed},dest:{value:te},xform:n.xforms.copy},{src:{value:u("trigger").pressed},dest:{value:se},xform:n.xforms.copy},{src:{value:te},dest:{value:i.paths.actions.rightHand.index},xform:n.xforms.copy},{src:{x:c("joyX"),y:c("joyY")},dest:{value:I},xform:n.xforms.compose_vec2},{src:{value:I},dest:{north:D,south:H,east:P,west:L,center:O},xform:n.xforms.vec2dpad(.2,!1,!0)},{src:{value:h("joyY")},dest:{value:R},xform:n.xforms.copy},{src:{value:h("joyY")},dest:{value:T},xform:n.xforms.copy},{src:{x:h("joyX"),y:R},dest:{value:M},xform:n.xforms.compose_vec2},{src:{value:M},dest:{north:w,south:S,east:k,west:A,center:C},xform:n.xforms.vec2dpad(.2,!1,!0)},{src:{value:k},dest:{value:j},xform:n.xforms.rising,priority:1},{src:{value:i.paths.device.keyboard.key("e")},dest:{value:V},xform:n.xforms.rising},{src:[j,V],dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.any},{src:{value:i.paths.device.keyboard.key(" ")},dest:{value:G},xform:n.xforms.copy},{src:[l("x").pressed,u("a").pressed],dest:{value:W},xform:n.xforms.any},{src:{value:W},dest:{value:z},xform:n.xforms.copy},{src:{value:W},dest:{value:$},xform:n.xforms.falling},{src:{value:i.paths.device.keyboard.key(" ")},dest:{value:q},xform:n.xforms.falling},{src:{value:A},dest:{value:B},xform:n.xforms.rising,priority:1},{src:{value:i.paths.device.keyboard.key("q")},dest:{value:U},xform:n.xforms.rising},{src:[B,U],dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.any},{src:{value:c("joyX")},dest:{value:m},xform:n.xforms.scale(1.5)},{src:{value:c("joyY")},dest:{value:f},xform:n.xforms.scale(-1.5)},{src:{x:m,y:f},dest:{value:F},xform:n.xforms.compose_vec2},{src:{w:i.paths.device.keyboard.key("arrowup"),a:i.paths.device.keyboard.key("arrowleft"),s:i.paths.device.keyboard.key("arrowdown"),d:i.paths.device.keyboard.key("arrowright")},dest:{vec2:"/var/keyboard/arrows_vec2"},xform:n.xforms.wasd_to_vec2},{src:{w:i.paths.device.keyboard.key("w"),a:i.paths.device.keyboard.key("a"),s:i.paths.device.keyboard.key("s"),d:i.paths.device.keyboard.key("d")},dest:{vec2:"/var/keyboard/wasd_vec2"},xform:n.xforms.wasd_to_vec2},{src:{first:"/var/keyboard/wasd_vec2",second:"/var/keyboard/arrows_vec2"},dest:{value:"/var/keyboard/characterAcceleration"},xform:n.xforms.max_vec2},{src:{first:F,second:"/var/keyboard/characterAcceleration"},dest:{value:"/var/oculus-touch/nonNormalizedCharacterAcceleration"},xform:n.xforms.max_vec2},{src:{value:"/var/oculus-touch/nonNormalizedCharacterAcceleration",override:"/device/overrides/foo"},dest:{value:i.paths.actions.characterAcceleration},xform:n.xforms.normalize_vec2},{src:{value:i.paths.device.keyboard.key("shift")},dest:{value:"/var/keyboard-oculus/boost"},xform:n.xforms.copy},{src:{value:l("y").pressed},dest:{value:"/var/left-oculus/boost"},xform:n.xforms.copy},{src:{value:u("b").pressed},dest:{value:"/var/right-oculus/boost"},xform:n.xforms.copy},{src:["/var/keyboard-oculus/boost","/var/left-oculus/boost","/var/right-oculus/boost"],dest:{value:i.paths.actions.boost},xform:n.xforms.any},{src:{value:i.paths.device.keyboard.key("t")},dest:{value:i.paths.actions.focusChat},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("l")},dest:{value:i.paths.actions.logDebugFrame},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("m")},dest:{value:i.paths.actions.muteMic},xform:n.xforms.rising},{src:{value:p},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.copy},{src:{value:p},dest:{value:i.paths.actions.rightHand.pose},xform:n.xforms.copy},{src:{value:d},dest:{value:i.paths.actions.leftHand.pose},xform:n.xforms.copy},{src:{value:se},dest:{value:i.paths.actions.rightHand.stopTeleport},xform:n.xforms.falling,priority:1},{src:{value:ee},dest:{value:i.paths.actions.leftHand.stopTeleport},xform:n.xforms.falling,priority:1}],[a.sets.leftHandHoveringOnNothing]:[{src:{value:ee},dest:{value:i.paths.actions.leftHand.startTeleport},xform:n.xforms.rising,priority:1}],[a.sets.cursorHoveringOnUI]:[{src:{value:se},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.rising,priority:2}],[a.sets.cursorHoveringOnNothing]:[{src:{value:se},dest:{value:i.paths.actions.rightHand.startTeleport},xform:n.xforms.rising,priority:1}],[a.sets.leftHandHoveringOnInteractable]:[{src:{value:J},dest:{value:E},xform:n.xforms.rising},{src:{value:ee},dest:{value:x},xform:n.xforms.rising,priority:2},{src:[E],dest:{value:i.paths.actions.leftHand.grab},xform:n.xforms.any,priority:2}],[a.sets.leftHandHoldingInteractable]:[{src:{value:J},dest:{value:i.paths.actions.leftHand.drop},xform:n.xforms.falling},{src:{},dest:{value:z},priority:1,xform:n.xforms.always(!1)}],[a.sets.leftHandHoveringOnPen]:[],[a.sets.leftHandHoldingPen]:[{src:{value:ee},dest:{value:i.paths.actions.leftHand.startDrawing},xform:n.xforms.rising,priority:3},{src:{value:ee},dest:{value:i.paths.actions.leftHand.stopDrawing},xform:n.xforms.falling,priority:3},{src:{value:P,override:"/device/overrides/foo"},dest:{value:i.paths.actions.leftHand.penNextColor},xform:n.xforms.rising,priority:2},{src:{value:L,override:"/device/overrides/foo"},dest:{value:i.paths.actions.leftHand.penPrevColor},xform:n.xforms.rising,priority:2},{src:{value:c("joyY")},dest:{value:N},xform:n.xforms.copy},{src:{value:N},dest:{value:i.paths.actions.leftHand.scalePenTip},xform:n.xforms.scale(-.005),priority:1},{src:{value:l("y").pressed},dest:{value:i.paths.actions.leftHand.undoDrawing},xform:n.xforms.rising,priority:1}],[a.sets.cursorHoveringOnInteractable]:[{src:{value:K},dest:{value:y},xform:n.xforms.rising,priority:2},{src:{value:se},dest:{value:_},xform:n.xforms.rising,priority:2},{src:[y],dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.any,priority:2}],[a.sets.cursorHoldingInteractable]:[{src:{value:h("joyY")},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.scale(.1)},{src:{value:K},dest:{value:v},xform:n.xforms.falling,priority:3},{src:{value:se},dest:{value:g},xform:n.xforms.falling,priority:2},{src:[v],dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.any,priority:2},{src:{},dest:{value:z},priority:1,xform:n.xforms.always(!1)}],[a.sets.cursorHoveringOnPen]:[],[a.sets.cursorHoldingPen]:[{src:{value:se},dest:{value:i.paths.actions.cursor.startDrawing},xform:n.xforms.rising,priority:3},{src:{value:se},dest:{value:i.paths.actions.cursor.stopDrawing},xform:n.xforms.falling,priority:3},{src:{value:u("b").pressed},dest:{value:i.paths.actions.cursor.undoDrawing},xform:n.xforms.rising,priority:1}],[a.sets.rightHandHoveringOnInteractable]:[{src:{value:K},dest:{value:y},xform:n.xforms.rising,priority:2},{src:{value:se},dest:{value:_},xform:n.xforms.rising,priority:2},{src:[y],dest:{value:i.paths.actions.rightHand.grab},xform:n.xforms.any,priority:2}],[a.sets.rightHandHoldingInteractable]:[{src:{value:K},dest:{value:b},xform:n.xforms.falling,priority:3},{src:[b],dest:{value:i.paths.actions.rightHand.drop},xform:n.xforms.any,priority:2},{src:{},dest:{value:z},priority:1,xform:n.xforms.always(!1)}],[a.sets.rightHandHoveringOnPen]:[],[a.sets.rightHandHoldingPen]:[{src:{value:se},dest:{value:i.paths.actions.rightHand.startDrawing},xform:n.xforms.rising,priority:3},{src:{value:se},dest:{value:i.paths.actions.rightHand.stopDrawing},xform:n.xforms.falling,priority:3},{src:{value:k},dest:{value:i.paths.actions.rightHand.penNextColor},xform:n.xforms.rising,priority:2},{src:{value:A},dest:{value:i.paths.actions.rightHand.penPrevColor},xform:n.xforms.rising,priority:2},{src:{value:T},dest:{value:i.paths.actions.rightHand.scalePenTip},xform:n.xforms.scale(-.005),priority:2},{src:{value:K},dest:{value:i.paths.actions.rightHand.drop},xform:n.xforms.falling,priority:3},{src:{value:u("b").pressed},dest:{value:i.paths.actions.rightHand.undoDrawing},xform:n.xforms.rising,priority:1}],[a.sets.cursorHoveringOnCamera]:[],[a.sets.rightHandHoveringOnCamera]:[],[a.sets.leftHandHoveringOnCamera]:[],[a.sets.rightHandHoldingCamera]:[{src:{value:se},dest:{value:i.paths.actions.rightHand.takeSnapshot},xform:n.xforms.rising,priority:4}],[a.sets.leftHandHoldingCamera]:[{src:{value:ee},dest:{value:i.paths.actions.leftHand.takeSnapshot},xform:n.xforms.rising,priority:4}],[a.sets.cursorHoldingCamera]:[{src:{value:se},dest:{value:i.paths.actions.cursor.takeSnapshot},xform:n.xforms.rising,priority:4}],[a.sets.rightHandHoveringOnNothing]:[],[a.sets.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:i.paths.noop},xform:n.xforms.noop,priority:1e3}]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.viveUserBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);const r=e=>`/vive-user/vive-var/${e}`,l=i.paths.device.vive.left.button,c=i.paths.device.vive.left.axis,d=i.paths.device.vive.left.pose,u=r("left/joy"),h=r("left/joy/scaled"),p=r("left/joyX/scaled"),m=r("left/joyY/scaled"),f=r("left/dpad/north"),g=r("left/dpad/south"),v=r("left/dpad/east"),b=r("left/dpad/west"),y=r("left/dpad/center"),_=r("left/trigger/falling/stopDrawing"),E=r("left/grip/falling/stopDrawing"),x=r("right/trigger/rising/grab"),w=r("right/grab/rising/grab"),S=r("left/touchpad/rising2"),k=r("left/touchpad/rising1"),A=r("left/characterAcceleration"),C=r("nonNormalizedCharacterAcceleration"),M=r("left/boost"),R=i.paths.device.vive.right.button,T=i.paths.device.vive.right.axis,D=i.paths.device.vive.right.pose,H=r("right/joy"),P=r("right/dpad/north"),L=r("right/dpad/south"),O=r("right/dpad/east"),I=r("right/dpad/west"),N=r("right/dpad/center"),F=r("right/dpad/centerStrip"),j=r("right/touchpad/rising"),B=r("right/touchpad/falling"),V=r("right/boost"),U=r("right/trigger/rising/grab"),W=r("right/grab/rising/grab"),z=r("right/cursorDrop1"),G=r("right/cursorDrop2"),$=r("right/drop1"),q=r("right/drop2"),Y=r("right/trigger/stopTeleport"),X=r("right/touchpad/stopTeleport"),J=r("dpad/ensureFrozen"),Q=r("keyboard/ensureFrozen"),K=r("dpad/thaw"),Z=r("keyboard/thaw"),ee=r("right/snap-right"),te=r("right/snap-left"),se=e=>`/vive-user/keyboard-var/${e}`,ie=se("snap-right"),ae=se("snap-left"),ne=se("characterAcceleration"),oe=se("wasd_vec2"),re=se("arrows_vec2"),le=se("boost"),ce=r("leftGripPressed1"),de=r("leftGripPressed2"),ue=r("rightGripPressed1"),he=r("rightGripPressed2"),pe=r("leftTriggerPressed1"),me=r("leftTriggerPressed2"),fe=r("leftTouchpadPressed1"),ge=r("leftTouchpadPressed2"),ve=r("rightTriggerPressed1"),be=r("rightTriggerPressed2"),ye=r("leftTouchpadFallingStopTeleport"),_e=r("leftTriggerFallingStopTeleport"),Ee=r("leftGripFallingWhileHoldingPen");t.viveUserBindings=(0,o.addSetsToBindings)({[a.sets.global]:[{src:[J,Q],dest:{value:i.paths.actions.ensureFrozen},xform:n.xforms.any},{src:[K,Z],dest:{value:i.paths.actions.thaw},xform:n.xforms.any},{src:{value:l("grip").pressed},dest:{value:ce},xform:n.xforms.copy},{src:{value:ce},dest:{value:i.paths.actions.leftHand.middleRingPinky},xform:n.xforms.copy},{src:{value:l("grip").pressed},dest:{value:de},xform:n.xforms.copy},{src:[l("touchpad").touched,l("top").touched],dest:{value:i.paths.actions.leftHand.thumb},xform:n.xforms.any},{src:{value:pe},dest:{value:i.paths.actions.leftHand.index},xform:n.xforms.copy},{src:{value:l("trigger").pressed},dest:{value:pe},xform:n.xforms.copy},{src:{value:l("trigger").pressed},dest:{value:me},xform:n.xforms.copy},{src:{value:R("grip").pressed},dest:{value:ue},xform:n.xforms.copy},{src:{value:R("grip").pressed},dest:{value:he},xform:n.xforms.copy},{src:{value:ue},dest:{value:i.paths.actions.rightHand.middleRingPinky},xform:n.xforms.copy},{src:[R("touchpad").touched,R("top").touched],dest:{value:i.paths.actions.rightHand.thumb},xform:n.xforms.any},{src:{value:R("trigger").pressed},dest:{value:ve},xform:n.xforms.copy},{src:{value:R("trigger").pressed},dest:{value:be},xform:n.xforms.copy},{src:{value:ve},dest:{value:i.paths.actions.rightHand.index},xform:n.xforms.copy},{src:{x:c("joyX"),y:c("joyY")},dest:{value:u},xform:n.xforms.compose_vec2},{src:{value:u},dest:{north:f,south:g,east:v,west:b,center:y},xform:n.xforms.vec2dpad(.35)},{src:{value:l("touchpad").pressed},dest:{value:fe},xform:n.xforms.copy},{src:{value:l("touchpad").pressed},dest:{value:ge},xform:n.xforms.copy},{src:{x:T("joyX"),y:T("joyY")},dest:{value:H},xform:n.xforms.compose_vec2},{src:{value:H},dest:{north:P,south:L,east:O,west:I,center:N},xform:n.xforms.vec2dpad(.35,!1,!0)},{src:[P,L,N],dest:{value:F},xform:n.xforms.any},{src:{value:R("touchpad").pressed},dest:{value:j},xform:n.xforms.rising},{src:{value:R("touchpad").pressed},dest:{value:B},xform:n.xforms.falling},{src:{bool:j,value:O},dest:{value:ee},xform:n.xforms.copyIfTrue,priority:1},{src:{value:i.paths.device.keyboard.key("e")},dest:{value:ie},xform:n.xforms.rising},{src:[ee,ie],dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.any},{src:{value:i.paths.device.keyboard.key(" ")},dest:{value:Q},xform:n.xforms.copy},{src:{value:i.paths.device.keyboard.key(" ")},dest:{value:Z},xform:n.xforms.falling},{src:{value:R("touchpad").pressed,bool:F},dest:{value:J},root:"rootForFrozenOverrideWhenHolding",xform:n.xforms.copyIfTrue},{src:{value:B},dest:{value:K},xform:n.xforms.copy},{src:{bool:j,value:I},dest:{value:te},xform:n.xforms.copyIfTrue,priority:1},{src:{value:i.paths.device.keyboard.key("q")},dest:{value:ae},xform:n.xforms.rising},{src:[te,ae],dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.any},{src:{value:c("joyX")},dest:{value:p},xform:n.xforms.scale(1.5)},{src:{value:c("joyY")},dest:{value:m},xform:n.xforms.scale(1.5)},{src:{x:p,y:m},dest:{value:h},xform:n.xforms.compose_vec2},{src:{bool:ge,value:h},dest:{value:A},xform:n.xforms.copyIfTrue},{src:{w:i.paths.device.keyboard.key("arrowup"),a:i.paths.device.keyboard.key("arrowleft"),s:i.paths.device.keyboard.key("arrowdown"),d:i.paths.device.keyboard.key("arrowright")},dest:{vec2:re},xform:n.xforms.wasd_to_vec2},{src:{w:i.paths.device.keyboard.key("w"),a:i.paths.device.keyboard.key("a"),s:i.paths.device.keyboard.key("s"),d:i.paths.device.keyboard.key("d")},dest:{vec2:oe},xform:n.xforms.wasd_to_vec2},{src:{value:i.paths.device.keyboard.key("t")},dest:{value:i.paths.actions.focusChat},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("l")},dest:{value:i.paths.actions.logDebugFrame},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("m")},dest:{value:i.paths.actions.muteMic},xform:n.xforms.rising},{src:{first:oe,second:re},dest:{value:ne},xform:n.xforms.max_vec2},{src:{first:A,second:ne},dest:{value:C},xform:n.xforms.max_vec2},{src:{value:C},dest:{value:i.paths.actions.characterAcceleration},xform:n.xforms.normalize_vec2},{src:{value:i.paths.device.keyboard.key("shift")},dest:{value:le},xform:n.xforms.copy},{src:{value:l("top").pressed},dest:{value:M},xform:n.xforms.copy},{src:{value:R("top").pressed},dest:{value:V},xform:n.xforms.copy},{src:[le,M,V],dest:{value:i.paths.actions.boost},xform:n.xforms.any},{src:{value:D},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.copy},{src:{value:D},dest:{value:i.paths.actions.rightHand.pose},xform:n.xforms.copy},{src:{value:d},dest:{value:i.paths.actions.leftHand.pose},xform:n.xforms.copy}],[a.sets.rightHandTeleporting]:[{src:{value:be},dest:{value:Y},xform:n.xforms.falling,priority:1},{src:{value:R("touchpad").pressed},dest:{value:X},xform:n.xforms.falling},{src:[Y,X],dest:{value:i.paths.actions.rightHand.stopTeleport},xform:n.xforms.any}],[a.sets.leftHandHoveringOnNothing]:[{src:{value:me},dest:{value:i.paths.actions.leftHand.startTeleport},xform:n.xforms.rising}],[a.sets.leftHandTeleporting]:[{src:{value:me},dest:{value:_e},xform:n.xforms.falling,priority:1},{src:[_e,ye,Ee],dest:{value:i.paths.actions.leftHand.stopTeleport},xform:n.xforms.any}],[a.sets.rightHandHoveringOnNothing]:[{src:{value:be},dest:{value:i.paths.actions.rightHand.startTeleport},xform:n.xforms.rising,priority:1}],[a.sets.cursorHoveringOnNothing]:[],[a.sets.cursorHoveringOnUI]:[{src:{value:be},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.rising,priority:1}],[a.sets.leftHandHoveringOnInteractable]:[{src:{value:de},dest:{value:w},xform:n.xforms.rising},{src:{value:me},dest:{value:x},xform:n.xforms.rising,priority:1},{src:[w],dest:{value:i.paths.actions.leftHand.grab},xform:n.xforms.any}],[a.sets.leftHandHoldingInteractable]:[{src:{value:de},dest:{value:i.paths.actions.leftHand.drop},xform:n.xforms.falling,priority:1}],[a.sets.leftHandHoveringOnPen]:[],[a.sets.leftHandHoldingPen]:[{src:{value:ge},dest:{value:ye},xform:n.xforms.falling,priority:1},{src:{value:ge},dest:{value:k},xform:n.xforms.rising,priority:1},{src:{bool:k,value:y},dest:{value:i.paths.actions.leftHand.startTeleport},xform:n.xforms.copyIfTrue,priority:1},{src:{value:me},dest:{value:i.paths.actions.leftHand.startDrawing},xform:n.xforms.rising,priority:2},{src:{value:me},dest:{value:_},xform:n.xforms.falling,priority:2},{src:{value:de},dest:{value:E},xform:n.xforms.falling,priority:1},{src:{value:de},dest:{value:Ee},xform:n.xforms.falling,priority:1},{src:[_,E],dest:{value:i.paths.actions.leftHand.stopDrawing},xform:n.xforms.any},{src:{value:ge},dest:{value:S},xform:n.xforms.rising,priority:1},{src:{bool:S,value:f},dest:{value:i.paths.actions.leftHand.penNextColor},xform:n.xforms.copyIfTrue,priority:2},{src:{bool:S,value:g},dest:{value:i.paths.actions.leftHand.penPrevColor},xform:n.xforms.copyIfTrue,priority:2},{src:{value:c("joyX"),touching:l("touchpad").touched},dest:{value:i.paths.actions.leftHand.scalePenTip},xform:n.xforms.touch_axis_scroll(.1)},{src:{value:l("top").pressed},dest:{value:i.paths.actions.leftHand.undoDrawing},xform:n.xforms.rising,priority:2}],[a.sets.cursorHoveringOnInteractable]:[{src:{value:he},dest:{value:W},xform:n.xforms.rising},{src:{value:be},dest:{value:U},xform:n.xforms.rising,priority:1},{src:[W],dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.any}],[a.sets.cursorHoldingInteractable]:[{src:{value:T("joyY"),touching:R("touchpad").touched},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.touch_axis_scroll(-1)},{src:{value:he},dest:{value:z},xform:n.xforms.falling,priority:1},{src:{value:be},dest:{value:G},xform:n.xforms.falling,priority:2},{src:[z],dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.any},{src:{},dest:{value:J},root:"rootForFrozenOverrideWhenHolding",xform:n.xforms.always(!1)}],[a.sets.cursorHoveringOnPen]:[],[a.sets.cursorHoldingPen]:[{src:{bool:j,value:N},dest:{value:i.paths.actions.rightHand.startTeleport},xform:n.xforms.copyIfTrue,priority:2},{src:{value:be},dest:{value:i.paths.actions.cursor.startDrawing},xform:n.xforms.rising,priority:3},{src:{value:be},dest:{value:i.paths.actions.cursor.stopDrawing},xform:n.xforms.falling,priority:3},{src:{value:T("joyX"),touching:R("touchpad").touched},dest:{value:i.paths.actions.cursor.scalePenTip},xform:n.xforms.touch_axis_scroll(.1)},{src:{bool:j,value:P},dest:{value:i.paths.actions.cursor.penNextColor},xform:n.xforms.copyIfTrue,priority:2},{src:{bool:j,value:L},dest:{value:i.paths.actions.cursor.penPrevColor},xform:n.xforms.copyIfTrue,priority:2},{src:{value:R("top").pressed},dest:{value:i.paths.actions.cursor.undoDrawing},xform:n.xforms.rising,priority:2}],[a.sets.rightHandHoveringOnInteractable]:[{src:{value:he},dest:{value:W},xform:n.xforms.rising},{src:{value:be},dest:{value:U},xform:n.xforms.rising,priority:2},{src:[W],dest:{value:i.paths.actions.rightHand.grab},xform:n.xforms.any}],[a.sets.rightHandHoldingInteractable]:[{src:{value:he},dest:{value:$},xform:n.xforms.falling,priority:1},{src:{value:be},dest:{value:q},xform:n.xforms.falling,priority:2},{src:[$],dest:{value:i.paths.actions.rightHand.drop},xform:n.xforms.any},{src:{},dest:{value:J},root:"rootForFrozenOverrideWhenHolding",xform:n.xforms.always(!1)}],[a.sets.rightHandHoveringOnPen]:[],[a.sets.rightHandHoldingPen]:[{src:{bool:j,value:N},dest:{value:i.paths.actions.rightHand.startTeleport},xform:n.xforms.copyIfTrue},{src:{value:be},dest:{value:i.paths.actions.rightHand.startDrawing},xform:n.xforms.rising,priority:3},{src:{value:be},dest:{value:i.paths.actions.rightHand.stopDrawing},xform:n.xforms.falling,priority:3},{src:{bool:j,value:P},dest:{value:i.paths.actions.rightHand.penNextColor},xform:n.xforms.copyIfTrue,priority:2},{src:{bool:j,value:L},dest:{value:i.paths.actions.rightHand.penPrevColor},xform:n.xforms.copyIfTrue,priority:2},{src:{value:T("joyX"),touching:R("touchpad").touched},dest:{value:i.paths.actions.rightHand.scalePenTip},xform:n.xforms.touch_axis_scroll(.1)},{src:{value:R("top").pressed},dest:{value:i.paths.actions.rightHand.undoDrawing},xform:n.xforms.rising,priority:2}],[a.sets.cursorHoveringOnCamera]:[],[a.sets.rightHandHoveringOnCamera]:[],[a.sets.leftHandHoveringOnCamera]:[],[a.sets.rightHandHoldingCamera]:[{src:{value:be},dest:{value:i.paths.actions.rightHand.takeSnapshot},xform:n.xforms.rising,priority:3},{src:{value:be},dest:{value:i.paths.noop},xform:n.xforms.falling,priority:3}],[a.sets.leftHandHoldingCamera]:[{src:{value:l("trigger").pressed},dest:{value:i.paths.actions.leftHand.takeSnapshot},xform:n.xforms.rising}],[a.sets.cursorHoldingCamera]:[{src:{value:be},dest:{value:i.paths.actions.cursor.takeSnapshot},xform:n.xforms.rising,priority:3},{src:{value:be},dest:{value:i.paths.noop},xform:n.xforms.falling,priority:3}],[a.sets.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:i.paths.noop},xform:n.xforms.noop,priority:1e3}]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wmrUserBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);const r=i.paths.device.wmr.left.grip.pressed,l=i.paths.device.wmr.right.grip.pressed,c=i.paths.device.wmr.right.trigger.pressed,d=i.paths.device.wmr.v("right/joy/north"),u=i.paths.device.wmr.v("right/grip/rising"),h=i.paths.device.wmr.v("right/trigger/rising"),p=i.paths.device.wmr.v("right/grip/falling"),m=i.paths.device.wmr.v("right/trigger/falling");function f(e){return{padWest:i.paths.device.wmr.v(e+"/pad/west"),padEast:i.paths.device.wmr.v(e+"/pad/east"),padNorth:i.paths.device.wmr.v(e+"/pad/north"),padSouth:i.paths.device.wmr.v(e+"/pad/south"),padCenter:i.paths.device.wmr.v(e+"/pad/center"),padCenterStrip:i.paths.device.wmr.v(e+"/pad/centerStrip")}}function g(e){const{padWest:t,padEast:s,padNorth:a,padSouth:o,padCenter:r,padCenterStrip:l}=f(e),c=i.paths.device.wmr.v(e+"/pad");return[{src:{x:i.paths.device.wmr[e].touchpad.axisX,y:i.paths.device.wmr[e].touchpad.axisY},dest:{value:c},xform:n.xforms.compose_vec2},{src:{value:c},dest:{west:t,east:s,north:a,south:o,center:r},xform:n.xforms.vec2dpad(.5,!1,!1)},{src:[a,r,o],dest:{value:l},xform:n.xforms.any}]}const v={src:{},dest:{value:i.paths.actions.ensureFrozen},xform:n.xforms.always(!1)};function b(e,t){const s=i.paths.device.wmr[e].touchpad.axisY,a=i.paths.device.wmr[e].trigger.pressed,o=i.paths.device.wmr[e].touchpad.pressed,r=i.paths.device.wmr[e].touchpad.touched,l=i.paths.device.wmr.v(e+"/pad/rising"),c=i.paths.device.wmr.v(e+"/pad/centerStrip/touched"),{padWest:d,padEast:u,padCenter:h,padCenterStrip:p}=f(e),m=i.paths.actions[t?"cursor":e+"Hand"];return[v,...g(e),{src:{value:a},dest:{value:m.startDrawing},xform:n.xforms.rising},{src:{value:a},dest:{value:m.stopDrawing},xform:n.xforms.falling},{src:{value:o},dest:{value:l},xform:n.xforms.rising},{src:{bool:l,value:d},dest:{value:m.penPrevColor},xform:n.xforms.copyIfTrue},{src:{bool:l,value:u},dest:{value:m.penNextColor},xform:n.xforms.copyIfTrue},{src:[p,r],dest:{value:c},xform:n.xforms.all},{src:{value:s,touching:c},dest:{value:m.scalePenTip},xform:n.xforms.touch_axis_scroll(-.05)},{src:[l,h],dest:{value:m.undoDrawing},xform:n.xforms.all}]}function y(e){const t=i.paths.device.wmr[e].touchpad.touched,s=i.paths.device.wmr[e].trigger.pressed,a=i.paths.device.wmr[e].grip.pressed,o=i.paths.actions[e+"Hand"];return[{src:{value:t},dest:{value:o.thumb},xform:n.xforms.copy},{src:{value:s},dest:{value:o.index},xform:n.xforms.copy},{src:{value:a},dest:{value:o.middleRingPinky},xform:n.xforms.copy}]}function _(e,t){const s=i.paths.actions[t?"cursor":e+"Hand"];return[v,{src:{value:i.paths.device.wmr[e].trigger.pressed},dest:{value:s.takeSnapshot},xform:n.xforms.rising}]}t.wmrUserBindings=(0,o.addSetsToBindings)({[a.sets.global]:[{src:{value:i.paths.device.wmr.left.pose},dest:{value:i.paths.actions.leftHand.pose},xform:n.xforms.copy},{src:{value:i.paths.device.wmr.right.pose},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.copy},{src:{value:i.paths.device.wmr.right.pose},dest:{value:i.paths.actions.rightHand.pose},xform:n.xforms.copy},...y("left"),...y("right"),...function(){const e=i.paths.device.wmr.left.touchpad.pressed,t=i.paths.device.wmr.right.touchpad.pressed,s=i.paths.device.wmr.v("left/touchpad/falling"),a=i.paths.device.wmr.v("right/touchpad/falling"),o=i.paths.device.wmr.k("space/falling");return[{src:[i.paths.device.keyboard.key(" "),e,t],dest:{value:i.paths.actions.ensureFrozen},xform:n.xforms.any},{src:{value:i.paths.device.keyboard.key(" ")},dest:{value:o},xform:n.xforms.falling},{src:{value:e},dest:{value:s},xform:n.xforms.falling},{src:{value:t},dest:{value:a},xform:n.xforms.falling},{src:[o,s,a],dest:{value:i.paths.actions.thaw},xform:n.xforms.any}]}(),...function(){const e=i.paths.device.wmr.v("right/joy"),t=i.paths.device.wmr.v("right/joy/west"),s=i.paths.device.wmr.v("right/joy/East"),a=i.paths.device.wmr.v("right/joy/west/rising"),o=i.paths.device.wmr.v("right/joy/east/rising"),r=i.paths.device.wmr.k("q/rising"),l=i.paths.device.wmr.k("e/rising");return[{src:{x:i.paths.device.wmr.right.joystick.axisX,y:i.paths.device.wmr.right.joystick.axisY},dest:{value:e},xform:n.xforms.compose_vec2},{src:{value:e},dest:{north:d,west:t,east:s},xform:n.xforms.vec2dpad(.2,!1,!1)},{src:{value:d},dest:{value:i.paths.actions.rightHand.startTeleport},xform:n.xforms.rising},{src:{value:t},dest:{value:a},xform:n.xforms.rising},{src:{value:s},dest:{value:o},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("q")},dest:{value:r},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("e")},dest:{value:l},xform:n.xforms.rising},{src:[a,r],dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.any},{src:[o,l],dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.any}]}(),...function(){const e=i.paths.device.wmr.k("wasd_vec2"),t=i.paths.device.wmr.k("arrows_vec2"),s=i.paths.device.wmr.k("characterAcceleration"),a=i.paths.device.wmr.v("left/joy/x/deadzoned"),o=i.paths.device.wmr.v("left/joy/y/deadzoned"),r=i.paths.device.wmr.v("left/joy/x/scaled"),l=i.paths.device.wmr.v("left/joy/y/scaled"),c=i.paths.device.wmr.v("left/characterAcceleration");return[{src:{w:i.paths.device.keyboard.key("arrowup"),a:i.paths.device.keyboard.key("arrowleft"),s:i.paths.device.keyboard.key("arrowdown"),d:i.paths.device.keyboard.key("arrowright")},dest:{vec2:t},xform:n.xforms.wasd_to_vec2},{src:{w:i.paths.device.keyboard.key("w"),a:i.paths.device.keyboard.key("a"),s:i.paths.device.keyboard.key("s"),d:i.paths.device.keyboard.key("d")},dest:{vec2:e},xform:n.xforms.wasd_to_vec2},{src:{first:e,second:t},dest:{value:s},xform:n.xforms.max_vec2},{src:{value:i.paths.device.wmr.left.joystick.axisX},dest:{value:a},xform:n.xforms.deadzone(.1)},{src:{value:a},dest:{value:r},xform:n.xforms.scale(1.5)},{src:{value:i.paths.device.wmr.left.joystick.axisY},dest:{value:o},xform:n.xforms.deadzone(.1)},{src:{value:o},dest:{value:l},xform:n.xforms.scale(-1.5)},{src:{x:r,y:l},dest:{value:c},xform:n.xforms.compose_vec2},{src:{first:c,second:s},dest:{value:i.paths.actions.characterAcceleration},xform:n.xforms.max_vec2},{src:[i.paths.device.wmr.left.trigger.pressed,i.paths.device.wmr.right.trigger.pressed,i.paths.device.keyboard.key("shift")],dest:{value:i.paths.actions.boost},xform:n.xforms.any}]}(),{src:{value:i.paths.device.keyboard.key("m")},dest:{value:i.paths.actions.muteMic},xform:n.xforms.rising},{src:{value:i.paths.device.keyboard.key("t")},dest:{value:i.paths.actions.focusChat},xform:n.xforms.rising}],[a.sets.leftHandHoveringOnNothing]:[],[a.sets.cursorHoveringOnNothing]:[],[a.sets.rightHandHoveringOnNothing]:[],[a.sets.rightHandTeleporting]:[{src:{value:d},dest:{value:i.paths.actions.rightHand.stopTeleport},xform:n.xforms.falling}],[a.sets.cursorHoveringOnUI]:[{src:{value:c},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.rising}],[a.sets.leftHandHoveringOnInteractable]:[{src:{value:r},dest:{value:i.paths.actions.leftHand.grab},xform:n.xforms.rising}],[a.sets.cursorHoveringOnInteractable]:[{src:{value:l},dest:{value:u},xform:n.xforms.rising},{src:{value:c},dest:{value:h},xform:n.xforms.rising},{src:[u,h],dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.any}],[a.sets.rightHandHoveringOnInteractable]:[{src:{value:l},dest:{value:i.paths.actions.rightHand.grab},xform:n.xforms.rising}],[a.sets.leftHandHoldingInteractable]:[v,{src:{value:r},dest:{value:i.paths.actions.leftHand.drop},xform:n.xforms.falling}],[a.sets.cursorHoldingInteractable]:[v,...function(){const{padNorth:e,padSouth:t}=f("right"),s=i.paths.device.wmr.v("right/pad/northOrSouth"),a=i.paths.device.wmr.v("right/pad/northOrSouth/pressed"),o=i.paths.device.wmr.v("right/pad/northOrSouthpressed/y");return[...g("right"),{src:[e,t],dest:{value:s},xform:n.xforms.any},{src:[s,i.paths.device.wmr.right.touchpad.pressed],dest:{value:a},xform:n.xforms.all},{src:{bool:a,value:i.paths.device.wmr.right.touchpad.axisY},dest:{value:o},xform:n.xforms.copyIfTrue},{src:{value:o},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.scale(.1)}]}(),{src:{value:l},dest:{value:p},xform:n.xforms.falling},{src:{value:c},dest:{value:m},xform:n.xforms.falling},{src:[p,m],dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.any}],[a.sets.rightHandHoldingInteractable]:[v,{src:{value:l},dest:{value:i.paths.actions.rightHand.drop},xform:n.xforms.falling}],[a.sets.leftHandHoveringOnPen]:[],[a.sets.cursorHoveringOnPen]:[],[a.sets.rightHandHoveringOnPen]:[],[a.sets.leftHandHoldingPen]:b("left"),[a.sets.cursorHoldingPen]:b("right",!0),[a.sets.rightHandHoldingPen]:b("right"),[a.sets.leftHandHoveringOnCamera]:[],[a.sets.cursorHoveringOnCamera]:[],[a.sets.rightHandHoveringOnCamera]:[],[a.sets.leftHandHoldingCamera]:_("left"),[a.sets.cursorHoldingCamera]:_("right",!0),[a.sets.rightHandHoldingCamera]:_("right"),[a.sets.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:i.paths.noop},xform:n.xforms.noop,priority:1e3}]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xboxControllerUserBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);const r=i.paths.device.xbox.button,l=i.paths.device.xbox.axis;t.xboxControllerUserBindings=(0,o.addSetsToBindings)({[a.sets.cursorHoldingInteractable]:[{src:{value:r("rightTrigger").pressed},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.falling,root:"/vars/xbox/rightTriggerFalling",priority:100},{src:{bool:r("leftTrigger").pressed,value:l("leftJoystickVertical")},dest:{value:"/vars/xbox/cursorModDelta"},xform:n.xforms.copyIfTrue},{src:{value:"/vars/xbox/cursorModDelta"},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.copy},{src:{bool:r("leftTrigger").pressed,value:l("leftJoystickVertical")},dest:{value:"/var/xbox/leftJoystickVertical"},xform:n.xforms.copyIfFalse,root:"xbox/leftJoystick",priority:200}],[a.sets.cursorHoldingPen]:[{src:{value:r("rightTrigger").pressed},dest:{value:i.paths.actions.cursor.startDrawing},xform:n.xforms.rising,root:"xboxRightTriggerRising",priority:200},{src:{value:r("rightTrigger").pressed},dest:{value:i.paths.actions.cursor.stopDrawing},xform:n.xforms.falling,root:"/vars/xbox/rightTriggerFalling",priority:200},{src:{value:r("b").pressed},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.rising},{src:{value:r("y").pressed},dest:{value:i.paths.actions.cursor.undoDrawing},xform:n.xforms.rising,root:"xbox/y",priority:200},{src:{value:r("a").pressed},dest:{value:i.paths.actions.cursor.penNextColor},xform:n.xforms.rising},{src:{value:r("x").pressed},dest:{value:i.paths.actions.cursor.penPrevColor},xform:n.xforms.rising},{src:{bool:r("leftTrigger").pressed,value:l("rightJoystickVertical")},dest:{value:"foobarbazbotbooch"},xform:n.xforms.copyIfTrue},{dest:{value:i.paths.actions.cursorScalePenTip},src:{value:"foobarbazbotbooch"},xform:n.xforms.scale(.01)}],[a.sets.global]:[{src:{value:l("rightJoystickHorizontal")},dest:{value:"/var/xbox/scaledRightJoystickHorizontal"},xform:n.xforms.scale(-1.5)},{src:{value:l("rightJoystickVertical")},dest:{value:"/var/xbox/scaledRightJoystickVertical"},xform:n.xforms.scale(-1.25)},{src:{x:"/var/xbox/scaledRightJoystickHorizontal",y:"/var/xbox/scaledRightJoystickVertical"},dest:{value:i.paths.actions.cameraDelta},xform:n.xforms.compose_vec2},{src:{value:l("leftJoystickHorizontal")},dest:{value:"/var/xbox/scaledLeftJoystickHorizontal"},xform:n.xforms.scale(1.5)},{src:{value:l("leftJoystickVertical")},dest:{value:"/var/xbox/leftJoystickVertical"},xform:n.xforms.copy,root:"xbox/leftJoystick",priority:100},{src:{value:"/var/xbox/leftJoystickVertical"},dest:{value:"/var/xbox/scaledLeftJoystickVertical"},xform:n.xforms.scale(-1.25)},{src:{x:"/var/xbox/scaledLeftJoystickHorizontal",y:"/var/xbox/scaledLeftJoystickVertical"},dest:{value:i.paths.actions.characterAcceleration},xform:n.xforms.compose_vec2},{src:{value:r("leftTrigger").pressed},dest:{value:i.paths.actions.boost},xform:n.xforms.copy},{src:{value:r("leftBumper").pressed},dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.rising},{src:{value:r("rightBumper").pressed},dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.rising},{dest:{value:"var/vec2/zero"},xform:n.xforms.vec2Zero},{src:{value:"var/vec2/zero"},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.poseFromCameraProjection()},{src:{value:r("y").pressed},dest:{value:i.paths.actions.spawnPen},xform:n.xforms.rising,root:"xbox/y",priority:100}],[a.sets.cursorHoveringOnInteractable]:[{src:{value:r("rightTrigger").pressed},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.rising,root:"xboxRightTriggerRising",priority:100}]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.daydreamUserBindings=void 0;var i=s(3),a=s(14),n=s(23),o=s(24);const r=e=>`/vars/daydream/${e}`,l=r("touchpad/axis"),c=r("touchpad/rising"),d=r("touchpad/falling"),u=r("touchpad/pressed"),h=r("dpad/north"),p=r("dpad/south"),m=r("dpad/east"),f=r("dpad/west"),g=r("dpad/center"),v=r("brushSizeDelta"),b=r("cursorModDelta"),y=r("dropSouth"),_=r("dropCenter"),E=[{src:{value:g,bool:c},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.copyIfTrue,priority:100}],x=[{src:{value:g,bool:c},dest:{value:_},xform:n.xforms.copyIfTrue,priority:100},{src:{value:p,bool:c},dest:{value:y},xform:n.xforms.copyIfTrue,priority:100},{src:[_,y],dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.any}];t.daydreamUserBindings=(0,o.addSetsToBindings)({[a.sets.global]:[{src:{x:i.paths.device.daydream.axis("touchpadX"),y:i.paths.device.daydream.axis("touchpadY")},dest:{value:l},xform:n.xforms.compose_vec2},{src:{value:i.paths.device.daydream.button("touchpad").pressed},dest:{value:c},xform:n.xforms.rising},{src:{value:i.paths.device.daydream.button("touchpad").pressed},dest:{value:d},xform:n.xforms.falling},{src:{value:i.paths.device.daydream.button("touchpad").pressed},dest:{value:u},xform:n.xforms.copy},{src:{value:l},dest:{north:h,south:p,east:m,west:f,center:g},xform:n.xforms.vec2dpad(.5)},{src:{value:m,bool:c},dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.copyIfTrue},{src:{value:f,bool:c},dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.copyIfTrue},{src:{value:g,bool:c},dest:{value:i.paths.actions.rightHand.startTeleport},xform:n.xforms.copyIfTrue},{src:{value:i.paths.device.daydream.pose},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.copy},{src:{value:i.paths.device.daydream.pose},dest:{value:i.paths.actions.rightHand.pose},xform:n.xforms.copy}],[a.sets.cursorHoveringOnInteractable]:E,[a.sets.cursorHoveringOnUI]:E,[a.sets.cursorHoldingInteractable]:[{src:{value:d},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.copy},{src:{value:i.paths.device.daydream.axis("touchpadY"),touching:i.paths.device.daydream.button("touchpad").touched},dest:{value:b},xform:n.xforms.touch_axis_scroll()},{src:{value:b},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.copy}],[a.sets.rightHandTeleporting]:[{src:{value:d},dest:{value:i.paths.actions.rightHand.stopTeleport},xform:n.xforms.copy}],[a.sets.cursorHoldingPen]:[{src:{value:h,bool:c},dest:{value:i.paths.actions.cursor.startDrawing},xform:n.xforms.copyIfTrue,priority:100},{src:{value:d},dest:{value:i.paths.actions.cursor.stopDrawing},xform:n.xforms.copy,priority:100},{src:{value:i.paths.device.daydream.axis("touchpadX"),touching:i.paths.device.daydream.button("touchpad").touched},dest:{value:v},xform:n.xforms.touch_axis_scroll(-.1)},{src:{value:v,bool:u},dest:{value:i.paths.actions.cursor.scalePenTip},xform:n.xforms.copyIfFalse,priority:100},{src:{value:m,bool:c},dest:{value:i.paths.actions.cursor.penPrevColor},xform:n.xforms.copyIfTrue,priority:100},{src:{value:f,bool:c},dest:{value:i.paths.actions.cursor.penNextColor},xform:n.xforms.copyIfTrue,priority:100},{src:{value:b,bool:u},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.copyIfFalse,priority:100},...x],[a.sets.cursorHoldingCamera]:[{src:{value:d},xform:n.xforms.noop,priority:100},{src:{value:h,bool:c},dest:{value:i.paths.actions.cursor.takeSnapshot},xform:n.xforms.copyIfTrue,priority:100},...x]})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.v("touchpad"),s=e.v("touchpad/rising"),r=e.v("touchpad/falling"),l=e.v("trigger/rising"),c=e.v("trigger/falling"),d=e.v("dpad/north"),u=e.v("dpad/south"),h=e.v("dpad/east"),p=e.v("dpad/west"),m=e.v("dpad/center"),f=e.v("dpad/centerStrip"),g={src:{value:l},dest:{value:i.paths.actions.cursor.grab},xform:n.xforms.copy,priority:200};return(0,o.addSetsToBindings)({[a.sets.global]:[{src:{value:e.button("trigger").pressed},dest:{value:l},xform:n.xforms.rising},{src:{value:e.button("trigger").pressed},dest:{value:c},xform:n.xforms.falling},{src:{value:e.button("touchpad").pressed},dest:{value:s},xform:n.xforms.rising,priority:100},{src:{value:e.button("touchpad").pressed},dest:{value:r},xform:n.xforms.falling,priority:100},{src:{x:e.axis("touchpadX"),y:e.axis("touchpadY")},dest:{value:t},xform:n.xforms.compose_vec2},{src:{value:t},dest:{north:d,south:u,east:h,west:p,center:m},xform:n.xforms.vec2dpad(.3)},{src:[m,u],dest:{value:f},xform:n.xforms.any},{src:{value:f,bool:e.button("touchpad").pressed},dest:{value:i.paths.actions.ensureFrozen},priority:100,xform:n.xforms.copyIfTrue},{src:{value:r},dest:{value:i.paths.actions.thaw},xform:n.xforms.copy},{src:{value:h,bool:s},dest:{value:i.paths.actions.snapRotateRight},xform:n.xforms.copyIfTrue,priority:100},{src:{value:p,bool:s},dest:{value:i.paths.actions.snapRotateLeft},xform:n.xforms.copyIfTrue,priority:100},{src:{value:l},dest:{value:i.paths.actions.rightHand.startTeleport},xform:n.xforms.copy,priority:100},{src:{value:e.pose},dest:{value:i.paths.actions.cursor.pose},xform:n.xforms.copy},{src:{value:e.pose},dest:{value:i.paths.actions.rightHand.pose},xform:n.xforms.copy},{src:{value:e.button("touchpad").touched},dest:{value:i.paths.actions.rightHand.thumb},xform:n.xforms.copy},{src:{value:e.button("trigger").pressed},dest:{value:i.paths.actions.rightHand.index},xform:n.xforms.copy},{src:{value:e.button("trigger").pressed},dest:{value:i.paths.actions.rightHand.middleRingPinky},xform:n.xforms.copy}],[a.sets.cursorHoveringOnInteractable]:[g],[a.sets.cursorHoveringOnUI]:[g],[a.sets.cursorHoldingInteractable]:[{src:{value:c},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.copy,priority:200},{src:{value:e.axis("touchpadY"),touching:e.button("touchpad").touched},dest:{value:i.paths.actions.cursor.modDelta},xform:n.xforms.touch_axis_scroll()},{src:{value:f},priority:200,xform:n.xforms.noop}],[a.sets.rightHandTeleporting]:[{src:{value:c},dest:{value:i.paths.actions.rightHand.stopTeleport},xform:n.xforms.copy,priority:100}],[a.sets.cursorHoldingPen]:[{src:{value:l},dest:{value:i.paths.actions.cursor.startDrawing},xform:n.xforms.copy,priority:300},{src:{value:c},dest:{value:i.paths.actions.cursor.stopDrawing},xform:n.xforms.copy,priority:300},{src:{value:e.axis("touchpadX"),touching:e.button("touchpad").touched},dest:{value:i.paths.actions.cursor.scalePenTip},xform:n.xforms.touch_axis_scroll(-.1)},{src:{value:f,bool:r},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.copyIfTrue,priority:300},{src:{value:h,bool:s},dest:{value:i.paths.actions.cursor.penPrevColor},xform:n.xforms.copyIfTrue,priority:200},{src:{value:p,bool:s},dest:{value:i.paths.actions.cursor.penNextColor},xform:n.xforms.copyIfTrue,priority:200},{src:{value:d,bool:s},dest:{value:i.paths.actions.cursor.undoDrawing},xform:n.xforms.copyIfTrue,priority:200}],[a.sets.cursorHoldingCamera]:[{src:{value:l},dest:{value:i.paths.actions.cursor.takeSnapshot},xform:n.xforms.copy,priority:300},{src:{value:c},xform:n.xforms.noop,priority:300},{src:{value:f,bool:r},dest:{value:i.paths.actions.cursor.drop},xform:n.xforms.copyIfTrue,priority:300}]})};var i=s(3),a=s(14),n=s(23),o=s(24)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveActionSets=function(){a=a||document.querySelector("#player-right-controller").components["super-hands"].state,n=n||document.querySelector("#player-left-controller").components["super-hands"].state,o=o||document.querySelector("#cursor").components["super-hands"].state,r=r||document.querySelector("#player-left-controller").components["teleport-controls"],l=l||document.querySelector("#player-right-controller").components["teleport-controls"],c=c||document.querySelector("#cursor-controller").components["cursor-controller"];const e=!r.active&&n.has("hover-start")&&n.get("hover-start").matches(".interactable, .interactable *"),t=!r.active&&n.has("hover-start")&&n.get("hover-start").matches(".pen, .pen *"),s=!r.active&&n.has("hover-start")&&n.get("hover-start").matches(".icamera, .icamera *"),d=n.has("grab-start")&&n.get("grab-start").matches(".interactable, .interactable *"),u=n.has("grab-start")&&n.get("grab-start").matches(".pen, .pen *"),h=n.has("grab-start")&&n.get("grab-start").matches(".icamera, .icamera *"),p=!r.active&&n.has("hover-start"),m=!p&&!n.has("grab-start"),f=r.active,g=o.has("grab-start"),v=l.active,b=!v&&!g&&a.has("hover-start"),y=!v&&!g&&a.has("grab-start"),_=!v&&!g&&a.has("hover-start")&&a.get("hover-start").matches(".interactable, .interactable *"),E=!v&&!g&&a.has("hover-start")&&a.get("hover-start").matches(".pen, .pen *"),x=!l.active&&!g&&a.has("hover-start")&&a.get("hover-start").matches(".icamera, .icamera *"),w=!g&&a.has("grab-start")&&a.get("grab-start").matches(".interactable, .interactable *"),S=!g&&a.has("grab-start")&&a.get("grab-start").matches(".pen, .pen *"),k=!g&&a.has("grab-start")&&a.get("grab-start").matches(".icamera, .icamera *"),A=!(v||b||o.has("hover-start")||g||a.has("grab-start"));c.enabled=!(v||b||y);const C=c.enabled&&!v&&!b&&!y&&o.has("hover-start")&&o.get("hover-start").matches(".ui, .ui *"),M=c.enabled&&!v&&!b&&!y&&!C&&o.has("hover-start")&&o.get("hover-start").matches(".interactable, .interactable *"),R=c.enabled&&!l.active&&!b&&!y&&!C&&o.has("hover-start")&&o.get("hover-start").matches(".icamera, .icamera *"),T=c.enabled&&!v&&!b&&!y&&!C&&o.has("hover-start")&&o.get("hover-start").matches(".pen, .pen *"),D=!v&&o.has("grab-start")&&o.get("grab-start").matches(".interactable, .interactable *"),H=!v&&o.has("grab-start")&&o.get("grab-start").matches(".pen, .pen *"),P=!l.active&&o.has("grab-start")&&o.get("grab-start").matches(".icamera, .icamera *"),L=!(v||b||y||o.has("hover-start")||o.has("grab-start")||C),O=AFRAME.scenes[0].systems.userinput;O.toggleSet(i.sets.leftHandHoveringOnInteractable,e),O.toggleSet(i.sets.leftHandHoveringOnPen,t),O.toggleSet(i.sets.leftHandHoveringOnCamera,s),O.toggleSet(i.sets.leftHandHoveringOnNothing,m),O.toggleSet(i.sets.leftHandHoldingPen,u),O.toggleSet(i.sets.leftHandHoldingInteractable,d),O.toggleSet(i.sets.leftHandHoldingCamera,h),O.toggleSet(i.sets.leftHandTeleporting,f),O.toggleSet(i.sets.rightHandHoveringOnInteractable,_),O.toggleSet(i.sets.rightHandHoveringOnPen,E),O.toggleSet(i.sets.rightHandHoveringOnNothing,A),O.toggleSet(i.sets.rightHandHoveringOnCamera,x),O.toggleSet(i.sets.rightHandHoldingPen,S),O.toggleSet(i.sets.rightHandHoldingInteractable,w),O.toggleSet(i.sets.rightHandTeleporting,v),O.toggleSet(i.sets.rightHandHoldingCamera,k),O.toggleSet(i.sets.cursorHoveringOnPen,T),O.toggleSet(i.sets.cursorHoveringOnCamera,R),O.toggleSet(i.sets.cursorHoveringOnInteractable,M),O.toggleSet(i.sets.cursorHoveringOnUI,C),O.toggleSet(i.sets.cursorHoveringOnNothing,L),O.toggleSet(i.sets.cursorHoldingPen,H),O.toggleSet(i.sets.cursorHoldingCamera,P),O.toggleSet(i.sets.cursorHoldingInteractable,D),O.toggleSet(i.sets.inputFocused,"INPUT"===document.activeElement.nodeName||"TEXTAREA"===document.activeElement.nodeName)};var i=s(14);let a,n,o,r,l,c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GamepadDevice=void 0;var i=s(3);t.GamepadDevice=class{constructor(e){this.gamepad=e}write(e){this.gamepad.connected&&(this.gamepad.buttons.forEach((t,s)=>{const a=i.paths.device.gamepad(this.gamepad.index).button(s);e[a.pressed]=!!t.pressed,e[a.touched]=!!t.touched,e[a.value]=t.value}),this.gamepad.axes.forEach((t,s)=>{e[i.paths.device.gamepad(this.gamepad.index).axis(s)]=t}))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.gamepadBindings={}},function(e,t,s){"use strict";var i=s(3);AFRAME.registerSystem("camera-mirror",{init(){this._onWindowResize=this._onWindowResize.bind(this),window.addEventListener("resize",this._onWindowResize,!1)},tick(){const e=this.el.systems.userinput;e.get(i.paths.actions.camera.exitMirror)&&this.mirrorEl&&this.unmirrorCameraAtEl(this.mirrorEl)},mirrorCameraAtEl(e){AFRAME.utils.device.isMobile()||(this.mirrorEl&&this.mirrorEl!==e&&this.unmirrorCameraAtEl(this.mirrorEl),this.mirrorEl=e,this.mirrorCamera=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,.1,3e4),this.mirrorCamera.rotation.set(0,Math.PI,0),e.setObject3D("mirror-camera",this.mirrorCamera),document.body.classList.add("mirrored-camera"),this.directRenderFunc||this._patchRenderFunc(),this.mirrorEl.emit("mirrored",{el:this.mirrorEl}))},unmirrorCameraAtEl(e){if(this.mirrorEl!==e)return;e.removeObject3D("mirror-camera"),document.body.classList.remove("mirrored-camera");const t=this.mirrorEl;this.mirrorEl=null,this.mirrorCamera=null,t.emit("unmirrored",{el:t})},getMirroredCameraEl(){return this.mirrorEl},_onWindowResize(){this.mirrorCamera&&(this.mirrorCamera.aspect=window.innerWidth/window.innerHeight,this.mirrorCamera.updateProjectionMatrix(),this.el.sceneEl.renderer.setSize(window.innerWidth,window.innerHeight))},_patchRenderFunc(){const e=document.getElementById("player-head"),t=document.getElementById("player-hud"),s=new THREE.Vector3,i=this.el.renderer,a=e&&e.object3D,n=t&&t.object3D;this.directRenderFunc=i.render,this.el.sceneEl.renderer.render=((e,t,o)=>{const r=i.vr.enabled;if((r||o||!this.mirrorCamera)&&(this.directRenderFunc.call(i,e,t,o),!this.mirrorCamera||o))return;a&&(s.copy(a.scale),a.scale.set(1,1,1),a.updateMatrices(!0,!0),a.updateMatrixWorld(!0,!0)),n&&(n.visible=!1),i.vr.enabled=!1;const l=this.el.object3D.onAfterRender;delete this.el.object3D.onAfterRender,this.directRenderFunc.call(i,e,this.mirrorCamera),this.el.object3D.onAfterRender=l,i.vr.enabled=r,a&&(a.scale.copy(s),a.updateMatrices(!0,!0),a.updateMatrixWorld(!0)),n&&(n.visible=!0)})}})},function(e,t,s){"use strict";var i=s(3);AFRAME.registerSystem("userinput-debug",{active:!0,tick(){if(!this.active)return;const e=AFRAME.scenes[0].systems.userinput;if(this.userinputFrameStatus){const t=(e,t)=>"number"==typeof t?`${t>=0?"+":""}${t.toFixed(3)}`:t,s=[],{frame:i}=e;for(const e in i){if(!i.hasOwnProperty(e))continue;if(!["/actions/"].some(t=>e.startsWith(t)))continue;let a=JSON.stringify(i[e],t);a&&(a=a.replace(/{"(\w{3,})":/g,'{\n  "$1":').replace(/,"(\w{3,})":/g,',\n  "$1":')),s.push(`${e} -> ${a}`)}this.userinputFrameStatus.textContent=s.join("\n")}if(e.get(i.paths.actions.logDebugFrame)){this.userinputFrameStatus||(this.userinputFrameStatus=document.createElement("div"),this.userinputFrameStatus.id="userinput-frame-status",this.userinputFrameStatus.style="\n          position: absolute;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        ",document.body.append(this.userinputFrameStatus)),console.log(e),console.log("sorted",e.sortedBindings),console.log("actives",e.actives),console.log("masks",e.masks),console.log("masked",e.masked),console.log("devices",e.activeDevices),console.log("activeSets",e.activeSets),console.log("frame",e.frame),console.log("xformStates",e.xformStates);const{sortedBindings:t,actives:s,masked:i}=e;for(const e in t){const a=[];if(i[e].length>0)for(const s of i[e])a.push(JSON.stringify(t[s]));this.logBindings&&console.log("binding: ",e,"\n",t[e],"\n","dest: ",t[e].dest&&Object.values(t[e].dest),"\n","active: ",s[e],"\n","maskedBy: ",i[e],"\n",a.join("\n"),"\n")}}}})},function(e,t,s){"use strict";AFRAME.registerSystem("frame-scheduler",{init(){this.registry=new Map,this.queues=[],this.frameIndex=0},schedule(e,t){this.registry.has(t)||(this.queues.push(t),this.registry.set(t,[])),this.registry.get(t).push(e)},unschedule(e){for(let t=0;t<this.queues.length;t++){const s=this.queues[t],i=this.registry.get(s),a=i.indexOf(e);a>=0&&i.splice(a,1)}console.log(this.registry)},tick:function(){for(let e=0;e<this.queues.length;e++){const t=this.queues[e],s=this.registry.get(t);0!==s.length&&s[this.frameIndex%s.length]()}this.frameIndex++}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";var i=s(3);const a={"player-right-controller":{scaleGrabbedGrabbable:i.paths.actions.rightHand.scaleGrabbedGrabbable},"player-left-controller":{scaleGrabbedGrabbable:i.paths.actions.leftHand.scaleGrabbedGrabbable},cursor:{scaleGrabbedGrabbable:i.paths.actions.cursor.scaleGrabbedGrabbable}};AFRAME.registerComponent("super-networked-interactable",{schema:{hapticsMassVelocityFactor:{default:.1},counter:{type:"selector"},scrollScaleDelta:{default:.1},minScale:{default:.1},maxScale:{default:100}},init:function(){this.system=this.el.sceneEl.systems.physics,this.counter=this.data.counter.components["networked-counter"],this.hand=null,this.currentScale=new THREE.Vector3,this.currentScale.copy(this.el.getAttribute("scale")),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this._syncCounterRegistration(),NAF.utils.isMine(e)||this.el.setAttribute("body",{type:"static"})}),this._onGrabStart=this._onGrabStart.bind(this),this._onGrabEnd=this._onGrabEnd.bind(this),this._onOwnershipLost=this._onOwnershipLost.bind(this),this._syncCounterRegistration=this._syncCounterRegistration.bind(this),this.el.addEventListener("grab-start",this._onGrabStart),this.el.addEventListener("grab-end",this._onGrabEnd),this.el.addEventListener("pinned",this._syncCounterRegistration),this.el.addEventListener("unpinned",this._syncCounterRegistration),this.el.addEventListener("ownership-lost",this._onOwnershipLost),this.system.addComponent(this)},remove:function(){this.counter.deregister(this.el),this.el.removeEventListener("grab-start",this._onGrabStart),this.el.removeEventListener("grab-end",this._onGrabEnd),this.el.removeEventListener("ownership-lost",this._onOwnershipLost),this.system.removeComponent(this)},_onGrabStart:function(e){this.el.components.grabbable&&0!==this.el.components.grabbable.data.maxGrabbers&&(this.hand=e.detail.hand,this.hand.emit("haptic_pulse",{intensity:"high"}),this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&(NAF.utils.takeOwnership(this.networkedEl)?(this.el.setAttribute("body",{type:"dynamic"}),this._syncCounterRegistration()):(this.el.emit("grab-end",{hand:this.hand}),this.hand=null)),this.currentScale.copy(this.el.getAttribute("scale")))},_onGrabEnd:function(e){e.detail.hand&&e.detail.hand.emit("haptic_pulse",{intensity:"high"})},_onOwnershipLost:function(){this.el.setAttribute("body",{type:"static"}),this.el.emit("grab-end",{hand:this.hand}),this.hand=null,this._syncCounterRegistration()},_changeScale:function(e){e&&this.el.is("grabbed")&&this.el.components.hasOwnProperty("stretchable")&&(this.currentScale.addScalar(e).clampScalar(this.data.minScale,this.data.maxScale),this.el.setAttribute("scale",this.currentScale),this.el.components.stretchable.stretchBody(this.el,this.currentScale),this.el.object3D.matrixNeedsUpdate=!0)},_syncCounterRegistration:function(){const e=this.networkedEl;if(!e||!e.components.networked)return;const t=e.components.pinnable&&e.components.pinnable.data.pinned;NAF.utils.isMine(e)&&!t?this.counter.register(e):this.counter.deregister(e)},tick:function(){const e=this.el.components.grabbable.grabbers[0];if(!e||!a[e.id])return;const t=AFRAME.scenes[0].systems.userinput;this._changeScale(t.get(a[e.id].scaleGrabbedGrabbable))}})},function(e,t,s){"use strict";AFRAME.registerComponent("networked-counter",{schema:{max:{default:3},ttl:{default:0},grab_event:{type:"string",default:"grab-start"},release_event:{type:"string",default:"grab-end"}},init(){this.registeredEls=new Map},remove(){this.registeredEls.forEach(({onGrabHandler:e,onReleaseHandler:t,timeout:s},i)=>{i.removeEventListener(this.data.grab_event,e),i.removeEventListener(this.data.release_event,t),clearTimeout(s)}),this.registeredEls.clear()},register(e){if(this.data.max<=0||this.registeredEls.has(e))return;const t=this._onGrabbed.bind(this,e),s=this._onReleased.bind(this,e);this.registeredEls.set(e,{ts:Date.now(),onGrabHandler:t,onReleaseHandler:s}),e.addEventListener(this.data.grab_event,t),e.addEventListener(this.data.release_event,s),e.is("grabbed")||this._startTimer(e),this._destroyOldest()},deregister(e){if(this.registeredEls.has(e)){const{onGrabHandler:t,onReleaseHandler:s,timeout:i}=this.registeredEls.get(e);e.removeEventListener(this.data.grab_event,t),e.removeEventListener(this.data.release_event,s),clearTimeout(i),this.registeredEls.delete(e)}},_onGrabbed(e){clearTimeout(this.registeredEls.get(e).timeout)},_onReleased(e){this._startTimer(e),this.registeredEls.get(e).ts=Date.now()},_destroyOldest(){if(this.registeredEls.size>this.data.max){let e=null,t=Number.MAX_VALUE;this.registeredEls.forEach(({ts:s},i)=>{s<t&&!i.is("grabbed")&&(e=i,t=s)}),this._destroy(e)}},_startTimer(e){this.data.ttl&&(clearTimeout(this.registeredEls.get(e).timeout),this.registeredEls.get(e).timeout=setTimeout(()=>{this._destroy(e)},1e3*this.data.ttl))},_destroy(e){this.deregister(e),e.parentNode.removeChild(e)}})},function(e,t,s){"use strict";AFRAME.registerComponent("set-yxz-order",{init:function(){this.el.object3D.rotation.order="YXZ"}})},function(e,t,s){"use strict";AFRAME.registerComponent("set-sounds-invisible",{schema:{withinDistance:{type:"number"}},init(){for(const e of Object.values(this.el.components))("sound"===e.attrName||e.attrName.startsWith("sound__"))&&(e.data.positional||e.pool.traverse(e=>e.visible=!1))}})},function(e,t,s){"use strict";e.exports=AFRAME.registerComponent("cardboard-controls",{init:function(){this.buttons={},this.gamepad=null,this.isMobile=AFRAME.utils.device.isMobile(),this.isVR=!1,this._handleEnterVR=this._handleEnterVR.bind(this),this._handleExitVR=this._handleExitVR.bind(this)},play:function(){window.addEventListener("enter-vr",this._handleEnterVR),window.addEventListener("exit-vr",this._handleExitVR)},pause:function(){window.removeEventListener("enter-vr",this._handleEnterVR),window.removeEventListener("exit-vr",this._handleExitVR)},tick:function(){if(this.inVR&&this.isMobile)if(this.gamepad=this.gamepad||this._getGamepad(),this.gamepad)for(let e=0;e<this.gamepad.buttons.length;e++)this.gamepad.buttons[e].pressed&&!this.buttons[e]?this.el.emit("cardboardbuttondown",{}):!this.gamepad.buttons[e].pressed&&this.buttons[e]&&this.el.emit("cardboardbuttonup",{}),this.buttons[e]=this.gamepad.buttons[e].pressed;else Object.keys(this.buttons).length&&(this.buttons={})},_getGamepad:function(){if(!navigator.getGamepads)return null;const e=navigator.getGamepads();for(let t=0;t<e.length;t++)if(e[t]&&"Cardboard Button"===e[t].id)return e[t];return null},_handleEnterVR:function(){this.inVR=!0},_handleExitVR:function(){this.inVR=!1}})},function(e,t,s){"use strict";var i=s(3),a=s(13);AFRAME.registerComponent("cursor-controller",{schema:{cursor:{type:"selector"},camera:{type:"selector"},far:{default:3},near:{default:.06},cursorColorHovered:{default:"#2F80ED"},cursorColorUnhovered:{default:"#FFFFFF"},rayObject:{type:"selector"},objects:{default:""}},init:function(){this.enabled=!0,this.data.cursor.addEventListener("loaded",()=>{this.data.cursor.object3DMap.mesh.renderOrder=window.APP.RENDER_ORDER.CURSOR},{once:!0}),this.setDirty=this.setDirty.bind(this),this.targets=[],this.raycaster=new THREE.Raycaster,this.dirty=!0,this.distance=this.data.far;const e=new THREE.LineBasicMaterial({color:"white",opacity:.2,transparent:!0,visible:!1}),t=new THREE.BufferGeometry;t.addAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(t,e),this.el.setObject3D("line",this.line)},update:function(){this.raycaster.far=this.data.far,this.raycaster.near=this.data.near,this.setDirty()},play:function(){this.observer=new MutationObserver(this.setDirty),this.observer.observe(this.el.sceneEl,{childList:!0,attributes:!0,subtree:!0}),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty)},pause:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},populateEntities:function(e,t){t.length=0;const s=this.data.objects?this.el.sceneEl.querySelectorAll(this.data.objects):this.el.sceneEl.children;for(let e=0;e<s.length;e++)s[e].object3D&&t.push(s[e].object3D)},emitIntersectionEvents:function(e,t){!t||e&&t.object.el===e.object.el||this.data.cursor.emit("raycaster-intersection",{el:t.object.el}),!e||t&&t.object.el===e.object.el||this.data.cursor.emit("raycaster-intersection-cleared",{el:e.object.el})},tick:(()=>{const e=[],t=new THREE.Vector3;return function(){this.dirty&&(this.populateEntities(this.data.objects,this.targets),this.dirty=!1);const s=AFRAME.scenes[0].systems.userinput,n=s.get(i.paths.actions.cursor.pose),o=s.get(i.paths.actions.rightHand.pose);if(this.data.cursor.object3D.visible=this.enabled&&!!n,this.line.material.visible=!(!this.enabled||!o),!this.enabled||!n)return;let r;const l=this.data.cursor.components["super-hands"].state.has("grab-start");l||(e.length=0,this.raycaster.ray.origin=n.position,this.raycaster.ray.direction=n.direction,this.raycaster.intersectObjects(this.targets,!0,e),r=e.find(e=>e.object.el),this.emitIntersectionEvents(this.prevIntersection,r),this.prevIntersection=r,this.distance=r?r.distance:this.data.far);const{cursor:c,near:d,far:u,camera:h,cursorColorHovered:p,cursorColorUnhovered:m}=this.data,f=s.get(i.paths.actions.cursor.modDelta);l&&f&&(this.distance=THREE.Math.clamp(this.distance-f,d,u)),c.object3D.position.copy(n.position).addScaledVector(n.direction,this.distance),(0,a.getLastWorldPosition)(h.object3D,t),t.y=c.object3D.position.y,c.object3D.lookAt(t),c.object3D.scale.setScalar(.75*Math.pow(this.distance,.315)),c.object3D.matrixNeedsUpdate=!0;const g=r||l?p:m;if(this.data.cursor.components.material.data.color!==g&&this.data.cursor.setAttribute("material","color",g),this.line.material.visible){const e=n.position,t=c.object3D.position,s=this.line.geometry.attributes.position.array;s[0]=e.x,s[1]=e.y,s[2]=e.z,s[3]=t.x,s[4]=t.y,s[5]=t.z,this.line.geometry.attributes.position.needsUpdate=!0,this.line.geometry.computeBoundingSphere()}}})(),remove:function(){this.emitIntersectionEvents(this.prevIntersection,null),delete this.prevIntersection}})},function(e,t,s){"use strict";AFRAME.registerComponent("nav-mesh-helper",{schema:{teleportControls:{type:"selectorAll",default:"[teleport-controls]"}},init:function(){const e=this.data.teleportControls;this.el.addEventListener("bundleloaded",()=>{if(e)for(let t=0;t<e.length;t++)e[t].components["teleport-controls"].queryCollisionEntities()})}})},function(e,t,s){"use strict";var i=s(3),a=s(13);const n={"player-right-controller":{startDrawing:i.paths.actions.rightHand.startDrawing,stopDrawing:i.paths.actions.rightHand.stopDrawing,undoDrawing:i.paths.actions.rightHand.undoDrawing,penNextColor:i.paths.actions.rightHand.penNextColor,penPrevColor:i.paths.actions.rightHand.penPrevColor,scalePenTip:i.paths.actions.rightHand.scalePenTip},"player-left-controller":{startDrawing:i.paths.actions.leftHand.startDrawing,stopDrawing:i.paths.actions.leftHand.stopDrawing,undoDrawing:i.paths.actions.leftHand.undoDrawing,penNextColor:i.paths.actions.leftHand.penNextColor,penPrevColor:i.paths.actions.leftHand.penPrevColor,scalePenTip:i.paths.actions.leftHand.scalePenTip},cursor:{startDrawing:i.paths.actions.cursor.startDrawing,stopDrawing:i.paths.actions.cursor.stopDrawing,undoDrawing:i.paths.actions.cursor.undoDrawing,penNextColor:i.paths.actions.cursor.penNextColor,penPrevColor:i.paths.actions.cursor.penPrevColor,scalePenTip:i.paths.actions.cursor.scalePenTip}};AFRAME.registerComponent("pen",{schema:{drawFrequency:{default:5},minDistanceBetweenPoints:{default:.01},camera:{type:"selector"},drawingManager:{type:"string"},color:{type:"color",default:"#FF0033"},availableColors:{default:["#FF0033","#FFFF00","#0099FF","#00FF33","#9900FF","#FF6600","#8D5524","#C68642","#E0AC69","#F1C27D","#FFDBAC","#FFFFFF","#222222","#111111","#000000"]},radius:{default:.01},minRadius:{default:.005},maxRadius:{default:.2}},init(){this.timeSinceLastDraw=0,this.lastPosition=new THREE.Vector3,this.lastPosition.copy(this.el.object3D.position),this.direction=new THREE.Vector3(1,0,0),this.currentDrawing=null,this.normal=new THREE.Vector3,this.worldPosition=new THREE.Vector3,this.colorIndex=0,this.grabbed=!1},play(){this.drawingManager=document.querySelector(this.data.drawingManager).components["drawing-manager"],this.drawingManager.createDrawing()},update(e){e.color!=this.data.color&&this.el.setAttribute("color",this.data.color),e.radius!=this.data.radius&&this.el.setAttribute("radius",this.data.radius)},tick(e,t){const s=this.el.parentNode.components.grabbable.grabbers[0],i=AFRAME.scenes[0].systems.userinput;if((0,a.getLastWorldPosition)(this.el.object3D,this.worldPosition),s&&n[s.id]){const e=n[s.id];i.get(e.startDrawing)&&this._startDraw(),i.get(e.stopDrawing)&&this._endDraw(),i.get(e.undoDrawing)&&this._undoDraw();const t=i.get(e.scalePenTip);t&&this._changeRadius(t),i.get(e.penNextColor)&&this._changeColor(1),i.get(e.penPrevColor)&&this._changeColor(-1)}var o,r,l;if(o=.005,r=this.worldPosition,l=this.lastPosition,Math.abs(r.x-l.x)<o&&Math.abs(r.y-l.y)<o&&Math.abs(r.z-l.z)<o||(this.direction.subVectors(this.worldPosition,this.lastPosition).normalize(),this.lastPosition.copy(this.worldPosition)),this.currentDrawing){const e=this.timeSinceLastDraw+t;e>=this.data.drawFrequency&&this.currentDrawing.getLastPoint().distanceTo(this.worldPosition)>=this.data.minDistanceBetweenPoints&&(this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.draw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius)),this.timeSinceLastDraw=e%this.data.drawFrequency}this.currentDrawing&&!s&&this._endDraw()},_getNormal:(()=>{const e=new THREE.Vector3;return function(t,s,i){e.subVectors(s,this.data.camera.object3D.position).normalize(),t.crossVectors(i,e)}})(),_startDraw(){this.currentDrawing=this.drawingManager.getDrawing(this),this.currentDrawing&&(this._getNormal(this.normal,this.worldPosition,this.direction),this.el.emit("start_draw"),this.currentDrawing.startDraw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius))},_endDraw(){this.currentDrawing&&(this.el.emit("stop_draw"),this.timeSinceLastDraw=0,this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.endDraw(this.worldPosition,this.direction,this.normal),this.drawingManager.returnDrawing(this),this.currentDrawing=null)},_undoDraw(){const e=this.drawingManager.getDrawing(this);e&&e.undoDraw()},_changeColor(e){this.colorIndex=(this.colorIndex+e+this.data.availableColors.length)%this.data.availableColors.length,this.data.color=this.data.availableColors[this.colorIndex],this.el.setAttribute("color",this.data.color)},_changeRadius(e){this.data.radius=Math.max(this.data.minRadius,Math.min(this.data.radius+e,this.data.maxRadius)),this.el.setAttribute("radius",this.data.radius)}})},function(e,t,s){"use strict";var i,a=s(532),n=(i=a,i&&i.__esModule?i:{default:i});function o(e,t,s,i){let a=s-1,n=-1;for(;a+1<=i;)t[++n]=e[++a]}AFRAME.registerComponent("networked-drawing",{schema:{segments:{default:8},defaultRadius:{default:.01},maxDrawTimeout:{default:6e5},maxLines:{default:50},maxPointsPerLine:{default:250}},init(){this._receiveData=this._receiveData.bind(this),this.networkBuffer=[],this.sendNetworkBufferQueue=[],this.drawStarted=!1,this.lineStarted=!1,this.remoteLineStarted=!1,this.receivedBufferParts=0,this.bufferIndex=0,this.connectedToOwner=!1,this.networkBufferInitialized=!1;const e={vertexColors:THREE.VertexColors};this.color=new THREE.Color,this.radius=this.data.defaultRadius,this.segments=this.data.segments;const t=new THREE.MeshStandardMaterial(e);this.sharedBufferGeometryManager=new n.default;const s=Math.round(20*this.data.maxPointsPerLine*(this.data.maxLines+1)*.333);this.sharedBufferGeometryManager.addSharedBuffer(0,t,THREE.TriangleStripDrawMode,s),this.lastPoint=new THREE.Vector3,this.lastSegments=[],this.currentSegments=[];for(let e=0;e<this.segments;e++)this.lastSegments[e]={position:new THREE.Vector3,normal:new THREE.Vector3},this.currentSegments[e]={position:new THREE.Vector3,normal:new THREE.Vector3};this.sharedBuffer=this.sharedBufferGeometryManager.getSharedBuffer(0),this.drawing=this.sharedBuffer.drawing;const i=document.querySelector("a-scene");this.scene=i.object3D,this.scene.add(this.drawing),this.prevIdx=Object.assign({},this.sharedBuffer.idx),this.idx=Object.assign({},this.sharedBuffer.idx),this.vertexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.networkBufferHistory=[],NAF.connection.onConnect(()=>{NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this.networkId=NAF.utils.getNetworkId(this.networkedEl),this.drawingId="drawing-"+this.networkId,NAF.connection.subscribeToDataChannel(this.drawingId,this._receiveData)})})},remove(){NAF.connection.unsubscribeToDataChannel(this.drawingId,this._receiveData),this.scene.remove(this.drawing)},tick(e){const t=NAF.connection.isConnected()&&this.networkedEl,s=t&&NAF.utils.isMine(this.networkedEl);if(!this.connectedToOwner&&t){const e=NAF.utils.getNetworkOwner(this.networkedEl);!s&&NAF.connection.hasActiveDataChannel(e)&&(NAF.connection.sendDataGuaranteed(e,this.drawingId,{type:0,clientId:NAF.clientId}),this.connectedToOwner=!0)}if(this.networkBuffer.length>0&&t&&(s?this.bufferIndex<this.networkBuffer.length&&this._broadcastDrawing():this._drawFromNetwork()),s&&this.sendNetworkBufferQueue.length>0){const e=[];for(let t=0;t<this.sendNetworkBufferQueue.length;t++)NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[t])&&e.push(this.sendNetworkBufferQueue[t]);for(let t=0;t<e.length;t++){const s=this.sendNetworkBufferQueue.indexOf(e[t]);this._sendNetworkBuffer(e[t]),this.sendNetworkBufferQueue.splice(s,1)}}this._deleteExpiredLines(e)},_broadcastDrawing:(()=>{const e=[];return function(){e.length=0,o(this.networkBuffer,e,this.bufferIndex,this.networkBuffer.length-1);let t=-1;for(;-1!=(t=this.networkBuffer.indexOf("-"));)this.networkBuffer.splice(t,1);this.bufferIndex=this.networkBuffer.length,NAF.connection.broadcastDataGuaranteed(this.drawingId,{type:1,buffer:e})}})(),_drawFromNetwork:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3,s=new THREE.Vector3;return function(){let i=this.networkBuffer[0];"-"===i&&(this._undoDraw(),this.networkBuffer.shift(),i=this.networkBuffer[0]);let a=!1;for(;null!=i&&this.networkBuffer.length>=10;)e.set(this.networkBuffer[0],this.networkBuffer[1],this.networkBuffer[2]),t.set(this.networkBuffer[3],this.networkBuffer[4],this.networkBuffer[5]),this.radius=Math.round(1e3*t.length())/1e3,t.normalize(),s.set(this.networkBuffer[6],this.networkBuffer[7],this.networkBuffer[8]),this.color.setHex(Math.round(s.length())-1),s.normalize(),this.networkBuffer.splice(0,9),this.remoteLineStarted||(this.startDraw(e,t,s),this.remoteLineStarted=!0),null===this.networkBuffer[0]?(this._endDraw(e,t,s),this.remoteLineStarted=!1,this.networkBuffer.shift()):(this._draw(e,t,s),a=!0);a&&this._updateBuffer()}})(),_deleteExpiredLines(e){const t=this.networkBufferHistory.length;if(t>0){const s=this.networkBufferHistory[0].time;if(t>this.data.maxLines||s+this.data.maxDrawTimeout<=e){const e=this.networkBufferHistory[0];t>1&&(e.idxLength+=2-this.segments%2,this.networkBufferHistory[1].idxLength-=2-this.segments%2),this.idx.position=e.idxLength,this.idx.uv=e.idxLength,this.idx.normal=e.idxLength,this.idx.color=e.idxLength,this.sharedBuffer.remove(this.prevIdx,this.idx),this.networkBufferHistory.shift(),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(this.networkBuffer.splice(0,e.networkBufferCount),this.bufferIndex-=e.networkBufferCount)}}},_sendNetworkBuffer:(()=>{const e=[];return function(t){if(NAF.utils.isMine(this.networkedEl))if(this.networkBuffer.length<=3e3)NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:1,buffer:this.networkBuffer});else{let s=0,i=0;for(;i<this.networkBuffer.length;)i=Math.min(i+3e3,this.networkBuffer.length),e.length=0,o(this.networkBuffer,e,s,i-1),s=i,NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:Math.ceil(this.networkBuffer.length/3e3),buffer:e})}}})(),_receiveData(e,t,s){switch(s.type){case 0:this.sendNetworkBufferQueue.push(s.clientId);break;case 1:this.networkBufferInitialized&&this.networkBuffer.push.apply(this.networkBuffer,s.buffer);break;case 2:this.networkBuffer.push.apply(this.networkBuffer,s.buffer),++this.receivedBufferParts>=s.parts&&(this.networkBufferInitialized=!0)}},getLastPoint(){return this.lastPoint},startDraw(e,t,s,i,a){NAF.connection.isConnected()&&(this.drawStarted=!0,i&&this.color.set(i),a&&(this.radius=a),this.lastPoint.copy(e),this._addToNetworkBuffer(e,t,s))},draw(e,t,s,i,a){NAF.connection.isConnected()&&this.drawStarted&&(i&&i!="#"+this.color.getHexString().toUpperCase()&&this.color.set(i),a&&(this.radius=a),this._addToNetworkBuffer(e,t,s),this._draw(e,t,s),this._updateBuffer())},_draw:(()=>{const e=new THREE.Vector3;return function(t,s,i,a=1){if(this.lineStarted)this._generateSegments(this.currentSegments,t,s,i,this.radius*a),this._drawCylinder(),this.currentPointCount>this.data.maxPointsPerLine&&(this._drawEndCap(t,s),this._endLine());else{this._generateSegments(this.lastSegments,t,s,i,this.radius*a),0===this.networkBufferHistory.length?this._addDegenerateTriangle():(this._restartPrimitive(),this._addDegenerateTriangle(),this.segments%2==0&&this._addDegenerateTriangle()),e.copy(s).negate();for(let t=0;t<this.segments;t++)this.lastSegments[t].normal.add(e).multiplyScalar(.5);this._drawCap(this.lastPoint,this.lastSegments,e),this.segments%2!=0&&this._addDegenerateTriangle(),this.lineStarted=!0}this.lastPoint.copy(t)}})(),undoDraw(){NAF.connection.isConnected()&&!this.drawStarted&&(this._undoDraw(),this._pushToNetworkBuffer("-"))},_undoDraw(){const e=this.networkBufferHistory.length;if(e>0){const t=this.networkBufferHistory.pop();this.idx.position=0,this.idx.uv=0,this.idx.normal=0,this.idx.color=0,e>1&&(t.idxLength+=1-this.segments%2,this.idx.position=this.sharedBuffer.idx.position-t.idxLength,this.idx.uv=this.sharedBuffer.idx.uv-t.idxLength,this.idx.normal=this.sharedBuffer.idx.normal-t.idxLength,this.idx.color=this.sharedBuffer.idx.color-t.idxLength),this.sharedBuffer.remove(this.idx,this.sharedBuffer.idx),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(this.networkBuffer.splice(this.networkBuffer.length-t.networkBufferCount,t.networkBufferCount),this.bufferIndex-=t.networkBufferCount)}},endDraw(e,t,s){this._endDraw(e,t,s),this._updateBuffer()},_endDraw(e,t,s){!this.lineStarted&&this.drawStarted?this._drawPoint(e):this.lineStarted&&this.drawStarted&&(this._addToNetworkBuffer(e,t,s),this._draw(e,t,s),this._drawEndCap(e,t)),this._endLine()},_drawEndCap:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(s,i){this.lineStarted&&this.drawStarted&&(e.copy(i).multiplyScalar(this.radius),t.copy(s).add(e),this._addDegenerateTriangle(),this._drawCap(t,this.lastSegments,i))}})(),_endLine(){if(this.el.emit("stop_draw"),!this.drawStarted)return;this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this._pushToNetworkBuffer(null);const e={networkBufferCount:this.networkBufferCount,idxLength:this.vertexCount-1,time:1e3*this.el.sceneEl.clock.elapsedTime};this.networkBufferHistory.push(e),this.vertexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.lineStarted=!1,this.drawStarted=!1},_addToNetworkBuffer:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(s,i,a){this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(++this.currentPointCount,this._pushToNetworkBuffer(s.x),this._pushToNetworkBuffer(s.y),this._pushToNetworkBuffer(s.z),e.copy(i),e.setLength(this.radius),this._pushToNetworkBuffer(e.x),this._pushToNetworkBuffer(e.y),this._pushToNetworkBuffer(e.z),t.copy(a),t.setLength(this.color.getHex()+1),this._pushToNetworkBuffer(t.x),this._pushToNetworkBuffer(t.y),this._pushToNetworkBuffer(t.z))}})(),_pushToNetworkBuffer(e){"-"!==e&&++this.networkBufferCount,this.networkBuffer.push(e)},_drawCylinder(){for(let e=0;e<this.segments;e++)this.currentSegments[e].normal.add(this.lastSegments[e].normal).multiplyScalar(.5);for(let e=0;e!=this.segments+1;e++)this._addVertex(this.lastSegments[e%this.segments]),this._addVertex(this.currentSegments[e%this.segments]);for(let e=0;e<this.segments;e++)this.lastSegments[e].position.copy(this.currentSegments[e].position),this.lastSegments[e].normal.copy(this.currentSegments[e].normal)},_drawPoint:(()=>{const e=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,-1,0),s=new THREE.Vector3(1,0,0),i=new THREE.Vector3,a=new THREE.Vector3;return function(n){i.copy(e).multiplyScalar(.75*this.radius),a.copy(n).add(i),this.lastPoint.copy(a),i.copy(e).multiplyScalar(.5*this.radius),a.copy(n).add(i),this._draw(a,t,s,.75),this._draw(n,t,s),i.copy(t).multiplyScalar(.5*this.radius),a.copy(n).add(i),this._draw(a,t,s,.75),i.copy(t).multiplyScalar(.75*this.radius),a.copy(n).add(i),this._addDegenerateTriangle(),this._drawCap(a,this.lastSegments,t)}})(),_drawCap(e,t,s){let i=0;for(let a=0;a<2*this.segments-this.segments%2;a++)(a-2)%4==0?this._addVertex({position:e,normal:s}):(this._addVertex(t[i%this.segments]),(a+1)%5!=0&&++i)},_restartPrimitive(){this.sharedBuffer.restartPrimitive(),++this.vertexCount},_updateBuffer(){this.sharedBuffer.update()},_addVertex(e){const t=e.position,s=e.normal;this.sharedBuffer.addVertex(t.x,t.y,t.z),this.sharedBuffer.addColor(this.color.r,this.color.g,this.color.b),s?this.sharedBuffer.addNormal(s.x,s.y,s.z):++this.sharedBuffer.idx.normal,++this.sharedBuffer.idx.uv,++this.vertexCount},_addDegenerateTriangle(){this._addVertex(this.lastSegments[0])},_generateSegments(e,t,s,i,a){const n=2*Math.PI/this.segments;for(let o=0;o<this.segments;o++){const r=e[o].position;this._rotatePointAroundAxis(r,t,s,i,n*o,a),e[o].normal.subVectors(r,t).normalize()}},_rotatePointAroundAxis:(()=>{const e=new THREE.Vector3;return function(t,s,i,a,n,o){e.copy(a),e.applyAxisAngle(i,n),t.copy(s).add(e.normalize().multiplyScalar(o))}})()})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=s(533),n=(i=a,i&&i.__esModule?i:{default:i});t.default=class{constructor(){this.sharedBuffers={}}addSharedBuffer(e,t,s,i){this.sharedBuffers[e]=new n.default(t,s,i)}getSharedBuffer(e){return this.sharedBuffers[e]}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,s){this.material=e,this.primitiveMode=t,this.maxBufferSize=s,this.geometries=[],this.current=null,this.drawing=new THREE.Object3D,this.addBuffer()}restartPrimitive(){if(this.idx.position>=this.current.attributes.position.count)console.error("maxBufferSize limit exceeded");else if(0!==this.idx.position){let e=3*(this.idx.position-1);const t=this.current.attributes.position.array;this.addVertex(t[e++],t[e++],t[e++]),this.idx.color++,this.idx.normal++}}remove(e,t){if(this.idx.position>t.position)for(const s in this.idx){const i=3;let a=e[s]*i;const n=(t[s]+1)*i,o=this.idx[s]*i;for(let e=n;e<o;e++)this.current.attributes[s].array[a++]=this.current.attributes[s].array[e];const r=t[s]-e[s]+1;this.idx[s]-=r}else for(const s in this.idx){const i=t[s]-e[s];this.idx[s]-=i}this.update()}undo(e){this.idx=e,this.update()}addBuffer(){const e=new THREE.BufferGeometry,t=new Float32Array(3*this.maxBufferSize),s=new Float32Array(3*this.maxBufferSize),i=new Float32Array(3*this.maxBufferSize),a=new THREE.Mesh(e,this.material);a.drawMode=this.primitiveMode,a.frustumCulled=!1,a.vertices=t;const n=new THREE.Object3D;this.drawing.add(n),n.add(a),e.setDrawRange(0,0),e.addAttribute("position",new THREE.BufferAttribute(t,3).setDynamic(!0)),e.addAttribute("normal",new THREE.BufferAttribute(s,3).setDynamic(!0)),e.addAttribute("color",new THREE.BufferAttribute(i,3).setDynamic(!0)),this.previous=null,this.geometries.length>0&&(this.previous=this.current),this.idx={position:0,normal:0,color:0},this.geometries.push(e),this.current=e}addColor(e,t,s){this.current.attributes.color.setXYZ(this.idx.color++,e,t,s)}addNormal(e,t,s){this.current.attributes.normal.setXYZ(this.idx.normal++,e,t,s)}addVertex(e,t,s){const i=this.current.attributes.position;this.idx.position===i.count&&console.error("maxBufferSize limit exceeded"),i.setXYZ(this.idx.position++,e,t,s)}update(){this.current.setDrawRange(0,this.idx.position),this.current.attributes.color.needsUpdate=!0,this.current.attributes.normal.needsUpdate=!0,this.current.attributes.position.needsUpdate=!0}}},function(e,t,s){"use strict";AFRAME.registerComponent("drawing-manager",{init(){this._onComponentInitialized=this._onComponentInitialized.bind(this),this.drawingToPen=new Map},remove(){this.drawingEl&&this.drawingEl.removeEventListener("componentinitialized",this._onComponentInitialized)},_onComponentInitialized(e){"networked-drawing"==e.detail.name&&(this.drawing=this.drawingEl.components["networked-drawing"])},createDrawing(){this.drawingEl||(this.drawingEl=document.createElement("a-entity"),this.drawingEl.setAttribute("networked","template: #interactable-drawing"),this.el.sceneEl.appendChild(this.drawingEl),this.drawingEl.addEventListener("componentinitialized",this._onComponentInitialized))},getDrawing(e){return!this.drawing||this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)!==e?null:(this.drawingToPen.set(this.drawing,e),this.drawing)},returnDrawing(e){this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)===e&&this.drawingToPen.delete(this.drawing)}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=e=>()=>{let t=null;return s=>null===t?(t=new THREE.Vector3(s.x,s.y,s.z),!0):!NAF.utils.almostEqualVec3(t,s,e)&&(t.copy(s),!0)};NAF.schemas.add({template:"#remote-avatar-template",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","player-info","networked-avatar",{selector:".camera",component:"position",requiresNetworkUpdate:e(.001)},{selector:".camera",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".left-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"visible"},{selector:".right-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".right-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".right-controller",component:"visible"}]}),NAF.schemas.add({template:"#interactable-media",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","media-loader",{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pager",property:"index"},"pinnable"]}),NAF.schemas.add({template:"#static-media",components:["media-loader",{component:"media-video",property:"time"}]}),NAF.schemas.add({template:"#static-controlled-media",components:["media-loader",{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pager",property:"index"}]}),NAF.schemas.add({template:"#interactable-drawing",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","networked-drawing"]}),NAF.schemas.add({template:"#interactable-camera",components:["position","rotation"]}),NAF.schemas.add({template:"#pen-interactable",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","media-loader",{selector:"#pen",component:"pen",property:"radius"},{selector:"#pen",component:"pen",property:"color"}]})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(72);const a="___concurrent_load_detector";t.default=class extends i.EventTarget{constructor(e){super(),this.start=(()=>{this.startedAt=new Date,localStorage.setItem(this.localStorageKey(),JSON.stringify({started_at:this.startedAt})),this.interval=setInterval(this._step,1e3)}),this.stop=(()=>{this.interval&&clearInterval(this.interval)}),this.localStorageKey=(()=>`${a}_${this.instanceKey}`),this._step=(()=>{const e=JSON.parse(localStorage.getItem(this.localStorageKey())),t=new Date(e.started_at);t.getTime()!==this.startedAt.getTime()&&(this.dispatchEvent(new CustomEvent("concurrentload")),this.stop())}),this.interval=null,this.startedAt=null,this.instanceKey=e||"global"}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports={"ui-dialog":"hub__ui-dialog__vlyfc",uiDialog:"hub__ui-dialog__vlyfc","ui-interactive":"hub__ui-interactive__3bdyc",uiInteractive:"hub__ui-interactive__3bdyc","invite-container":"hub__invite-container__2Zik1",inviteContainer:"hub__invite-container__2Zik1","presence-info":"hub__presence-info__dqWyo",presenceInfo:"hub__presence-info__dqWyo","profile-entry":"hub__profile-entry__1RY0R",profileEntry:"hub__profile-entry__1RY0R","form-submit":"hub__form-submit__12yem",formSubmit:"hub__form-submit__12yem","message-entry-submit":"hub__message-entry-submit__342-t",messageEntrySubmit:"hub__message-entry-submit__342-t","message-entry-in-room":"hub__message-entry-in-room__1a9hx",messageEntryInRoom:"hub__message-entry-in-room__1a9hx","message-entry-spawn":"hub__message-entry-spawn__3feCw",messageEntrySpawn:"hub__message-entry-spawn__3feCw","entry-button":"hub__entry-button__1e9jM",entryButton:"hub__entry-button__1e9jM","entry-panel":"hub__entry-panel__cCmIv",entryPanel:"hub__entry-panel__cCmIv","button-container":"hub__button-container__38FOc",buttonContainer:"hub__button-container__38FOc","action-button":"hub__action-button__3zqlu",actionButton:"hub__action-button__3zqlu",ui:"hub__ui__3UYRO","help-icon":"hub__help-icon__bbEZr",helpIcon:"hub__help-icon__bbEZr","entry-dialog":"hub__entry-dialog__2Ljux",entryDialog:"hub__entry-dialog__2Ljux",collapse:"hub__collapse__3Kqf1",expand:"hub__expand__3fi7t","nag-corner-button":"hub__nag-corner-button__lNoyE",nagCornerButton:"hub__nag-corner-button__lNoyE","message-entry-input":"hub__message-entry-input__lUA_h",messageEntryInput:"hub__message-entry-input__lUA_h","form-field-text":"hub__form-field-text__tR1Lt",formFieldText:"hub__form-field-text__tR1Lt","profile-name":"hub__profile-name__3AFJU",profileName:"hub__profile-name__3AFJU",label:"hub__label__1kjp1",title:"hub__title__ezGEu",name:"hub__name__2umw1",center:"hub__center__1Mvfu","wide-button":"hub__wide-button__1yqDc",wideButton:"hub__wide-button__1yqDc","invite-container-inverted":"hub__invite-container-inverted__3zt7S",inviteContainerInverted:"hub__invite-container-inverted__3zt7S","screen-sharing":"hub__screen-sharing__2VF91",screenSharing:"hub__screen-sharing__2VF91",checkbox:"hub__checkbox__32dyv",subscribe:"hub__subscribe__6Bn_L","ui-dialog-box-contents":"hub__ui-dialog-box-contents__PZ5qP",uiDialogBoxContents:"hub__ui-dialog-box-contents__PZ5qP",backgrounded:"hub__backgrounded__30IfD","hide-small-screens":"hub__hide-small-screens__2Fhhu",hideSmallScreens:"hub__hide-small-screens__2Fhhu","invite-mini-button":"hub__invite-mini-button__fnwYD",inviteMiniButton:"hub__invite-mini-button__fnwYD","invite-container-below-hud":"hub__invite-container-below-hud__1DhcT",inviteContainerBelowHud:"hub__invite-container-below-hud__1DhcT","occupant-count":"hub__occupant-count__3eAEj",occupantCount:"hub__occupant-count__3eAEj","presence-info-selected":"hub__presence-info-selected__FRBSA",presenceInfoSelected:"hub__presence-info-selected__FRBSA","message-entry":"hub__message-entry__7ORkX",messageEntry:"hub__message-entry__7ORkX","message-entry-input-in-room":"hub__message-entry-input-in-room__iiQ8c",messageEntryInputInRoom:"hub__message-entry-input-in-room__iiQ8c","message-entry-submit-in-room":"hub__message-entry-submit-in-room__254Wx",messageEntrySubmitInRoom:"hub__message-entry-submit-in-room__254Wx",logo:"hub__logo__3kJSj","avatar-selector-container":"hub__avatar-selector-container__3QB7G",avatarSelectorContainer:"hub__avatar-selector-container__3QB7G","avatar-selector":"hub__avatar-selector__2DqUA",avatarSelector:"hub__avatar-selector__2DqUA",form:"hub__form__3kQXh",box:"hub__box__2SMbn",links:"hub__links__1C6Ce",darkened:"hub__darkened__1gqMQ","display-name":"hub__display-name__36hFZ",displayName:"hub__display-name__36hFZ",icon:"hub__icon__1pzf7",bolded:"hub__bolded__2MYLZ",subtitle:"hub__subtitle__3kYcd",lobby:"hub__lobby__2VW6G","profile-icon":"hub__profile-icon__fwSfD",profileIcon:"hub__profile-icon__fwSfD","webvr-link-container":"hub__webvr-link-container__1Vq5m",webvrLinkContainer:"hub__webvr-link-container__1Vq5m","webvr-link":"hub__webvr-link__xW04U",webvrLink:"hub__webvr-link__xW04U",secondary:"hub__secondary__22yt_"}},,,,function(e,t){e.exports={touchZone:"virtual-gamepad-controls__touchZone__1KF_C",left:"virtual-gamepad-controls__left__1-URB",right:"virtual-gamepad-controls__right__1cgnU",mockJoystickContainer:"virtual-gamepad-controls__mockJoystickContainer__1aH3e",mockJoystick:"virtual-gamepad-controls__mockJoystick__2CuCG",inner:"virtual-gamepad-controls__inner__1Bn3C"}},,function(e,t){},,function(e,t){e.exports={"ui-dialog":"ui-root__ui-dialog__2TY9Y",uiDialog:"ui-root__ui-dialog__2TY9Y","ui-interactive":"ui-root__ui-interactive__2mtC4",uiInteractive:"ui-root__ui-interactive__2mtC4","invite-container":"ui-root__invite-container__2-3wx",inviteContainer:"ui-root__invite-container__2-3wx","presence-info":"ui-root__presence-info__3cieq",presenceInfo:"ui-root__presence-info__3cieq","message-entry-submit":"ui-root__message-entry-submit__1BdF3",messageEntrySubmit:"ui-root__message-entry-submit__1BdF3","message-entry-in-room":"ui-root__message-entry-in-room__MmydD",messageEntryInRoom:"ui-root__message-entry-in-room__MmydD","message-entry-spawn":"ui-root__message-entry-spawn__3CbCw",messageEntrySpawn:"ui-root__message-entry-spawn__3CbCw",ui:"ui-root__ui__33CMU","help-icon":"ui-root__help-icon__25aS8",helpIcon:"ui-root__help-icon__25aS8","nag-corner-button":"ui-root__nag-corner-button__3TFW5",nagCornerButton:"ui-root__nag-corner-button__3TFW5","message-entry-input":"ui-root__message-entry-input__2_YDd",messageEntryInput:"ui-root__message-entry-input__2_YDd","invite-container-inverted":"ui-root__invite-container-inverted__3mzfZ",inviteContainerInverted:"ui-root__invite-container-inverted__3mzfZ","ui-dialog-box-contents":"ui-root__ui-dialog-box-contents__3XWtl",uiDialogBoxContents:"ui-root__ui-dialog-box-contents__3XWtl",backgrounded:"ui-root__backgrounded__34j0m","hide-small-screens":"ui-root__hide-small-screens__LMcne",hideSmallScreens:"ui-root__hide-small-screens__LMcne","invite-mini-button":"ui-root__invite-mini-button__3dcvR",inviteMiniButton:"ui-root__invite-mini-button__3dcvR","invite-container-below-hud":"ui-root__invite-container-below-hud__1-gSL",inviteContainerBelowHud:"ui-root__invite-container-below-hud__1-gSL","occupant-count":"ui-root__occupant-count__34rGX",occupantCount:"ui-root__occupant-count__34rGX","presence-info-selected":"ui-root__presence-info-selected__1Jhbw",presenceInfoSelected:"ui-root__presence-info-selected__1Jhbw","message-entry":"ui-root__message-entry__1-vEM",messageEntry:"ui-root__message-entry__1-vEM","message-entry-input-in-room":"ui-root__message-entry-input-in-room__2n7Dm",messageEntryInputInRoom:"ui-root__message-entry-input-in-room__2n7Dm","message-entry-submit-in-room":"ui-root__message-entry-submit-in-room__3icfD",messageEntrySubmitInRoom:"ui-root__message-entry-submit-in-room__3icfD"}},,function(e,t){e.exports={"entry-button":"entry__entry-button__G7PQF",entryButton:"entry__entry-button__G7PQF","entry-panel":"entry__entry-panel__34CD9",entryPanel:"entry__entry-panel__34CD9","button-container":"entry__button-container__3Blog",buttonContainer:"entry__button-container__3Blog","action-button":"entry__action-button__3Vnab",actionButton:"entry__action-button__3Vnab","entry-dialog":"entry__entry-dialog__30kMs",entryDialog:"entry__entry-dialog__30kMs",collapse:"entry__collapse__3M47R",expand:"entry__expand__EJ52K","profile-name":"entry__profile-name__1ZWLR",profileName:"entry__profile-name__1ZWLR",label:"entry__label__fUhpb",title:"entry__title__1GITj",name:"entry__name__sYOeV",center:"entry__center__1105W","wide-button":"entry__wide-button__2tfMM",wideButton:"entry__wide-button__2tfMM","screen-sharing":"entry__screen-sharing__NBXQu",screenSharing:"entry__screen-sharing__NBXQu",checkbox:"entry__checkbox__3SoPk",subscribe:"entry__subscribe__3vddd",icon:"entry__icon__3JiUl",bolded:"entry__bolded__13B4f",subtitle:"entry__subtitle__1BC2y",lobby:"entry__lobby__3AxfL","profile-icon":"entry__profile-icon__3BAWG",profileIcon:"entry__profile-icon__3BAWG","webvr-link-container":"entry__webvr-link-container__3scWP",webvrLinkContainer:"entry__webvr-link-container__3scWP","webvr-link":"entry__webvr-link__3eWuZ",webvrLink:"entry__webvr-link__3eWuZ",secondary:"entry__secondary__3uhYE"}},,function(e,t){e.exports={"profile-entry":"profile__profile-entry__1pJKZ",profileEntry:"profile__profile-entry__1pJKZ","form-submit":"profile__form-submit__2y7xb",formSubmit:"profile__form-submit__2y7xb","form-field-text":"profile__form-field-text__1bzeV",formFieldText:"profile__form-field-text__1bzeV",title:"profile__title__Vcynv",logo:"profile__logo__1JZAd","avatar-selector-container":"profile__avatar-selector-container__1Rw3N",avatarSelectorContainer:"profile__avatar-selector-container__1Rw3N","avatar-selector":"profile__avatar-selector__1fGh2",avatarSelector:"profile__avatar-selector__1fGh2",form:"profile__form__1-hBO",box:"profile__box__oJXQD",links:"profile__links__2hukW",darkened:"profile__darkened__1rVba","display-name":"profile__display-name__auABh",displayName:"profile__display-name__auABh"}},,function(e,t){e.exports={"action-button":"create-object-dialog__action-button__3OIJQ",actionButton:"create-object-dialog__action-button__3OIJQ",buttons:"create-object-dialog__buttons__1zA-b","small-button":"create-object-dialog__small-button__7UxXQ",smallButton:"create-object-dialog__small-button__7UxXQ","input-border":"create-object-dialog__input-border__1N9AV",inputBorder:"create-object-dialog__input-border__1N9AV","left-side-of-input":"create-object-dialog__left-side-of-input__zyV06",leftSideOfInput:"create-object-dialog__left-side-of-input__zyV06","add-media-form":"create-object-dialog__add-media-form__10Wh-",addMediaForm:"create-object-dialog__add-media-form__10Wh-","cancel-icon":"create-object-dialog__cancel-icon__yD-8A",cancelIcon:"create-object-dialog__cancel-icon__yD-8A","upload-icon":"create-object-dialog__upload-icon__19g9k",uploadIcon:"create-object-dialog__upload-icon__19g9k","hide-file-input":"create-object-dialog__hide-file-input__2myDe",hideFileInput:"create-object-dialog__hide-file-input__2myDe"}},,function(e,t){e.exports={dialog:"invite-dialog__dialog__1XbxO","link-button":"invite-dialog__link-button__S_o-t",linkButton:"invite-dialog__link-button__S_o-t",domain:"invite-dialog__domain__2Q8Wr",close:"invite-dialog__close__3PAxl","attach-point":"invite-dialog__attach-point__otyII",attachPoint:"invite-dialog__attach-point__otyII",code:"invite-dialog__code__13AIx","keep-open":"invite-dialog__keep-open__229sO",keepOpen:"invite-dialog__keep-open__229sO",digit:"invite-dialog__digit__2w64P",digit_2:"invite-dialog__digit_2__pQCJ3",digit2:"invite-dialog__digit_2__pQCJ3",digit_3:"invite-dialog__digit_3__1bWtt",digit3:"invite-dialog__digit_3__1bWtt","code-loading-panel":"invite-dialog__code-loading-panel__1gghm",codeLoadingPanel:"invite-dialog__code-loading-panel__1gghm","hub-link-link":"invite-dialog__hub-link-link__2guVF",hubLinkLink:"invite-dialog__hub-link-link__2guVF",buttons:"invite-dialog__buttons__1yN_j"}},,function(e,t){e.exports={"close-button":"link-dialog__close-button__2THTw",closeButton:"link-dialog__close-button__2THTw",domain:"link-dialog__domain__1WbPJ",dialog:"link-dialog__dialog__1zbyG",header:"link-dialog__header__1A06x",contents:"link-dialog__contents__3ODVz",code:"link-dialog__code__259RI",imageHeader:"link-dialog__imageHeader__eaJe6","keep-open":"link-dialog__keep-open__DYcUI",keepOpen:"link-dialog__keep-open__DYcUI",digit:"link-dialog__digit___zoC4","code-loading-panel":"link-dialog__code-loading-panel__WKkNk",codeLoadingPanel:"link-dialog__code-loading-panel__WKkNk",close:"link-dialog__close__2TTmg"}},,function(e,t){e.exports={"email-field":"sign-in-dialog__email-field__g3xRW",emailField:"sign-in-dialog__email-field__g3xRW","next-button":"sign-in-dialog__next-button__2pGtq",nextButton:"sign-in-dialog__next-button__2pGtq","continue-button":"sign-in-dialog__continue-button__kFN6Z",continueButton:"sign-in-dialog__continue-button__kFN6Z","sign-in-form":"sign-in-dialog__sign-in-form__3Muog",signInForm:"sign-in-dialog__sign-in-form__3Muog","sign-in-complete":"sign-in-dialog__sign-in-complete__3JMkv",signInComplete:"sign-in-dialog__sign-in-complete__3JMkv",terms:"sign-in-dialog__terms__3TT6i"}},,function(e,t){e.exports={"presence-log":"presence-log__presence-log__10oFj",presenceLog:"presence-log__presence-log__10oFj","presence-log-entry":"presence-log__presence-log-entry__dt0t4",presenceLogEntry:"presence-log__presence-log-entry__dt0t4","message-body":"presence-log__message-body__2L9jA",messageBody:"presence-log__message-body__2L9jA","message-body-multi":"presence-log__message-body-multi__2e-Sx",messageBodyMulti:"presence-log__message-body-multi__2e-Sx","message-body-mono":"presence-log__message-body-mono__3zuQE",messageBodyMono:"presence-log__message-body-mono__3zuQE","message-wrap":"presence-log__message-wrap__2aWCa",messageWrap:"presence-log__message-wrap__2aWCa","message-wrap-multi":"presence-log__message-wrap-multi__1eA6v",messageWrapMulti:"presence-log__message-wrap-multi__1eA6v","message-source":"presence-log__message-source__3CI4d",messageSource:"presence-log__message-source__3CI4d","icon-button":"presence-log__icon-button__2Shbm",iconButton:"presence-log__icon-button__2Shbm","spawn-message":"presence-log__spawn-message__14Ne8",spawnMessage:"presence-log__spawn-message__14Ne8",share:"presence-log__share__37U7E",media:"presence-log__media__2qG_d",mediaBody:"presence-log__mediaBody__1rByA",expired:"presence-log__expired__2wMJc","presence-log-entry-with-button":"presence-log__presence-log-entry-with-button__1PxTw",presenceLogEntryWithButton:"presence-log__presence-log-entry-with-button__1PxTw","presence-log-in-room":"presence-log__presence-log-in-room__17h3n",presenceLogInRoom:"presence-log__presence-log-in-room__17h3n","presence-log-spawn":"presence-log__presence-log-spawn__3jlmT",presenceLogSpawn:"presence-log__presence-log-spawn__3jlmT","presence-log-entry-one-line":"presence-log__presence-log-entry-one-line__bRXfp",presenceLogEntryOneLine:"presence-log__presence-log-entry-one-line__bRXfp","presence-log-emoji":"presence-log__presence-log-emoji__1_3Yn",presenceLogEmoji:"presence-log__presence-log-emoji__1_3Yn",emoji:"presence-log__emoji__10b18"}},,,function(e,t){e.exports={"attach-point":"presence-list__attach-point__kIdfx",attachPoint:"presence-list__attach-point__kIdfx","presence-list":"presence-list__presence-list__1KERe",presenceList:"presence-list__presence-list__1KERe",contents:"presence-list__contents__1B7bz",rows:"presence-list__rows__1B6KS",row:"presence-list__row__1D2j2",device:"presence-list__device__2hYme","display-name":"presence-list__display-name__3HnOQ",displayName:"presence-list__display-name__3HnOQ","self-display-name":"presence-list__self-display-name__2pEMs",selfDisplayName:"presence-list__self-display-name__2pEMs",presence:"presence-list__presence__15DJe","sign-in":"presence-list__sign-in__28eVu",signIn:"presence-list__sign-in__28eVu"}},,function(e,t){e.exports={container:"_2d-hud__container__66GRt",top:"_2d-hud__top__3PiNe",column:"_2d-hud__column__1y7XY",bottom:"_2d-hud__bottom__2jUcT",hide:"_2d-hud__hide__3HJO8",panel:"_2d-hud__panel__2oM_T","video-share-notify":"_2d-hud__video-share-notify__28KgU",videoShareNotify:"_2d-hud__video-share-notify__28KgU","attach-point":"_2d-hud__attach-point__17FSc",attachPoint:"_2d-hud__attach-point__17FSc","video-share-extra-options":"_2d-hud__video-share-extra-options__31VMr",videoShareExtraOptions:"_2d-hud__video-share-extra-options__31VMr",iconButton:"_2d-hud__iconButton__3faJz",up:"_2d-hud__up__1lyhr",small:"_2d-hud__small__2rqgF",large:"_2d-hud__large__2bHqH","video-share":"_2d-hud__video-share__38X7W",videoShare:"_2d-hud__video-share__38X7W",mute:"_2d-hud__mute__25kHI",active:"_2d-hud__active__1TMB8",bubble:"_2d-hud__bubble__2oTt2",spawn_pen:"_2d-hud__spawn_pen__1F_c6",spawnPen:"_2d-hud__spawn_pen__1F_c6",spawn_camera:"_2d-hud__spawn_camera__goFE4",spawnCamera:"_2d-hud__spawn_camera__goFE4",freeze:"_2d-hud__freeze__26rlJ","create-object":"_2d-hud__create-object__27TcL",createObject:"_2d-hud__create-object__27TcL","mobile-media-picker":"_2d-hud__mobile-media-picker__3ZXHc",mobileMediaPicker:"_2d-hud__mobile-media-picker__3ZXHc",share_camera:"_2d-hud__share_camera__v67Il",shareCamera:"_2d-hud__share_camera__v67Il",share_screen:"_2d-hud__share_screen__1HQ8E",shareScreen:"_2d-hud__share_screen__1HQ8E",share_window:"_2d-hud__share_window__stsD3",shareWindow:"_2d-hud__share_window__stsD3"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports={"command-help":"chat-command-help__command-help__q0Wb8",commandHelp:"chat-command-help__command-help__q0Wb8",entry:"chat-command-help__entry__1E1un",command:"chat-command-help__command__2GMyn"}}]);
//# sourceMappingURL=hub-661ca7306a17b4544f88.js.map